'use strict';

var createDistWorkspace = require('./createDistWorkspace-4f496e3c.cjs.js');
var packageRoles = require('./packageRoles-54e27ede.cjs.js');
var index = require('./index-d2845aa8.cjs.js');
var buildBackend = require('./buildBackend-32a4adb3.cjs.js');
require('chalk');
require('fs-extra');
require('path');
require('os');
require('tar');
require('lodash/partition');
require('./run-eac5f3ab.cjs.js');
require('child_process');
require('util');
require('@backstage/errors');
require('./PackageGraph-84e587f4.cjs.js');
require('@manypkg/get-packages');
require('./Lockfile-e5943b84.cjs.js');
require('semver');
require('@yarnpkg/parsers');
require('@yarnpkg/lockfile');
require('minimatch');
require('./yarn-8315d2ff.cjs.js');
require('rollup');
require('@rollup/plugin-commonjs');
require('@rollup/plugin-node-resolve');
require('rollup-plugin-postcss');
require('rollup-plugin-esbuild');
require('@svgr/rollup');
require('rollup-plugin-dts');
require('@rollup/plugin-json');
require('@rollup/plugin-yaml');
require('rollup-pluginutils');
require('./svgrTemplate-d1dad6d3.cjs.js');
require('./entryPoints-e81a0dba.cjs.js');
require('./parallel-4af834f6.cjs.js');
require('worker_threads');
require('./productionPack-2038bfcf.cjs.js');
require('npm-packlist');
require('zod');
require('commander');
require('@backstage/cli-common');
require('webpack');
require('fork-ts-checker-webpack-plugin');
require('html-webpack-plugin');
require('react-dev-utils/ModuleScopePlugin');
require('run-script-webpack-plugin');
require('webpack-node-externals');
require('./paths-a7d52d4f.cjs.js');
require('mini-css-extract-plugin');
require('@pmmmwh/react-refresh-webpack-plugin');
require('eslint-webpack-plugin');
require('lodash/pickBy');
require('yn');
require('react-dev-utils/FileSizeReporter');
require('react-dev-utils/formatWebpackMessages');
require('webpack-dev-server');
require('react-dev-utils/openBrowser');
require('./config-7ca1db14.cjs.js');
require('@backstage/config-loader');
require('@backstage/config');

async function command(opts) {
  const role = await packageRoles.findRoleFromCommand(opts);
  if (role === "frontend") {
    return buildBackend.buildFrontend({
      targetDir: index.paths.targetDir,
      configPaths: opts.config,
      writeStats: Boolean(opts.stats)
    });
  }
  if (role === "backend") {
    return buildBackend.buildBackend({
      targetDir: index.paths.targetDir,
      skipBuildDependencies: Boolean(opts.skipBuildDependencies)
    });
  }
  const roleInfo = packageRoles.getRoleInfo(role);
  const outputs = /* @__PURE__ */ new Set();
  if (roleInfo.output.includes("cjs")) {
    outputs.add(createDistWorkspace.Output.cjs);
  }
  if (roleInfo.output.includes("esm")) {
    outputs.add(createDistWorkspace.Output.esm);
  }
  if (roleInfo.output.includes("types")) {
    outputs.add(createDistWorkspace.Output.types);
  }
  return createDistWorkspace.buildPackage({
    outputs,
    minify: Boolean(opts.minify),
    useApiExtractor: Boolean(opts.experimentalTypeBuild)
  });
}

exports.command = command;
//# sourceMappingURL=index-7bc3de78.cjs.js.map
