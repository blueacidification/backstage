"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2528],{64100:function(Oi,si,Ve){Ve.d(si,{B1:function(){return c},GA:function(){return mt},vQ:function(){return Qt},ys:function(){return l}});var w=Ve(1727),Q=Ve(95885),Z=Ve(77120);class me{constructor(f,g,T){this.state=f,this.pos=g,this.explicit=T,this.abortListeners=[]}tokenBefore(f){let g=(0,Z.qz)(this.state).resolveInner(this.pos,-1);for(;g&&f.indexOf(g.name)<0;)g=g.parent;return g?{from:g.from,to:this.pos,text:this.state.sliceDoc(g.from,this.pos),type:g.type}:null}matchBefore(f){let g=this.state.doc.lineAt(this.pos),T=Math.max(g.from,this.pos-250),B=g.text.slice(T-g.from,this.pos-g.from),F=B.search(Dt(f,!1));return F<0?null:{from:T+F,to:this.pos,text:B.slice(F)}}get aborted(){return this.abortListeners==null}addEventListener(f,g){f=="abort"&&this.abortListeners&&this.abortListeners.push(g)}}function xe(y){let f=Object.keys(y).join(""),g=/\w/.test(f);return g&&(f=f.replace(/\w/g,"")),`[${g?"\\w":""}${f.replace(/[^\w\s]/g,"\\$&")}]`}function Xe(y){let f=Object.create(null),g=Object.create(null);for(let{label:B}of y){f[B[0]]=!0;for(let F=1;F<B.length;F++)g[B[F]]=!0}let T=xe(f)+xe(g)+"*$";return[new RegExp("^"+T),new RegExp(T)]}function Ze(y){let f=y.map(B=>typeof B=="string"?{label:B}:B),[g,T]=f.every(B=>/^\w+$/.test(B.label))?[/\w*$/,/\w+$/]:Xe(f);return B=>{let F=B.matchBefore(T);return F||B.explicit?{from:F?F.from:B.pos,options:f,validFor:g}:null}}function Mt(y,f){return g=>{for(let T=syntaxTree(g.state).resolveInner(g.pos,-1);T;T=T.parent){if(y.indexOf(T.name)>-1)return f(g);if(T.type.isTop)break}return null}}function Rt(y,f){return g=>{for(let T=syntaxTree(g.state).resolveInner(g.pos,-1);T;T=T.parent){if(y.indexOf(T.name)>-1)return null;if(T.type.isTop)break}return f(g)}}class He{constructor(f,g,T){this.completion=f,this.source=g,this.match=T}}function tt(y){return y.selection.main.head}function Dt(y,f){var g;let{source:T}=y,B=f&&T[0]!="^",F=T[T.length-1]!="$";return!B&&!F?y:new RegExp(`${B?"^":""}(?:${T})${F?"$":""}`,(g=y.flags)!==null&&g!==void 0?g:y.ignoreCase?"i":"")}const Ee=w.q6.define();function It(y,f,g,T){return Object.assign(Object.assign({},y.changeByRange(B=>{if(B==y.selection.main)return{changes:{from:g,to:T,insert:f},range:w.jT.cursor(g+f.length)};let F=T-g;return!B.empty||F&&y.sliceDoc(B.from-F,B.from)!=y.sliceDoc(g,T)?{range:B}:{changes:{from:B.from-F,to:B.from,insert:f},range:w.jT.cursor(B.from-F+f.length)}})),{userEvent:"input.complete"})}function dt(y,f){const g=f.completion.apply||f.completion.label;let T=f.source;typeof g=="string"?y.dispatch(Object.assign(Object.assign({},It(y.state,g,T.from,T.to)),{annotations:Ee.of(f.completion)})):g(y,f.completion,T.from,T.to)}const Gt=new WeakMap;function ii(y){if(!Array.isArray(y))return y;let f=Gt.get(y);return f||Gt.set(y,f=Ze(y)),f}class ni{constructor(f){this.pattern=f,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[];for(let g=0;g<f.length;){let T=(0,w.gm)(f,g),B=(0,w.nZ)(T);this.chars.push(T);let F=f.slice(g,g+B),U=F.toUpperCase();this.folded.push((0,w.gm)(U==F?F.toLowerCase():U,0)),g+=B}this.astral=f.length!=this.chars.length}match(f){if(this.pattern.length==0)return[0];if(f.length<this.pattern.length)return null;let{chars:g,folded:T,any:B,precise:F,byWord:U}=this;if(g.length==1){let p=(0,w.gm)(f,0),O=(0,w.nZ)(p),P=O==f.length?0:-100;if(p!=g[0])if(p==T[0])P+=-200;else return null;return[P,0,O]}let G=f.indexOf(this.pattern);if(G==0)return[f.length==this.pattern.length?0:-100,0,this.pattern.length];let ie=g.length,be=0;if(G<0){for(let p=0,O=Math.min(f.length,200);p<O&&be<ie;){let P=(0,w.gm)(f,p);(P==g[be]||P==T[be])&&(B[be++]=p),p+=(0,w.nZ)(P)}if(be<ie)return null}let Ce=0,Qe=0,mi=!1,zt=0,ei=-1,bi=-1,C=/[a-z]/.test(f),h=!0;for(let p=0,O=Math.min(f.length,200),P=0;p<O&&Qe<ie;){let j=(0,w.gm)(f,p);G<0&&(Ce<ie&&j==g[Ce]&&(F[Ce++]=p),zt<ie&&(j==g[zt]||j==T[zt]?(zt==0&&(ei=p),bi=p+1,zt++):zt=0));let J,le=j<255?j>=48&&j<=57||j>=97&&j<=122?2:j>=65&&j<=90?1:0:(J=(0,w.bg)(j))!=J.toLowerCase()?1:J!=J.toUpperCase()?2:0;(!p||le==1&&C||P==0&&le!=0)&&(g[Qe]==j||T[Qe]==j&&(mi=!0)?U[Qe++]=p:U.length&&(h=!1)),P=le,p+=(0,w.nZ)(j)}return Qe==ie&&U[0]==0&&h?this.result(-100+(mi?-200:0),U,f):zt==ie&&ei==0?[-200-f.length+(bi==f.length?0:-100),0,bi]:G>-1?[-700-f.length,G,G+this.pattern.length]:zt==ie?[-200+-700-f.length,ei,bi]:Qe==ie?this.result(-100+(mi?-200:0)+-700+(h?0:-1100),U,f):g.length==2?null:this.result((B[0]?-700:0)+-200+-1100,B,f)}result(f,g,T){let B=[f-T.length],F=1;for(let U of g){let G=U+(this.astral?(0,w.nZ)((0,w.gm)(T,U)):1);F>1&&B[F-1]==U?B[F-1]=G:(B[F++]=U,B[F++]=G)}return B}}const _e=w.r$.define({combine(y){return(0,w.BO)(y,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],compareCompletions:(f,g)=>f.label.localeCompare(g.label),interactionDelay:75},{defaultKeymap:(f,g)=>f&&g,closeOnBlur:(f,g)=>f&&g,icons:(f,g)=>f&&g,tooltipClass:(f,g)=>T=>bt(f(T),g(T)),optionClass:(f,g)=>T=>bt(f(T),g(T)),addToOptions:(f,g)=>f.concat(g)})}});function bt(y,f){return y?f?y+" "+f:y:f}function ri(y){let f=y.addToOptions.slice();return y.icons&&f.push({render(g){let T=document.createElement("div");return T.classList.add("cm-completionIcon"),g.type&&T.classList.add(...g.type.split(/\s+/g).map(B=>"cm-completionIcon-"+B)),T.setAttribute("aria-hidden","true"),T},position:20}),f.push({render(g,T,B){let F=document.createElement("span");F.className="cm-completionLabel";let{label:U}=g,G=0;for(let ie=1;ie<B.length;){let be=B[ie++],Ce=B[ie++];be>G&&F.appendChild(document.createTextNode(U.slice(G,be)));let Qe=F.appendChild(document.createElement("span"));Qe.appendChild(document.createTextNode(U.slice(be,Ce))),Qe.className="cm-completionMatchedText",G=Ce}return G<U.length&&F.appendChild(document.createTextNode(U.slice(G))),F},position:50},{render(g){if(!g.detail)return null;let T=document.createElement("span");return T.className="cm-completionDetail",T.textContent=g.detail,T},position:80}),f.sort((g,T)=>g.position-T.position).map(g=>g.render)}function ft(y,f,g){if(y<=g)return{from:0,to:y};if(f<0&&(f=0),f<=y>>1){let B=Math.floor(f/g);return{from:B*g,to:(B+1)*g}}let T=Math.floor((y-f)/g);return{from:y-(T+1)*g,to:y-T*g}}class at{constructor(f,g){this.view=f,this.stateField=g,this.info=null,this.placeInfo={read:()=>this.measureInfo(),write:G=>this.positionInfo(G),key:this},this.space=null,this.currentClass="";let T=f.state.field(g),{options:B,selected:F}=T.open,U=f.state.facet(_e);this.optionContent=ri(U),this.optionClass=U.optionClass,this.tooltipClass=U.tooltipClass,this.range=ft(B.length,F,U.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(f.state),this.dom.addEventListener("mousedown",G=>{for(let ie=G.target,be;ie&&ie!=this.dom;ie=ie.parentNode)if(ie.nodeName=="LI"&&(be=/-(\d+)$/.exec(ie.id))&&+be[1]<B.length){dt(f,B[+be[1]]),G.preventDefault();return}}),this.list=this.dom.appendChild(this.createListBox(B,T.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)})}mount(){this.updateSel()}update(f){var g,T,B;let F=f.state.field(this.stateField),U=f.startState.field(this.stateField);this.updateTooltipClass(f.state),F!=U&&(this.updateSel(),((g=F.open)===null||g===void 0?void 0:g.disabled)!=((T=U.open)===null||T===void 0?void 0:T.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!(!((B=F.open)===null||B===void 0)&&B.disabled)))}updateTooltipClass(f){let g=this.tooltipClass(f);if(g!=this.currentClass){for(let T of this.currentClass.split(" "))T&&this.dom.classList.remove(T);for(let T of g.split(" "))T&&this.dom.classList.add(T);this.currentClass=g}}positioned(f){this.space=f,this.info&&this.view.requestMeasure(this.placeInfo)}updateSel(){let f=this.view.state.field(this.stateField),g=f.open;if((g.selected>-1&&g.selected<this.range.from||g.selected>=this.range.to)&&(this.range=ft(g.options.length,g.selected,this.view.state.facet(_e).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(g.options,f.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)})),this.updateSelectedOption(g.selected)){this.info&&(this.info.remove(),this.info=null);let{completion:T}=g.options[g.selected],{info:B}=T;if(!B)return;let F=typeof B=="string"?document.createTextNode(B):B(T);if(!F)return;"then"in F?F.then(U=>{U&&this.view.state.field(this.stateField,!1)==f&&this.addInfoPane(U)}).catch(U=>(0,Q.OO)(this.view.state,U,"completion info")):this.addInfoPane(F)}}addInfoPane(f){let g=this.info=document.createElement("div");g.className="cm-tooltip cm-completionInfo",g.appendChild(f),this.dom.appendChild(g),this.view.requestMeasure(this.placeInfo)}updateSelectedOption(f){let g=null;for(let T=this.list.firstChild,B=this.range.from;T;T=T.nextSibling,B++)B==f?T.hasAttribute("aria-selected")||(T.setAttribute("aria-selected","true"),g=T):T.hasAttribute("aria-selected")&&T.removeAttribute("aria-selected");return g&&At(this.list,g),g}measureInfo(){let f=this.dom.querySelector("[aria-selected]");if(!f||!this.info)return null;let g=this.dom.getBoundingClientRect(),T=this.info.getBoundingClientRect(),B=f.getBoundingClientRect(),F=this.space;if(!F){let ei=this.dom.ownerDocument.defaultView||window;F={left:0,top:0,right:ei.innerWidth,bottom:ei.innerHeight}}if(B.top>Math.min(F.bottom,g.bottom)-10||B.bottom<Math.max(F.top,g.top)+10)return null;let U=this.view.textDirection==Q.Nm.RTL,G=U,ie=!1,be,Ce="",Qe="",mi=g.left-F.left,zt=F.right-g.right;if(G&&mi<Math.min(T.width,zt)?G=!1:!G&&zt<Math.min(T.width,mi)&&(G=!0),T.width<=(G?mi:zt))Ce=Math.max(F.top,Math.min(B.top,F.bottom-T.height))-g.top+"px",be=Math.min(400,G?mi:zt)+"px";else{ie=!0,be=Math.min(400,(U?g.right:F.right-g.left)-30)+"px";let ei=F.bottom-g.bottom;ei>=T.height||ei>g.top?Ce=B.bottom-g.top+"px":Qe=g.bottom-B.top+"px"}return{top:Ce,bottom:Qe,maxWidth:be,class:ie?U?"left-narrow":"right-narrow":G?"left":"right"}}positionInfo(f){this.info&&(f?(this.info.style.top=f.top,this.info.style.bottom=f.bottom,this.info.style.maxWidth=f.maxWidth,this.info.className="cm-tooltip cm-completionInfo cm-completionInfo-"+f.class):this.info.style.top="-1e6px")}createListBox(f,g,T){const B=document.createElement("ul");B.id=g,B.setAttribute("role","listbox"),B.setAttribute("aria-expanded","true"),B.setAttribute("aria-label",this.view.state.phrase("Completions"));for(let F=T.from;F<T.to;F++){let{completion:U,match:G}=f[F];const ie=B.appendChild(document.createElement("li"));ie.id=g+"-"+F,ie.setAttribute("role","option");let be=this.optionClass(U);be&&(ie.className=be);for(let Ce of this.optionContent){let Qe=Ce(U,this.view.state,G);Qe&&ie.appendChild(Qe)}}return T.from&&B.classList.add("cm-completionListIncompleteTop"),T.to<f.length&&B.classList.add("cm-completionListIncompleteBottom"),B}}function Ot(y){return f=>new at(f,y)}function At(y,f){let g=y.getBoundingClientRect(),T=f.getBoundingClientRect();T.top<g.top?y.scrollTop-=g.top-T.top:T.bottom>g.bottom&&(y.scrollTop+=T.bottom-g.bottom)}function Je(y){return(y.boost||0)*100+(y.apply?10:0)+(y.info?5:0)+(y.type?1:0)}function We(y,f){let g=[],T=0;for(let G of y)if(G.hasResult())if(G.result.filter===!1){let ie=G.result.getMatch;for(let be of G.result.options){let Ce=[1e9-T++];if(ie)for(let Qe of ie(be))Ce.push(Qe);g.push(new He(be,G,Ce))}}else{let ie=new ni(f.sliceDoc(G.from,G.to)),be;for(let Ce of G.result.options)(be=ie.match(Ce.label))&&(Ce.boost!=null&&(be[0]+=Ce.boost),g.push(new He(Ce,G,be)))}let B=[],F=null,U=f.facet(_e).compareCompletions;for(let G of g.sort((ie,be)=>be.match[0]-ie.match[0]||U(ie.completion,be.completion)))!F||F.label!=G.completion.label||F.detail!=G.completion.detail||F.type!=null&&G.completion.type!=null&&F.type!=G.completion.type||F.apply!=G.completion.apply?B.push(G):Je(G.completion)>Je(F)&&(B[B.length-1]=G),F=G.completion;return B}class nt{constructor(f,g,T,B,F,U){this.options=f,this.attrs=g,this.tooltip=T,this.timestamp=B,this.selected=F,this.disabled=U}setSelected(f,g){return f==this.selected||f>=this.options.length?this:new nt(this.options,Nt(g,f),this.tooltip,this.timestamp,f,this.disabled)}static build(f,g,T,B,F){let U=We(f,g);if(!U.length)return B&&f.some(ie=>ie.state==1)?new nt(B.options,B.attrs,B.tooltip,B.timestamp,B.selected,!0):null;let G=g.facet(_e).selectOnOpen?0:-1;if(B&&B.selected!=G&&B.selected!=-1){let ie=B.options[B.selected].completion;for(let be=0;be<U.length;be++)if(U[be].completion==ie){G=be;break}}return new nt(U,Nt(T,G),{pos:f.reduce((ie,be)=>be.hasResult()?Math.min(ie,be.from):ie,1e8),create:Ot(rt),above:F.aboveCursor},B?B.timestamp:Date.now(),G,!1)}map(f){return new nt(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:f.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class Ne{constructor(f,g,T){this.active=f,this.id=g,this.open=T}static start(){return new Ne(Wt,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(f){let{state:g}=f,T=g.facet(_e),F=(T.override||g.languageDataAt("autocomplete",tt(g)).map(ii)).map(G=>(this.active.find(be=>be.source==G)||new Ge(G,this.active.some(be=>be.state!=0)?1:0)).update(f,T));F.length==this.active.length&&F.every((G,ie)=>G==this.active[ie])&&(F=this.active);let U=this.open;U&&f.docChanged&&(U=U.map(f.changes)),f.selection||F.some(G=>G.hasResult()&&f.changes.touchesRange(G.from,G.to))||!Pt(F,this.active)?U=nt.build(F,g,this.id,U,T):U&&U.disabled&&!F.some(G=>G.state==1)&&(U=null),!U&&F.every(G=>G.state!=1)&&F.some(G=>G.hasResult())&&(F=F.map(G=>G.hasResult()?new Ge(G.source,0):G));for(let G of f.effects)G.is(st)&&(U=U&&U.setSelected(G.value,this.id));return F==this.active&&U==this.open?this:new Ne(F,this.id,U)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:pt}}function Pt(y,f){if(y==f)return!0;for(let g=0,T=0;;){for(;g<y.length&&!y[g].hasResult;)g++;for(;T<f.length&&!f[T].hasResult;)T++;let B=g==y.length,F=T==f.length;if(B||F)return B==F;if(y[g++].result!=f[T++].result)return!1}}const pt={"aria-autocomplete":"list"};function Nt(y,f){let g={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":y};return f>-1&&(g["aria-activedescendant"]=y+"-"+f),g}const Wt=[];function Be(y){return y.isUserEvent("input.type")?"input":y.isUserEvent("delete.backward")?"delete":null}class Ge{constructor(f,g,T=-1){this.source=f,this.state=g,this.explicitPos=T}hasResult(){return!1}update(f,g){let T=Be(f),B=this;T?B=B.handleUserEvent(f,T,g):f.docChanged?B=B.handleChange(f):f.selection&&B.state!=0&&(B=new Ge(B.source,0));for(let F of f.effects)if(F.is(Tt))B=new Ge(B.source,1,F.value?tt(f.state):-1);else if(F.is(wt))B=new Ge(B.source,0);else if(F.is(Bt))for(let U of F.value)U.source==B.source&&(B=U);return B}handleUserEvent(f,g,T){return g=="delete"||!T.activateOnTyping?this.map(f.changes):new Ge(this.source,1)}handleChange(f){return f.changes.touchesRange(tt(f.startState))?new Ge(this.source,0):this.map(f.changes)}map(f){return f.empty||this.explicitPos<0?this:new Ge(this.source,this.state,f.mapPos(this.explicitPos))}}class Ye extends Ge{constructor(f,g,T,B,F){super(f,2,g),this.result=T,this.from=B,this.to=F}hasResult(){return!0}handleUserEvent(f,g,T){var B;let F=f.changes.mapPos(this.from),U=f.changes.mapPos(this.to,1),G=tt(f.state);if((this.explicitPos<0?G<=F:G<this.from)||G>U||g=="delete"&&tt(f.startState)==this.from)return new Ge(this.source,g=="input"&&T.activateOnTyping?1:0);let ie=this.explicitPos<0?-1:f.changes.mapPos(this.explicitPos),be;return ht(this.result.validFor,f.state,F,U)?new Ye(this.source,ie,this.result,F,U):this.result.update&&(be=this.result.update(this.result,F,U,new me(f.state,G,ie>=0)))?new Ye(this.source,ie,be,be.from,(B=be.to)!==null&&B!==void 0?B:tt(f.state)):new Ge(this.source,1,ie)}handleChange(f){return f.changes.touchesRange(this.from,this.to)?new Ge(this.source,0):this.map(f.changes)}map(f){return f.empty?this:new Ye(this.source,this.explicitPos<0?-1:f.mapPos(this.explicitPos),this.result,f.mapPos(this.from),f.mapPos(this.to,1))}}function ht(y,f,g,T){if(!y)return!1;let B=f.sliceDoc(g,T);return typeof y=="function"?y(B,g,T,f):Dt(y,!0).test(B)}const Tt=w.Py.define(),wt=w.Py.define(),Bt=w.Py.define({map(y,f){return y.map(g=>g.map(f))}}),st=w.Py.define(),rt=w.QQ.define({create(){return Ne.start()},update(y,f){return y.update(f)},provide:y=>[Q.hJ.from(y,f=>f.tooltip),Q.tk.contentAttributes.from(y,f=>f.attrs)]});function xt(y,f="option"){return g=>{let T=g.state.field(rt,!1);if(!T||!T.open||T.open.disabled||Date.now()-T.open.timestamp<g.state.facet(_e).interactionDelay)return!1;let B=1,F;f=="page"&&(F=(0,Q.gB)(g,T.open.tooltip))&&(B=Math.max(2,Math.floor(F.dom.offsetHeight/F.dom.querySelector("li").offsetHeight)-1));let{length:U}=T.open.options,G=T.open.selected>-1?T.open.selected+B*(y?1:-1):y?0:U-1;return G<0?G=f=="page"?0:U-1:G>=U&&(G=f=="page"?U-1:0),g.dispatch({effects:st.of(G)}),!0}}const _t=y=>{let f=y.state.field(rt,!1);return y.state.readOnly||!f||!f.open||f.open.selected<0||Date.now()-f.open.timestamp<y.state.facet(_e).interactionDelay?!1:(f.open.disabled||dt(y,f.open.options[f.open.selected]),!0)},pe=y=>y.state.field(rt,!1)?(y.dispatch({effects:Tt.of(!0)}),!0):!1,ee=y=>{let f=y.state.field(rt,!1);return!f||!f.active.some(g=>g.state!=0)?!1:(y.dispatch({effects:wt.of(null)}),!0)};class q{constructor(f,g){this.active=f,this.context=g,this.time=Date.now(),this.updates=[],this.done=void 0}}const ne=50,re=50,fe=1e3,ve=Q.lg.fromClass(class{constructor(y){this.view=y,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let f of y.state.field(rt).active)f.state==1&&this.startQuery(f)}update(y){let f=y.state.field(rt);if(!y.selectionSet&&!y.docChanged&&y.startState.field(rt)==f)return;let g=y.transactions.some(T=>(T.selection||T.docChanged)&&!Be(T));for(let T=0;T<this.running.length;T++){let B=this.running[T];if(g||B.updates.length+y.transactions.length>re&&Date.now()-B.time>fe){for(let F of B.context.abortListeners)try{F()}catch(U){(0,Q.OO)(this.view.state,U)}B.context.abortListeners=null,this.running.splice(T--,1)}else B.updates.push(...y.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=f.active.some(T=>T.state==1&&!this.running.some(B=>B.active.source==T.source))?setTimeout(()=>this.startUpdate(),ne):-1,this.composing!=0)for(let T of y.transactions)Be(T)=="input"?this.composing=2:this.composing==2&&T.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:y}=this.view,f=y.field(rt);for(let g of f.active)g.state==1&&!this.running.some(T=>T.active.source==g.source)&&this.startQuery(g)}startQuery(y){let{state:f}=this.view,g=tt(f),T=new me(f,g,y.explicitPos==g),B=new q(y,T);this.running.push(B),Promise.resolve(y.source(T)).then(F=>{B.context.aborted||(B.done=F||null,this.scheduleAccept())},F=>{this.view.dispatch({effects:wt.of(null)}),(0,Q.OO)(this.view.state,F)})}scheduleAccept(){this.running.every(y=>y.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),ne))}accept(){var y;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let f=[],g=this.view.state.facet(_e);for(let T=0;T<this.running.length;T++){let B=this.running[T];if(B.done===void 0)continue;if(this.running.splice(T--,1),B.done){let U=new Ye(B.active.source,B.active.explicitPos,B.done,B.done.from,(y=B.done.to)!==null&&y!==void 0?y:tt(B.updates.length?B.updates[0].startState:this.view.state));for(let G of B.updates)U=U.update(G,g);if(U.hasResult()){f.push(U);continue}}let F=this.view.state.field(rt).active.find(U=>U.source==B.active.source);if(F&&F.state==1)if(B.done==null){let U=new Ge(B.active.source,0);for(let G of B.updates)U=U.update(G,g);U.state!=1&&f.push(U)}else this.startQuery(F)}f.length&&this.view.dispatch({effects:Bt.of(f)})}},{eventHandlers:{blur(){let y=this.view.state.field(rt,!1);y&&y.tooltip&&this.view.state.facet(_e).closeOnBlur&&this.view.dispatch({effects:wt.of(null)})},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Tt.of(!1)}),20),this.composing=0}}}),Ae=Q.tk.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer",padding:"1px 3px",lineHeight:1.2}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xB7\xB7\xB7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:`${400}px`,boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:`${30}px`},".cm-completionInfo.cm-completionInfo-right-narrow":{left:`${30}px`},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25CB'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25CC'"}},".cm-completionIcon-variable":{"&:after":{content:"'\u{1D465}'"}},".cm-completionIcon-constant":{"&:after":{content:"'\u{1D436}'"}},".cm-completionIcon-type":{"&:after":{content:"'\u{1D461}'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222A'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25A1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\u{1F511}\uFE0E'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25A2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class Oe{constructor(f,g,T,B){this.field=f,this.line=g,this.from=T,this.to=B}}class Fe{constructor(f,g,T){this.field=f,this.from=g,this.to=T}map(f){let g=f.mapPos(this.from,-1,MapMode.TrackDel),T=f.mapPos(this.to,1,MapMode.TrackDel);return g==null||T==null?null:new Fe(this.field,g,T)}}class Re{constructor(f,g){this.lines=f,this.fieldPositions=g}instantiate(f,g){let T=[],B=[g],F=f.doc.lineAt(g),U=/^\s*/.exec(F.text)[0];for(let ie of this.lines){if(T.length){let be=U,Ce=/^\t*/.exec(ie)[0].length;for(let Qe=0;Qe<Ce;Qe++)be+=f.facet(indentUnit);B.push(g+be.length-Ce),ie=be+ie.slice(Ce)}T.push(ie),g+=ie.length+1}let G=this.fieldPositions.map(ie=>new Fe(ie.field,B[ie.line]+ie.from,B[ie.line]+ie.to));return{text:T,ranges:G}}static parse(f){let g=[],T=[],B=[],F;for(let U of f.split(/\r\n?|\n/)){for(;F=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(U);){let G=F[1]?+F[1]:null,ie=F[2]||F[3]||"",be=-1;for(let Ce=0;Ce<g.length;Ce++)(G!=null?g[Ce].seq==G:ie&&g[Ce].name==ie)&&(be=Ce);if(be<0){let Ce=0;for(;Ce<g.length&&(G==null||g[Ce].seq!=null&&g[Ce].seq<G);)Ce++;g.splice(Ce,0,{seq:G,name:ie}),be=Ce;for(let Qe of B)Qe.field>=be&&Qe.field++}B.push(new Oe(be,T.length,F.index,F.index+ie.length)),U=U.slice(0,F.index)+ie+U.slice(F.index+F[0].length)}for(let G;G=/\\([{}])/.exec(U);){U=U.slice(0,G.index)+G[1]+U.slice(G.index+G[0].length);for(let ie of B)ie.line==T.length&&ie.from>G.index&&(ie.from--,ie.to--)}T.push(U)}return new Re(T,B)}}let qe=Q.p.widget({widget:new class extends Q.l9{toDOM(){let y=document.createElement("span");return y.className="cm-snippetFieldPosition",y}ignoreEvent(){return!1}}}),Et=Q.p.mark({class:"cm-snippetField"});class Lt{constructor(f,g){this.ranges=f,this.active=g,this.deco=Q.p.set(f.map(T=>(T.from==T.to?qe:Et).range(T.from,T.to)))}map(f){let g=[];for(let T of this.ranges){let B=T.map(f);if(!B)return null;g.push(B)}return new Lt(g,this.active)}selectionInsideField(f){return f.ranges.every(g=>this.ranges.some(T=>T.field==this.active&&T.from<=g.from&&T.to>=g.to))}}const vt=w.Py.define({map(y,f){return y&&y.map(f)}}),Ft=w.Py.define(),kt=w.QQ.define({create(){return null},update(y,f){for(let g of f.effects){if(g.is(vt))return g.value;if(g.is(Ft)&&y)return new Lt(y.ranges,g.value)}return y&&f.docChanged&&(y=y.map(f.changes)),y&&f.selection&&!y.selectionInsideField(f.selection)&&(y=null),y},provide:y=>Q.tk.decorations.from(y,f=>f?f.deco:Q.p.none)});function qt(y,f){return w.jT.create(y.filter(g=>g.field==f).map(g=>w.jT.range(g.from,g.to)))}function $t(y){let f=Re.parse(y);return(g,T,B,F)=>{let{text:U,ranges:G}=f.instantiate(g.state,B),ie={changes:{from:B,to:F,insert:Text.of(U)},scrollIntoView:!0,annotations:Ee.of(T)};if(G.length&&(ie.selection=qt(G,0)),G.length>1){let be=new Lt(G,0),Ce=ie.effects=[vt.of(be)];g.state.field(kt,!1)===void 0&&Ce.push(StateEffect.appendConfig.of([kt,oi,A,Ae]))}g.dispatch(g.state.update(ie))}}function Ke(y){return({state:f,dispatch:g})=>{let T=f.field(kt,!1);if(!T||y<0&&T.active==0)return!1;let B=T.active+y,F=y>0&&!T.ranges.some(U=>U.field==B+y);return g(f.update({selection:qt(T.ranges,B),effects:vt.of(F?null:new Lt(T.ranges,B))})),!0}}const Vt=[{key:"Tab",run:Ke(1),shift:Ke(-1)},{key:"Escape",run:({state:y,dispatch:f})=>y.field(kt,!1)?(f(y.update({effects:vt.of(null)})),!0):!1}],pi=w.r$.define({combine(y){return y.length?y[0]:Vt}}),oi=w.Wl.highest(Q.$f.compute([pi],y=>y.facet(pi)));function H(y,f){return Object.assign(Object.assign({},f),{apply:$t(y)})}const A=Q.tk.domEventHandlers({mousedown(y,f){let g=f.state.field(kt,!1),T;if(!g||(T=f.posAtCoords({x:y.clientX,y:y.clientY}))==null)return!1;let B=g.ranges.find(F=>F.from<=T&&F.to>=T);return!B||B.field==g.active?!1:(f.dispatch({selection:qt(g.ranges,B.field),effects:vt.of(g.ranges.some(F=>F.field>B.field)?new Lt(g.ranges,B.field):null)}),!0)}});function W(y){let f=y.replace(/[\\[.+*?(){|^$]/g,"\\$&");try{return new RegExp(`[\\p{Alphabetic}\\p{Number}_${f}]+`,"ug")}catch{return new RegExp(`[w${f}]`,"g")}}function z(y,f){return new RegExp(f(y.source),y.unicode?"u":"")}const _=null;function se(y){return _[y]||(_[y]=new WeakMap)}function ye(y,f,g,T,B){for(let F=y.iterLines(),U=0;!F.next().done;){let{value:G}=F,ie;for(f.lastIndex=0;ie=f.exec(G);)if(!T[ie[0]]&&U+ie.index!=B&&(g.push({type:"text",label:ie[0]}),T[ie[0]]=!0,g.length>=2e3))return;U+=G.length+1}}function we(y,f,g,T,B){let F=y.length>=1e3,U=F&&f.get(y);if(U)return U;let G=[],ie=Object.create(null);if(y.children){let be=0;for(let Ce of y.children){if(Ce.length>=1e3)for(let Qe of we(Ce,f,g,T-be,B-be))ie[Qe.label]||(ie[Qe.label]=!0,G.push(Qe));else ye(Ce,g,G,ie,B-be);be+=Ce.length+1}}else ye(y,g,G,ie,B);return F&&G.length<2e3&&f.set(y,G),G}const Me=y=>{let f=y.state.languageDataAt("wordChars",y.pos).join(""),g=W(f),T=y.matchBefore(z(g,U=>U+"$"));if(!T&&!y.explicit)return null;let B=T?T.from:y.pos,F=we(y.state.doc,se(f),g,5e4,B);return{from:B,options:F,validFor:z(g,U=>"^"+U)}},De={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},ot=w.Py.define({map(y,f){let g=f.mapPos(y,-1,w.gc.TrackAfter);return g==null?void 0:g}}),ct=w.Py.define({map(y,f){return f.mapPos(y)}}),yt=new class extends w.uU{};yt.startSide=1,yt.endSide=-1;const li=w.QQ.define({create(){return w.Xs.empty},update(y,f){if(f.selection){let g=f.state.doc.lineAt(f.selection.main.head).from,T=f.startState.doc.lineAt(f.startState.selection.main.head).from;g!=f.changes.mapPos(T,-1)&&(y=w.Xs.empty)}y=y.map(f.changes);for(let g of f.effects)g.is(ot)?y=y.update({add:[yt.range(g.value,g.value+1)]}):g.is(ct)&&(y=y.update({filter:T=>T!=g.value}));return y}});function Qt(){return[jt,li]}const St="()[]{}<>";function Si(y){for(let f=0;f<St.length;f+=2)if(St.charCodeAt(f)==y)return St.charAt(f+1);return(0,w.bg)(y<128?y:y+1)}function Ht(y,f){return y.languageDataAt("closeBrackets",f)[0]||De}const xi=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),jt=Q.tk.inputHandler.of((y,f,g,T)=>{if((xi?y.composing:y.compositionStarted)||y.state.readOnly)return!1;let B=y.state.selection.main;if(T.length>2||T.length==2&&(0,w.nZ)((0,w.gm)(T,0))==1||f!=B.from||g!=B.to)return!1;let F=ai(y.state,T);return F?(y.dispatch(F),!0):!1}),mt=[{key:"Backspace",run:({state:y,dispatch:f})=>{if(y.readOnly)return!1;let T=Ht(y,y.selection.main.head).brackets||De.brackets,B=null,F=y.changeByRange(U=>{if(U.empty){let G=Zt(y.doc,U.head);for(let ie of T)if(ie==G&&fi(y.doc,U.head)==Si((0,w.gm)(ie,0)))return{changes:{from:U.head-ie.length,to:U.head+ie.length},range:w.jT.cursor(U.head-ie.length)}}return{range:B=U}});return B||f(y.update(F,{scrollIntoView:!0,userEvent:"delete.backward"})),!B}}];function ai(y,f){let g=Ht(y,y.selection.main.head),T=g.brackets||De.brackets;for(let B of T){let F=Si((0,w.gm)(B,0));if(f==B)return F==B?ki(y,B,T.indexOf(B+B+B)>-1,g):yi(y,B,F,g.before||De.before);if(f==F&&vi(y,y.selection.main.from))return Ai(y,B,F)}return null}function vi(y,f){let g=!1;return y.field(li).between(0,y.doc.length,T=>{T==f&&(g=!0)}),g}function fi(y,f){let g=y.sliceString(f,f+2);return g.slice(0,(0,w.nZ)((0,w.gm)(g,0)))}function Zt(y,f){let g=y.sliceString(f-2,f);return(0,w.nZ)((0,w.gm)(g,0))==g.length?g:g.slice(1)}function yi(y,f,g,T){let B=null,F=y.changeByRange(U=>{if(!U.empty)return{changes:[{insert:f,from:U.from},{insert:g,from:U.to}],effects:ot.of(U.to+f.length),range:w.jT.range(U.anchor+f.length,U.head+f.length)};let G=fi(y.doc,U.head);return!G||/\s/.test(G)||T.indexOf(G)>-1?{changes:{insert:f+g,from:U.head},effects:ot.of(U.head+f.length),range:w.jT.cursor(U.head+f.length)}:{range:B=U}});return B?null:y.update(F,{scrollIntoView:!0,userEvent:"input.type"})}function Ai(y,f,g){let T=null,B=y.selection.ranges.map(F=>F.empty&&fi(y.doc,F.head)==g?w.jT.cursor(F.head+g.length):T=F);return T?null:y.update({selection:w.jT.create(B,y.selection.mainIndex),scrollIntoView:!0,effects:y.selection.ranges.map(({from:F})=>ct.of(F))})}function ki(y,f,g,T){let B=T.stringPrefixes||De.stringPrefixes,F=null,U=y.changeByRange(G=>{if(!G.empty)return{changes:[{insert:f,from:G.from},{insert:f,from:G.to}],effects:ot.of(G.to+f.length),range:w.jT.range(G.anchor+f.length,G.head+f.length)};let ie=G.head,be=fi(y.doc,ie),Ce;if(be==f){if(Yt(y,ie))return{changes:{insert:f+f,from:ie},effects:ot.of(ie+f.length),range:w.jT.cursor(ie+f.length)};if(vi(y,ie)){let Qe=g&&y.sliceDoc(ie,ie+f.length*3)==f+f+f;return{range:w.jT.cursor(ie+f.length*(Qe?3:1)),effects:ct.of(ie)}}}else{if(g&&y.sliceDoc(ie-2*f.length,ie)==f+f&&(Ce=r(y,ie-2*f.length,B))>-1&&Yt(y,Ce))return{changes:{insert:f+f+f+f,from:ie},effects:ot.of(ie+f.length),range:w.jT.cursor(ie+f.length)};if(y.charCategorizer(ie)(be)!=w.D0.Word&&r(y,ie,B)>-1&&!D(y,ie,f,B))return{changes:{insert:f+f,from:ie},effects:ot.of(ie+f.length),range:w.jT.cursor(ie+f.length)}}return{range:F=G}});return F?null:y.update(U,{scrollIntoView:!0,userEvent:"input.type"})}function Yt(y,f){let g=(0,Z.qz)(y).resolveInner(f+1);return g.parent&&g.from==f}function D(y,f,g,T){let B=(0,Z.qz)(y).resolveInner(f,-1),F=T.reduce((U,G)=>Math.max(U,G.length),0);for(let U=0;U<5;U++){let G=y.sliceDoc(B.from,Math.min(B.to,B.from+g.length+F)),ie=G.indexOf(g);if(!ie||ie>-1&&T.indexOf(G.slice(0,ie))>-1){let Ce=B.firstChild;for(;Ce&&Ce.from==B.from&&Ce.to-Ce.from>g.length+ie;){if(y.sliceDoc(Ce.to-g.length,Ce.to)==g)return!1;Ce=Ce.firstChild}return!0}let be=B.to==f&&B.parent;if(!be)break;B=be}return!1}function r(y,f,g){let T=y.charCategorizer(f);if(T(y.sliceDoc(f-1,f))!=w.D0.Word)return f;for(let B of g){let F=f-B.length;if(y.sliceDoc(F,f)==B&&T(y.sliceDoc(F-1,F))!=w.D0.Word)return F}return-1}function l(y={}){return[rt,_e.of(y),ve,m,Ae]}const c=[{key:"Ctrl-Space",run:pe},{key:"Escape",run:ee},{key:"ArrowDown",run:xt(!0)},{key:"ArrowUp",run:xt(!1)},{key:"PageDown",run:xt(!0,"page")},{key:"PageUp",run:xt(!1,"page")},{key:"Enter",run:_t}],m=w.Wl.highest(Q.$f.computeN([_e],y=>y.facet(_e).defaultKeymap?[c]:[]));function S(y){let f=y.field(rt,!1);return f&&f.active.some(g=>g.state==1)?"pending":f&&f.active.some(g=>g.state!=0)?"active":null}const k=new WeakMap;function L(y){var f;let g=(f=y.field(rt,!1))===null||f===void 0?void 0:f.open;if(!g||g.disabled)return[];let T=k.get(g.options);return T||k.set(g.options,T=g.options.map(B=>B.completion)),T}function V(y){var f;let g=(f=y.field(rt,!1))===null||f===void 0?void 0:f.open;return g&&!g.disabled&&g.selected>=0?g.options[g.selected].completion:null}function te(y){var f;let g=(f=y.field(rt,!1))===null||f===void 0?void 0:f.open;return g&&!g.disabled&&g.selected>=0?g.selected:null}function he(y){return st.of(y)}},53947:function(Oi,si,Ve){Ve.d(si,{f$:function(){return re},m8:function(){return Je},oc:function(){return Jt},wQ:function(){return sn}});var w=Ve(1727),Q=Ve(95885),Z=Ve(77120),me=Ve(21649);const xe=d=>{let{state:v}=d,R=v.doc.lineAt(v.selection.main.from),E=It(d.state,R.from);return E.line?Ze(d):E.block?Ee(d):!1};function Xe(d,v){return({state:R,dispatch:E})=>{if(R.readOnly)return!1;let $=d(v,R);return $?(E(R.update($)),!0):!1}}const Ze=Xe(_e,0),Mt=null,Rt=null,He=Xe(ni,0),tt=null,Dt=null,Ee=Xe((d,v)=>ni(d,v,ii(v)),0);function It(d,v){let R=d.languageDataAt("commentTokens",v);return R.length?R[0]:{}}const dt=50;function Gt(d,{open:v,close:R},E,$){let N=d.sliceDoc(E-dt,E),X=d.sliceDoc($,$+dt),de=/\s*$/.exec(N)[0].length,Se=/^\s*/.exec(X)[0].length,Le=N.length-de;if(N.slice(Le-v.length,Le)==v&&X.slice(Se,Se+R.length)==R)return{open:{pos:E-de,margin:de&&1},close:{pos:$+Se,margin:Se&&1}};let Ie,$e;$-E<=2*dt?Ie=$e=d.sliceDoc(E,$):(Ie=d.sliceDoc(E,E+dt),$e=d.sliceDoc($-dt,$));let ti=/^\s*/.exec(Ie)[0].length,Mi=/\s*$/.exec($e)[0].length,Fi=$e.length-Mi-R.length;return Ie.slice(ti,ti+v.length)==v&&$e.slice(Fi,Fi+R.length)==R?{open:{pos:E+ti+v.length,margin:/\s/.test(Ie.charAt(ti+v.length))?1:0},close:{pos:$-Mi-R.length,margin:/\s/.test($e.charAt(Fi-1))?1:0}}:null}function ii(d){let v=[];for(let R of d.selection.ranges){let E=d.doc.lineAt(R.from),$=R.to<=E.to?E:d.doc.lineAt(R.to),N=v.length-1;N>=0&&v[N].to>E.from?v[N].to=$.to:v.push({from:E.from,to:$.to})}return v}function ni(d,v,R=v.selection.ranges){let E=R.map(N=>It(v,N.from).block);if(!E.every(N=>N))return null;let $=R.map((N,X)=>Gt(v,E[X],N.from,N.to));if(d!=2&&!$.every(N=>N))return{changes:v.changes(R.map((N,X)=>$[X]?[]:[{from:N.from,insert:E[X].open+" "},{from:N.to,insert:" "+E[X].close}]))};if(d!=1&&$.some(N=>N)){let N=[];for(let X=0,de;X<$.length;X++)if(de=$[X]){let Se=E[X],{open:Le,close:Ie}=de;N.push({from:Le.pos-Se.open.length,to:Le.pos+Le.margin},{from:Ie.pos-Ie.margin,to:Ie.pos+Se.close.length})}return{changes:N}}return null}function _e(d,v,R=v.selection.ranges){let E=[],$=-1;for(let{from:N,to:X}of R){let de=E.length,Se=1e9,Le=It(v,N).line;if(Le){for(let Ie=N;Ie<=X;){let $e=v.doc.lineAt(Ie);if($e.from>$&&(N==X||X>$e.from)){$=$e.from;let ti=/^\s*/.exec($e.text)[0].length,Mi=ti==$e.length,Fi=$e.text.slice(ti,ti+Le.length)==Le?ti:-1;ti<$e.text.length&&ti<Se&&(Se=ti),E.push({line:$e,comment:Fi,token:Le,indent:ti,empty:Mi,single:!1})}Ie=$e.to+1}if(Se<1e9)for(let Ie=de;Ie<E.length;Ie++)E[Ie].indent<E[Ie].line.text.length&&(E[Ie].indent=Se);E.length==de+1&&(E[de].single=!0)}}if(d!=2&&E.some(N=>N.comment<0&&(!N.empty||N.single))){let N=[];for(let{line:de,token:Se,indent:Le,empty:Ie,single:$e}of E)($e||!Ie)&&N.push({from:de.from+Le,insert:Se+" "});let X=v.changes(N);return{changes:X,selection:v.selection.map(X,1)}}else if(d!=1&&E.some(N=>N.comment>=0)){let N=[];for(let{line:X,comment:de,token:Se}of E)if(de>=0){let Le=X.from+de,Ie=Le+Se.length;X.text[Ie-X.from]==" "&&Ie++,N.push({from:Le,to:Ie})}return{changes:N}}return null}const bt=w.q6.define(),ri=w.q6.define(),ft=w.r$.define(),at=w.r$.define({combine(d){return(0,w.BO)(d,{minDepth:100,newGroupDelay:500,joinToEvent:(v,R)=>R},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(v,R)=>(E,$)=>v(E,$)||R(E,$)})}});function Ot(d){let v=0;return d.iterChangedRanges((R,E)=>v=E),v}const At=w.QQ.define({create(){return ne.empty},update(d,v){let R=v.state.facet(at),E=v.annotation(bt);if(E){let Se=v.docChanged?w.jT.single(Ot(v.changes)):void 0,Le=Ye.fromTransaction(v,Se),Ie=E.side,$e=Ie==0?d.undone:d.done;return Le?$e=ht($e,$e.length,R.minDepth,Le):$e=xt($e,v.startState.selection),new ne(Ie==0?E.rest:$e,Ie==0?$e:E.rest)}let $=v.annotation(ri);if(($=="full"||$=="before")&&(d=d.isolate()),v.annotation(w.YW.addToHistory)===!1)return v.changes.empty?d:d.addMapping(v.changes.desc);let N=Ye.fromTransaction(v),X=v.annotation(w.YW.time),de=v.annotation(w.YW.userEvent);return N?d=d.addChanges(N,X,de,R,v):v.selection&&(d=d.addSelection(v.startState.selection,X,de,R.newGroupDelay)),($=="full"||$=="after")&&(d=d.isolate()),d},toJSON(d){return{done:d.done.map(v=>v.toJSON()),undone:d.undone.map(v=>v.toJSON())}},fromJSON(d){return new ne(d.done.map(Ye.fromJSON),d.undone.map(Ye.fromJSON))}});function Je(d={}){return[At,at.of(d),Q.tk.domEventHandlers({beforeinput(v,R){let E=v.inputType=="historyUndo"?Ne:v.inputType=="historyRedo"?Pt:null;return E?(v.preventDefault(),E(R)):!1}})]}const We=null;function nt(d,v){return function({state:R,dispatch:E}){if(!v&&R.readOnly)return!1;let $=R.field(At,!1);if(!$)return!1;let N=$.pop(d,R,v);return N?(E(N),!0):!1}}const Ne=nt(0,!1),Pt=nt(1,!1),pt=nt(0,!0),Nt=nt(1,!0);function Wt(d){return function(v){let R=v.field(At,!1);if(!R)return 0;let E=d==0?R.done:R.undone;return E.length-(E.length&&!E[0].changes?1:0)}}const Be=null,Ge=null;class Ye{constructor(v,R,E,$,N){this.changes=v,this.effects=R,this.mapped=E,this.startSelection=$,this.selectionsAfter=N}setSelAfter(v){return new Ye(this.changes,this.effects,this.mapped,this.startSelection,v)}toJSON(){var v,R,E;return{changes:(v=this.changes)===null||v===void 0?void 0:v.toJSON(),mapped:(R=this.mapped)===null||R===void 0?void 0:R.toJSON(),startSelection:(E=this.startSelection)===null||E===void 0?void 0:E.toJSON(),selectionsAfter:this.selectionsAfter.map($=>$.toJSON())}}static fromJSON(v){return new Ye(v.changes&&w.as.fromJSON(v.changes),[],v.mapped&&w.n0.fromJSON(v.mapped),v.startSelection&&w.jT.fromJSON(v.startSelection),v.selectionsAfter.map(w.jT.fromJSON))}static fromTransaction(v,R){let E=st;for(let $ of v.startState.facet(ft)){let N=$(v);N.length&&(E=E.concat(N))}return!E.length&&v.changes.empty?null:new Ye(v.changes.invert(v.startState.doc),E,void 0,R||v.startState.selection,st)}static selection(v){return new Ye(void 0,st,void 0,void 0,v)}}function ht(d,v,R,E){let $=v+1>R+20?v-R-1:0,N=d.slice($,v);return N.push(E),N}function Tt(d,v){let R=[],E=!1;return d.iterChangedRanges(($,N)=>R.push($,N)),v.iterChangedRanges(($,N,X,de)=>{for(let Se=0;Se<R.length;){let Le=R[Se++],Ie=R[Se++];de>=Le&&X<=Ie&&(E=!0)}}),E}function wt(d,v){return d.ranges.length==v.ranges.length&&d.ranges.filter((R,E)=>R.empty!=v.ranges[E].empty).length===0}function Bt(d,v){return d.length?v.length?d.concat(v):d:v}const st=[],rt=200;function xt(d,v){if(d.length){let R=d[d.length-1],E=R.selectionsAfter.slice(Math.max(0,R.selectionsAfter.length-rt));return E.length&&E[E.length-1].eq(v)?d:(E.push(v),ht(d,d.length-1,1e9,R.setSelAfter(E)))}else return[Ye.selection([v])]}function _t(d){let v=d[d.length-1],R=d.slice();return R[d.length-1]=v.setSelAfter(v.selectionsAfter.slice(0,v.selectionsAfter.length-1)),R}function pe(d,v){if(!d.length)return d;let R=d.length,E=st;for(;R;){let $=ee(d[R-1],v,E);if($.changes&&!$.changes.empty||$.effects.length){let N=d.slice(0,R);return N[R-1]=$,N}else v=$.mapped,R--,E=$.selectionsAfter}return E.length?[Ye.selection(E)]:st}function ee(d,v,R){let E=Bt(d.selectionsAfter.length?d.selectionsAfter.map(de=>de.map(v)):st,R);if(!d.changes)return Ye.selection(E);let $=d.changes.map(v),N=v.mapDesc(d.changes,!0),X=d.mapped?d.mapped.composeDesc(N):N;return new Ye($,w.Py.mapEffects(d.effects,v),X,d.startSelection.map(N),E)}const q=/^(input\.type|delete)($|\.)/;class ne{constructor(v,R,E=0,$=void 0){this.done=v,this.undone=R,this.prevTime=E,this.prevUserEvent=$}isolate(){return this.prevTime?new ne(this.done,this.undone):this}addChanges(v,R,E,$,N){let X=this.done,de=X[X.length-1];return de&&de.changes&&!de.changes.empty&&v.changes&&(!E||q.test(E))&&(!de.selectionsAfter.length&&R-this.prevTime<$.newGroupDelay&&$.joinToEvent(N,Tt(de.changes,v.changes))||E=="input.type.compose")?X=ht(X,X.length-1,$.minDepth,new Ye(v.changes.compose(de.changes),Bt(v.effects,de.effects),de.mapped,de.startSelection,st)):X=ht(X,X.length,$.minDepth,v),new ne(X,st,R,E)}addSelection(v,R,E,$){let N=this.done.length?this.done[this.done.length-1].selectionsAfter:st;return N.length>0&&R-this.prevTime<$&&E==this.prevUserEvent&&E&&/^select($|\.)/.test(E)&&wt(N[N.length-1],v)?this:new ne(xt(this.done,v),this.undone,R,E)}addMapping(v){return new ne(pe(this.done,v),pe(this.undone,v),this.prevTime,this.prevUserEvent)}pop(v,R,E){let $=v==0?this.done:this.undone;if($.length==0)return null;let N=$[$.length-1];if(E&&N.selectionsAfter.length)return R.update({selection:N.selectionsAfter[N.selectionsAfter.length-1],annotations:bt.of({side:v,rest:_t($)}),userEvent:v==0?"select.undo":"select.redo",scrollIntoView:!0});if(N.changes){let X=$.length==1?st:$.slice(0,$.length-1);return N.mapped&&(X=pe(X,N.mapped)),R.update({changes:N.changes,selection:N.startSelection,effects:N.effects,annotations:bt.of({side:v,rest:X}),filter:!1,userEvent:v==0?"undo":"redo",scrollIntoView:!0})}else return null}}ne.empty=new ne(st,st);const re=[{key:"Mod-z",run:Ne,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Pt,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Pt,preventDefault:!0},{key:"Mod-u",run:pt,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Nt,preventDefault:!0}];function fe(d,v){return w.jT.create(d.ranges.map(v),d.mainIndex)}function ve(d,v){return d.update({selection:v,scrollIntoView:!0,userEvent:"select"})}function Ae({state:d,dispatch:v},R){let E=fe(d.selection,R);return E.eq(d.selection)?!1:(v(ve(d,E)),!0)}function Oe(d,v){return w.jT.cursor(v?d.to:d.from)}function Fe(d,v){return Ae(d,R=>R.empty?d.moveByChar(R,v):Oe(R,v))}function Re(d){return d.textDirectionAt(d.state.selection.main.head)==Q.Nm.LTR}const qe=d=>Fe(d,!Re(d)),Et=d=>Fe(d,Re(d)),Lt=d=>Fe(d,!0),vt=d=>Fe(d,!1);function Ft(d,v){return Ae(d,R=>R.empty?d.moveByGroup(R,v):Oe(R,v))}const kt=d=>Ft(d,!Re(d)),qt=d=>Ft(d,Re(d)),$t=d=>Ft(d,!0),Ke=d=>Ft(d,!1);function ke(d,v,R){let E=d.state.charCategorizer(v.from);return d.moveByChar(v,R,$=>{let N=CharCategory.Space,X=v.from,de=!1,Se=!1,Le=!1,Ie=$e=>{if(de)return!1;X+=R?$e.length:-$e.length;let ti=E($e),Mi;if(N==CharCategory.Space&&(N=ti),N!=ti)return!1;if(N==CharCategory.Word)if($e.toLowerCase()==$e){if(!R&&Se)return!1;Le=!0}else if(Le){if(R)return!1;de=!0}else{if(Se&&R&&E(Mi=d.state.sliceDoc(X,X+1))==CharCategory.Word&&Mi.toLowerCase()==Mi)return!1;Se=!0}return!0};return Ie($),Ie})}function it(d,v){return Ae(d,R=>R.empty?ke(d,R,v):Oe(R,v))}const ci=d=>it(d,!0),Vt=d=>it(d,!1);function pi(d,v,R){if(v.type.prop(R))return!0;let E=v.to-v.from;return E&&(E>2||/[^\s,.;:]/.test(d.sliceDoc(v.from,v.to)))||v.firstChild}function oi(d,v,R){let E=(0,Z.qz)(d).resolveInner(v.head),$=R?me.md.closedBy:me.md.openedBy;for(let Se=v.head;;){let Le=R?E.childAfter(Se):E.childBefore(Se);if(!Le)break;pi(d,Le,$)?E=Le:Se=R?Le.to:Le.from}let N=E.type.prop($),X,de;return N&&(X=R?(0,Z.Um)(d,E.from,1):(0,Z.Um)(d,E.to,-1))&&X.matched?de=R?X.end.to:X.end.from:de=R?E.to:E.from,w.jT.cursor(de,R?-1:1)}const H=d=>Ae(d,v=>oi(d.state,v,!Re(d))),A=d=>Ae(d,v=>oi(d.state,v,Re(d)));function W(d,v){return Ae(d,R=>{if(!R.empty)return Oe(R,v);let E=d.moveVertically(R,v);return E.head!=R.head?E:d.moveToLineBoundary(R,v)})}const z=d=>W(d,!1),_=d=>W(d,!0);function se(d){let v=d.scrollDOM.clientHeight<d.scrollDOM.scrollHeight-2,R=0,E=0,$;if(v){for(let N of d.state.facet(Q.tk.scrollMargins)){let X=N(d);X!=null&&X.top&&(R=Math.max(X==null?void 0:X.top,R)),X!=null&&X.bottom&&(E=Math.max(X==null?void 0:X.bottom,E))}$=d.scrollDOM.clientHeight-R-E}else $=(d.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:R,marginBottom:E,selfScroll:v,height:Math.max(d.defaultLineHeight,$-5)}}function ye(d,v){let R=se(d),{state:E}=d,$=fe(E.selection,X=>X.empty?d.moveVertically(X,v,R.height):Oe(X,v));if($.eq(E.selection))return!1;let N;if(R.selfScroll){let X=d.coordsAtPos(E.selection.main.head),de=d.scrollDOM.getBoundingClientRect(),Se=de.top+R.marginTop,Le=de.bottom-R.marginBottom;X&&X.top>Se&&X.bottom<Le&&(N=Q.tk.scrollIntoView($.main.head,{y:"start",yMargin:X.top-Se}))}return d.dispatch(ve(E,$),{effects:N}),!0}const we=d=>ye(d,!1),Me=d=>ye(d,!0);function De(d,v,R){let E=d.lineBlockAt(v.head),$=d.moveToLineBoundary(v,R);if($.head==v.head&&$.head!=(R?E.to:E.from)&&($=d.moveToLineBoundary(v,R,!1)),!R&&$.head==E.from&&E.length){let N=/^\s*/.exec(d.state.sliceDoc(E.from,Math.min(E.from+100,E.to)))[0].length;N&&v.head!=E.from+N&&($=w.jT.cursor(E.from+N))}return $}const ot=d=>Ae(d,v=>De(d,v,!0)),ct=d=>Ae(d,v=>De(d,v,!1)),yt=d=>Ae(d,v=>De(d,v,!Re(d))),li=d=>Ae(d,v=>De(d,v,Re(d))),Qt=d=>Ae(d,v=>w.jT.cursor(d.lineBlockAt(v.head).from,1)),St=d=>Ae(d,v=>w.jT.cursor(d.lineBlockAt(v.head).to,-1));function Si(d,v,R){let E=!1,$=fe(d.selection,N=>{let X=(0,Z.Um)(d,N.head,-1)||(0,Z.Um)(d,N.head,1)||N.head>0&&(0,Z.Um)(d,N.head-1,1)||N.head<d.doc.length&&(0,Z.Um)(d,N.head+1,-1);if(!X||!X.end)return N;E=!0;let de=X.start.from==N.head?X.end.to:X.end.from;return R?w.jT.range(N.anchor,de):w.jT.cursor(de)});return E?(v(ve(d,$)),!0):!1}const Ht=({state:d,dispatch:v})=>Si(d,v,!1),xi=({state:d,dispatch:v})=>Si(d,v,!0);function jt(d,v){let R=fe(d.state.selection,E=>{let $=v(E);return w.jT.range(E.anchor,$.head,$.goalColumn,$.bidiLevel||void 0)});return R.eq(d.state.selection)?!1:(d.dispatch(ve(d.state,R)),!0)}function Xt(d,v){return jt(d,R=>d.moveByChar(R,v))}const mt=d=>Xt(d,!Re(d)),ai=d=>Xt(d,Re(d)),vi=d=>Xt(d,!0),fi=d=>Xt(d,!1);function Zt(d,v){return jt(d,R=>d.moveByGroup(R,v))}const yi=d=>Zt(d,!Re(d)),Ai=d=>Zt(d,Re(d)),ki=d=>Zt(d,!0),Yt=d=>Zt(d,!1);function D(d,v){return jt(d,R=>ke(d,R,v))}const r=d=>D(d,!0),l=d=>D(d,!1),c=d=>jt(d,v=>oi(d.state,v,!Re(d))),m=d=>jt(d,v=>oi(d.state,v,Re(d)));function S(d,v){return jt(d,R=>d.moveVertically(R,v))}const k=d=>S(d,!1),L=d=>S(d,!0);function V(d,v){return jt(d,R=>d.moveVertically(R,v,se(d).height))}const te=d=>V(d,!1),he=d=>V(d,!0),y=d=>jt(d,v=>De(d,v,!0)),f=d=>jt(d,v=>De(d,v,!1)),g=d=>jt(d,v=>De(d,v,!Re(d))),T=d=>jt(d,v=>De(d,v,Re(d))),B=d=>jt(d,v=>w.jT.cursor(d.lineBlockAt(v.head).from)),F=d=>jt(d,v=>w.jT.cursor(d.lineBlockAt(v.head).to)),U=({state:d,dispatch:v})=>(v(ve(d,{anchor:0})),!0),G=({state:d,dispatch:v})=>(v(ve(d,{anchor:d.doc.length})),!0),ie=({state:d,dispatch:v})=>(v(ve(d,{anchor:d.selection.main.anchor,head:0})),!0),be=({state:d,dispatch:v})=>(v(ve(d,{anchor:d.selection.main.anchor,head:d.doc.length})),!0),Ce=({state:d,dispatch:v})=>(v(d.update({selection:{anchor:0,head:d.doc.length},userEvent:"select"})),!0),Qe=({state:d,dispatch:v})=>{let R=je(d).map(({from:E,to:$})=>w.jT.range(E,Math.min($+1,d.doc.length)));return v(d.update({selection:w.jT.create(R),userEvent:"select"})),!0},mi=({state:d,dispatch:v})=>{let R=fe(d.selection,E=>{var $;let N=(0,Z.qz)(d).resolveInner(E.head,1);for(;!(N.from<E.from&&N.to>=E.to||N.to>E.to&&N.from<=E.from||!(!(($=N.parent)===null||$===void 0)&&$.parent));)N=N.parent;return w.jT.range(N.to,N.from)});return v(ve(d,R)),!0},zt=({state:d,dispatch:v})=>{let R=d.selection,E=null;return R.ranges.length>1?E=w.jT.create([R.main]):R.main.empty||(E=w.jT.create([w.jT.cursor(R.main.head)])),E?(v(ve(d,E)),!0):!1};function ei(d,v){if(d.state.readOnly)return!1;let R="delete.selection",{state:E}=d,$=E.changeByRange(N=>{let{from:X,to:de}=N;if(X==de){let Se=v(X);Se<X?(R="delete.backward",Se=bi(d,Se,!1)):Se>X&&(R="delete.forward",Se=bi(d,Se,!0)),X=Math.min(X,Se),de=Math.max(de,Se)}else X=bi(d,X,!1),de=bi(d,de,!0);return X==de?{range:N}:{changes:{from:X,to:de},range:w.jT.cursor(X)}});return $.changes.empty?!1:(d.dispatch(E.update($,{scrollIntoView:!0,userEvent:R,effects:R=="delete.selection"?Q.tk.announce.of(E.phrase("Selection deleted")):void 0})),!0)}function bi(d,v,R){if(d instanceof Q.tk)for(let E of d.state.facet(Q.tk.atomicRanges).map($=>$(d)))E.between(v,v,($,N)=>{$<v&&N>v&&(v=R?N:$)});return v}const C=(d,v)=>ei(d,R=>{let{state:E}=d,$=E.doc.lineAt(R),N,X;if(!v&&R>$.from&&R<$.from+200&&!/[^ \t]/.test(N=$.text.slice(0,R-$.from))){if(N[N.length-1]=="	")return R-1;let de=(0,w.IS)(N,E.tabSize),Se=de%(0,Z.y1)(E)||(0,Z.y1)(E);for(let Le=0;Le<Se&&N[N.length-1-Le]==" ";Le++)R--;X=R}else X=(0,w.cp)($.text,R-$.from,v,v)+$.from,X==R&&$.number!=(v?E.doc.lines:1)&&(X+=v?1:-1);return X}),h=d=>C(d,!1),p=d=>C(d,!0),O=(d,v)=>ei(d,R=>{let E=R,{state:$}=d,N=$.doc.lineAt(E),X=$.charCategorizer(E);for(let de=null;;){if(E==(v?N.to:N.from)){E==R&&N.number!=(v?$.doc.lines:1)&&(E+=v?1:-1);break}let Se=(0,w.cp)(N.text,E-N.from,v)+N.from,Le=N.text.slice(Math.min(E,Se)-N.from,Math.max(E,Se)-N.from),Ie=X(Le);if(de!=null&&Ie!=de)break;(Le!=" "||E!=R)&&(de=Ie),E=Se}return E}),P=d=>O(d,!1),j=d=>O(d,!0),J=d=>ei(d,v=>{let R=d.lineBlockAt(v).to;return v<R?R:Math.min(d.state.doc.length,v+1)}),le=d=>ei(d,v=>{let R=d.lineBlockAt(v).from;return v>R?R:Math.max(0,v-1)}),oe=({state:d,dispatch:v})=>{if(d.readOnly)return!1;let R=[];for(let E=0,$="",N=d.doc.iter();;){if(N.next(),N.lineBreak||N.done){let X=$.search(/\s+$/);if(X>-1&&R.push({from:E-($.length-X),to:E}),N.done)break;$=""}else $=N.value;E+=N.value.length}return R.length?(v(d.update({changes:R,userEvent:"delete"})),!0):!1},Te=({state:d,dispatch:v})=>{if(d.readOnly)return!1;let R=d.changeByRange(E=>({changes:{from:E.from,to:E.to,insert:w.xv.of(["",""])},range:w.jT.cursor(E.from)}));return v(d.update(R,{scrollIntoView:!0,userEvent:"input"})),!0},Pe=({state:d,dispatch:v})=>{if(d.readOnly)return!1;let R=d.changeByRange(E=>{if(!E.empty||E.from==0||E.from==d.doc.length)return{range:E};let $=E.from,N=d.doc.lineAt($),X=$==N.from?$-1:(0,w.cp)(N.text,$-N.from,!1)+N.from,de=$==N.to?$+1:(0,w.cp)(N.text,$-N.from,!0)+N.from;return{changes:{from:X,to:de,insert:d.doc.slice($,de).append(d.doc.slice(X,$))},range:w.jT.cursor(de)}});return R.changes.empty?!1:(v(d.update(R,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function je(d){let v=[],R=-1;for(let E of d.selection.ranges){let $=d.doc.lineAt(E.from),N=d.doc.lineAt(E.to);if(!E.empty&&E.to==N.from&&(N=d.doc.lineAt(E.to-1)),R>=$.number){let X=v[v.length-1];X.to=N.to,X.ranges.push(E)}else v.push({from:$.from,to:N.to,ranges:[E]});R=N.number+1}return v}function Kt(d,v,R){if(d.readOnly)return!1;let E=[],$=[];for(let N of je(d)){if(R?N.to==d.doc.length:N.from==0)continue;let X=d.doc.lineAt(R?N.to+1:N.from-1),de=X.length+1;if(R){E.push({from:N.to,to:X.to},{from:N.from,insert:X.text+d.lineBreak});for(let Se of N.ranges)$.push(w.jT.range(Math.min(d.doc.length,Se.anchor+de),Math.min(d.doc.length,Se.head+de)))}else{E.push({from:X.from,to:N.from},{from:N.to,insert:d.lineBreak+X.text});for(let Se of N.ranges)$.push(w.jT.range(Se.anchor-de,Se.head-de))}}return E.length?(v(d.update({changes:E,scrollIntoView:!0,selection:w.jT.create($,d.selection.mainIndex),userEvent:"move.line"})),!0):!1}const Ut=({state:d,dispatch:v})=>Kt(d,v,!1),gi=({state:d,dispatch:v})=>Kt(d,v,!0);function Ci(d,v,R){if(d.readOnly)return!1;let E=[];for(let $ of je(d))R?E.push({from:$.from,insert:d.doc.slice($.from,$.to)+d.lineBreak}):E.push({from:$.to,insert:d.lineBreak+d.doc.slice($.from,$.to)});return v(d.update({changes:E,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const _i=({state:d,dispatch:v})=>Ci(d,v,!1),Wi=({state:d,dispatch:v})=>Ci(d,v,!0),en=d=>{if(d.state.readOnly)return!1;let{state:v}=d,R=v.changes(je(v).map(({from:$,to:N})=>($>0?$--:N<v.doc.length&&N++,{from:$,to:N}))),E=fe(v.selection,$=>d.moveVertically($,!0)).map(R);return d.dispatch({changes:R,selection:E,scrollIntoView:!0,userEvent:"delete.line"}),!0},$n=({state:d,dispatch:v})=>(v(d.update(d.replaceSelection(d.lineBreak),{scrollIntoView:!0,userEvent:"input"})),!0);function vn(d,v){if(/\(\)|\[\]|\{\}/.test(d.sliceDoc(v-1,v+1)))return{from:v,to:v};let R=(0,Z.qz)(d).resolveInner(v),E=R.childBefore(v),$=R.childAfter(v),N;return E&&$&&E.to<=v&&$.from>=v&&(N=E.type.prop(me.md.closedBy))&&N.indexOf($.name)>-1&&d.doc.lineAt(E.to).from==d.doc.lineAt($.from).from?{from:E.to,to:$.from}:null}const $i=Ji(!1),kn=Ji(!0);function Ji(d){return({state:v,dispatch:R})=>{if(v.readOnly)return!1;let E=v.changeByRange($=>{let{from:N,to:X}=$,de=v.doc.lineAt(N),Se=!d&&N==X&&vn(v,N);d&&(N=X=(X<=de.to?de:v.doc.lineAt(X)).to);let Le=new Z.Gn(v,{simulateBreak:N,simulateDoubleBreak:!!Se}),Ie=(0,Z.K0)(Le,N);for(Ie==null&&(Ie=/^\s*/.exec(v.doc.lineAt(N).text)[0].length);X<de.to&&/\s/.test(de.text[X-de.from]);)X++;Se?{from:N,to:X}=Se:N>de.from&&N<de.from+100&&!/\S/.test(de.text.slice(0,N))&&(N=de.from);let $e=["",(0,Z.SS)(v,Ie)];return Se&&$e.push((0,Z.SS)(v,Le.lineIndent(de.from,-1))),{changes:{from:N,to:X,insert:w.xv.of($e)},range:w.jT.cursor(N+1+$e[1].length)}});return R(v.update(E,{scrollIntoView:!0,userEvent:"input"})),!0}}function qi(d,v){let R=-1;return d.changeByRange(E=>{let $=[];for(let X=E.from;X<=E.to;){let de=d.doc.lineAt(X);de.number>R&&(E.empty||E.to>de.from)&&(v(de,$,E),R=de.number),X=de.to+1}let N=d.changes($);return{changes:$,range:w.jT.range(N.mapPos(E.anchor,1),N.mapPos(E.head,1))}})}const tn=({state:d,dispatch:v})=>{if(d.readOnly)return!1;let R=Object.create(null),E=new Z.Gn(d,{overrideIndentation:N=>{let X=R[N];return X==null?-1:X}}),$=qi(d,(N,X,de)=>{let Se=(0,Z.K0)(E,N.from);if(Se==null)return;/\S/.test(N.text)||(Se=0);let Le=/^\s*/.exec(N.text)[0],Ie=(0,Z.SS)(d,Se);(Le!=Ie||de.from<N.from+Le.length)&&(R[N.from]=Se,X.push({from:N.from,to:N.from+Le.length,insert:Ie}))});return $.changes.empty||v(d.update($,{userEvent:"indent"})),!0},Pi=({state:d,dispatch:v})=>d.readOnly?!1:(v(d.update(qi(d,(R,E)=>{E.push({from:R.from,insert:d.facet(Z.c)})}),{userEvent:"input.indent"})),!0),nn=({state:d,dispatch:v})=>d.readOnly?!1:(v(d.update(qi(d,(R,E)=>{let $=/^\s*/.exec(R.text)[0];if(!$)return;let N=(0,w.IS)($,d.tabSize),X=0,de=(0,Z.SS)(d,Math.max(0,N-(0,Z.y1)(d)));for(;X<$.length&&X<de.length&&$.charCodeAt(X)==de.charCodeAt(X);)X++;E.push({from:R.from+X,to:R.from+$.length,insert:de.slice(X)})}),{userEvent:"delete.dedent"})),!0),Jn=({state:d,dispatch:v})=>d.selection.ranges.some(R=>!R.empty)?Pi({state:d,dispatch:v}):(v(d.update(d.replaceSelection("	"),{scrollIntoView:!0,userEvent:"input"})),!0),Sn=[{key:"Ctrl-b",run:qe,shift:mt,preventDefault:!0},{key:"Ctrl-f",run:Et,shift:ai},{key:"Ctrl-p",run:z,shift:k},{key:"Ctrl-n",run:_,shift:L},{key:"Ctrl-a",run:Qt,shift:B},{key:"Ctrl-e",run:St,shift:F},{key:"Ctrl-d",run:p},{key:"Ctrl-h",run:h},{key:"Ctrl-k",run:J},{key:"Ctrl-Alt-h",run:P},{key:"Ctrl-o",run:Te},{key:"Ctrl-t",run:Pe},{key:"Ctrl-v",run:Me}],Cn=[{key:"ArrowLeft",run:qe,shift:mt,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:kt,shift:yi,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:yt,shift:g,preventDefault:!0},{key:"ArrowRight",run:Et,shift:ai,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:qt,shift:Ai,preventDefault:!0},{mac:"Cmd-ArrowRight",run:li,shift:T,preventDefault:!0},{key:"ArrowUp",run:z,shift:k,preventDefault:!0},{mac:"Cmd-ArrowUp",run:U,shift:ie},{mac:"Ctrl-ArrowUp",run:we,shift:te},{key:"ArrowDown",run:_,shift:L,preventDefault:!0},{mac:"Cmd-ArrowDown",run:G,shift:be},{mac:"Ctrl-ArrowDown",run:Me,shift:he},{key:"PageUp",run:we,shift:te},{key:"PageDown",run:Me,shift:he},{key:"Home",run:ct,shift:f,preventDefault:!0},{key:"Mod-Home",run:U,shift:ie},{key:"End",run:ot,shift:y,preventDefault:!0},{key:"Mod-End",run:G,shift:be},{key:"Enter",run:$i},{key:"Mod-a",run:Ce},{key:"Backspace",run:h,shift:h},{key:"Delete",run:p},{key:"Mod-Backspace",mac:"Alt-Backspace",run:P},{key:"Mod-Delete",mac:"Alt-Delete",run:j},{mac:"Mod-Backspace",run:le},{mac:"Mod-Delete",run:J}].concat(Sn.map(d=>({mac:d.key,run:d.run,shift:d.shift}))),sn=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:H,shift:c},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:A,shift:m},{key:"Alt-ArrowUp",run:Ut},{key:"Shift-Alt-ArrowUp",run:_i},{key:"Alt-ArrowDown",run:gi},{key:"Shift-Alt-ArrowDown",run:Wi},{key:"Escape",run:zt},{key:"Mod-Enter",run:kn},{key:"Alt-l",mac:"Ctrl-l",run:Qe},{key:"Mod-i",run:mi,preventDefault:!0},{key:"Mod-[",run:nn},{key:"Mod-]",run:Pi},{key:"Mod-Alt-\\",run:tn},{key:"Shift-Mod-k",run:en},{key:"Shift-Mod-\\",run:Ht},{key:"Mod-/",run:xe},{key:"Alt-A",run:He}].concat(Cn),Jt={key:"Tab",run:Pi,shift:nn}},77120:function(Oi,si,Ve){Ve.d(si,{Gn:function(){return Ge},K0:function(){return Wt},Qf:function(){return ct},R_:function(){return jt},SS:function(){return Nt},Um:function(){return c},c:function(){return Pt},e7:function(){return W},il:function(){return y},mi:function(){return De},n$:function(){return Yt},nF:function(){return St},nY:function(){return fe},qz:function(){return Ee},y1:function(){return pt}});var w=Ve(21649),Q=Ve(1727),Z=Ve(95885),me=Ve(86253),xe=Ve(37207),Xe;const Ze=new w.md;function Mt(C){return Q.r$.define({combine:C?h=>h.concat(C):void 0})}const Rt=new w.md;class He{constructor(h,p,O=[],P=""){this.data=h,this.name=P,Q.yy.prototype.hasOwnProperty("tree")||Object.defineProperty(Q.yy.prototype,"tree",{get(){return Ee(this)}}),this.parser=p,this.extension=[Je.of(this),Q.yy.languageData.of((j,J,le)=>{let oe=tt(j,J,le),Te=oe.type.prop(Ze);if(!Te)return[];let Pe=j.facet(Te),je=oe.type.prop(Rt);if(je){let Kt=oe.resolve(J-oe.from,le);for(let Ut of je)if(Ut.test(Kt,j)){let gi=j.facet(Ut.facet);return Ut.type=="replace"?gi:gi.concat(Pe)}}return Pe})].concat(O)}isActiveAt(h,p,O=-1){return tt(h,p,O).type.prop(Ze)==this.data}findRegions(h){let p=h.facet(Je);if((p==null?void 0:p.data)==this.data)return[{from:0,to:h.doc.length}];if(!p||!p.allowsNesting)return[];let O=[],P=(j,J)=>{if(j.prop(Ze)==this.data){O.push({from:J,to:J+j.length});return}let le=j.prop(w.md.mounted);if(le){if(le.tree.prop(Ze)==this.data){if(le.overlay)for(let oe of le.overlay)O.push({from:oe.from+J,to:oe.to+J});else O.push({from:J,to:J+j.length});return}else if(le.overlay){let oe=O.length;if(P(le.tree,le.overlay[0].from+J),O.length>oe)return}}for(let oe=0;oe<j.children.length;oe++){let Te=j.children[oe];Te instanceof w.mp&&P(Te,j.positions[oe]+J)}};return P(Ee(h),0),O}get allowsNesting(){return!0}}He.setState=Q.Py.define();function tt(C,h,p){let O=C.facet(Je),P=Ee(C).topNode;if(!O||O.allowsNesting)for(let j=P;j;j=j.enter(h,p,w.vj.ExcludeBuffers))j.type.isTop&&(P=j);return P}class Dt extends null{constructor(h,p,O){super(h,p,[],O),this.parser=p}static define(h){let p=Mt(h.languageData);return new Dt(p,h.parser.configure({props:[Ze.add(O=>O.isTop?p:void 0)]}),h.name)}configure(h,p){return new Dt(this.data,this.parser.configure(h),p||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Ee(C){let h=C.field(He.state,!1);return h?h.tree:w.mp.empty}function It(C,h,p=50){var O;let P=(O=C.field(He.state,!1))===null||O===void 0?void 0:O.context;if(!P)return null;let j=P.viewport;P.updateViewport({from:0,to:h});let J=P.isDone(h)||P.work(p,h)?P.tree:null;return P.updateViewport(j),J}function dt(C,h=C.doc.length){var p;return((p=C.field(He.state,!1))===null||p===void 0?void 0:p.context.isDone(h))||!1}function Gt(C,h=C.viewport.to,p=100){let O=It(C.state,h,p);return O!=Ee(C.state)&&C.dispatch({}),!!O}function ii(C){var h;return((h=C.plugin(At))===null||h===void 0?void 0:h.isWorking())||!1}class ni{constructor(h){this.doc=h,this.cursorPos=0,this.string="",this.cursor=h.iter()}get length(){return this.doc.length}syncTo(h){return this.string=this.cursor.next(h-this.cursorPos).value,this.cursorPos=h+this.string.length,this.cursorPos-this.string.length}chunk(h){return this.syncTo(h),this.string}get lineChunks(){return!0}read(h,p){let O=this.cursorPos-this.string.length;return h<O||p>=this.cursorPos?this.doc.sliceString(h,p):this.string.slice(h-O,p-O)}}let _e=null;class bt{constructor(h,p,O=[],P,j,J,le,oe){this.parser=h,this.state=p,this.fragments=O,this.tree=P,this.treeLen=j,this.viewport=J,this.skipped=le,this.scheduleOn=oe,this.parse=null,this.tempSkipped=[]}static create(h,p,O){return new bt(h,p,[],w.mp.empty,0,O,[],null)}startParse(){return this.parser.startParse(new ni(this.state.doc),this.fragments)}work(h,p){return p!=null&&p>=this.state.doc.length&&(p=void 0),this.tree!=w.mp.empty&&this.isDone(p!=null?p:this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var O;if(typeof h=="number"){let P=Date.now()+h;h=()=>Date.now()>P}for(this.parse||(this.parse=this.startParse()),p!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>p)&&p<this.state.doc.length&&this.parse.stopAt(p);;){let P=this.parse.advance();if(P)if(this.fragments=this.withoutTempSkipped(w.i9.addTree(P,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(O=this.parse.stoppedAt)!==null&&O!==void 0?O:this.state.doc.length,this.tree=P,this.parse=null,this.treeLen<(p!=null?p:this.state.doc.length))this.parse=this.startParse();else return!0;if(h())return!1}})}takeTree(){let h,p;this.parse&&(h=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>h)&&this.parse.stopAt(h),this.withContext(()=>{for(;!(p=this.parse.advance()););}),this.treeLen=h,this.tree=p,this.fragments=this.withoutTempSkipped(w.i9.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(h){let p=_e;_e=this;try{return h()}finally{_e=p}}withoutTempSkipped(h){for(let p;p=this.tempSkipped.pop();)h=ri(h,p.from,p.to);return h}changes(h,p){let{fragments:O,tree:P,treeLen:j,viewport:J,skipped:le}=this;if(this.takeTree(),!h.empty){let oe=[];if(h.iterChangedRanges((Te,Pe,je,Kt)=>oe.push({fromA:Te,toA:Pe,fromB:je,toB:Kt})),O=w.i9.applyChanges(O,oe),P=w.mp.empty,j=0,J={from:h.mapPos(J.from,-1),to:h.mapPos(J.to,1)},this.skipped.length){le=[];for(let Te of this.skipped){let Pe=h.mapPos(Te.from,1),je=h.mapPos(Te.to,-1);Pe<je&&le.push({from:Pe,to:je})}}}return new bt(this.parser,p,O,P,j,J,le,this.scheduleOn)}updateViewport(h){if(this.viewport.from==h.from&&this.viewport.to==h.to)return!1;this.viewport=h;let p=this.skipped.length;for(let O=0;O<this.skipped.length;O++){let{from:P,to:j}=this.skipped[O];P<h.to&&j>h.from&&(this.fragments=ri(this.fragments,P,j),this.skipped.splice(O--,1))}return this.skipped.length>=p?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(h,p){this.skipped.push({from:h,to:p})}static getSkippingParser(h){return new class extends w._b{createParse(p,O,P){let j=P[0].from,J=P[P.length-1].to;return{parsedPos:j,advance(){let oe=_e;if(oe){for(let Te of P)oe.tempSkipped.push(Te);h&&(oe.scheduleOn=oe.scheduleOn?Promise.all([oe.scheduleOn,h]):h)}return this.parsedPos=J,new w.mp(w.Jq.none,[],[],J-j)},stoppedAt:null,stopAt(){}}}}}isDone(h){h=Math.min(h,this.state.doc.length);let p=this.fragments;return this.treeLen>=h&&p.length&&p[0].from==0&&p[0].to>=h}static get(){return _e}}function ri(C,h,p){return w.i9.applyChanges(C,[{fromA:h,toA:p,fromB:h,toB:p}])}class ft{constructor(h){this.context=h,this.tree=h.tree}apply(h){if(!h.docChanged&&this.tree==this.context.tree)return this;let p=this.context.changes(h.changes,h.state),O=this.context.treeLen==h.startState.doc.length?void 0:Math.max(h.changes.mapPos(this.context.treeLen),p.viewport.to);return p.work(20,O)||p.takeTree(),new ft(p)}static init(h){let p=Math.min(3e3,h.doc.length),O=bt.create(h.facet(Je).parser,h,{from:0,to:p});return O.work(20,p)||O.takeTree(),new ft(O)}}He.state=Q.QQ.define({create:ft.init,update(C,h){for(let p of h.effects)if(p.is(He.setState))return p.value;return h.startState.facet(Je)!=h.state.facet(Je)?ft.init(h.state):C.apply(h)}});let at=C=>{let h=setTimeout(()=>C(),500);return()=>clearTimeout(h)};typeof requestIdleCallback!="undefined"&&(at=C=>{let h=-1,p=setTimeout(()=>{h=requestIdleCallback(C,{timeout:500-100})},100);return()=>h<0?clearTimeout(p):cancelIdleCallback(h)});const Ot=typeof navigator!="undefined"&&(!((Xe=navigator.scheduling)===null||Xe===void 0)&&Xe.isInputPending)?()=>navigator.scheduling.isInputPending():null,At=Z.lg.fromClass(class{constructor(h){this.view=h,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(h){let p=this.view.state.field(He.state).context;(p.updateViewport(h.view.viewport)||this.view.viewport.to>p.treeLen)&&this.scheduleWork(),h.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(p)}scheduleWork(){if(this.working)return;let{state:h}=this.view,p=h.field(He.state);(p.tree!=p.context.tree||!p.context.isDone(h.doc.length))&&(this.working=at(this.work))}work(h){this.working=null;let p=Date.now();if(this.chunkEnd<p&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=p+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:O,viewport:{to:P}}=this.view,j=O.field(He.state);if(j.tree==j.context.tree&&j.context.isDone(P+1e5))return;let J=Date.now()+Math.min(this.chunkBudget,100,h&&!Ot?Math.max(25,h.timeRemaining()-5):1e9),le=j.context.treeLen<P&&O.doc.length>P+1e3,oe=j.context.work(()=>Ot&&Ot()||Date.now()>J,P+(le?0:1e5));this.chunkBudget-=Date.now()-p,(oe||this.chunkBudget<=0)&&(j.context.takeTree(),this.view.dispatch({effects:He.setState.of(new ft(j.context))})),this.chunkBudget>0&&!(oe&&!le)&&this.scheduleWork(),this.checkAsyncSchedule(j.context)}checkAsyncSchedule(h){h.scheduleOn&&(this.workScheduled++,h.scheduleOn.then(()=>this.scheduleWork()).catch(p=>(0,Z.OO)(this.view.state,p)).then(()=>this.workScheduled--),h.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Je=Q.r$.define({combine(C){return C.length?C[0]:null},enables:C=>[He.state,At,Z.tk.contentAttributes.compute([C],h=>{let p=h.facet(C);return p&&p.name?{"data-language":p.name}:{}})]});class We{constructor(h,p=[]){this.language=h,this.support=p,this.extension=[h,p]}}class nt{constructor(h,p,O,P,j,J=void 0){this.name=h,this.alias=p,this.extensions=O,this.filename=P,this.loadFunc=j,this.support=J,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(h=>this.support=h,h=>{throw this.loading=null,h}))}static of(h){let{load:p,support:O}=h;if(!p){if(!O)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");p=()=>Promise.resolve(O)}return new nt(h.name,(h.alias||[]).concat(h.name).map(P=>P.toLowerCase()),h.extensions||[],h.filename,p,O)}static matchFilename(h,p){for(let P of h)if(P.filename&&P.filename.test(p))return P;let O=/\.([^.]+)$/.exec(p);if(O){for(let P of h)if(P.extensions.indexOf(O[1])>-1)return P}return null}static matchLanguageName(h,p,O=!0){p=p.toLowerCase();for(let P of h)if(P.alias.some(j=>j==p))return P;if(O)for(let P of h)for(let j of P.alias){let J=p.indexOf(j);if(J>-1&&(j.length>2||!/\w/.test(p[J-1])&&!/\w/.test(p[J+j.length])))return P}return null}}const Ne=Q.r$.define(),Pt=Q.r$.define({combine:C=>{if(!C.length)return"  ";let h=C[0];if(!h||/\S/.test(h)||Array.from(h).some(p=>p!=h[0]))throw new Error("Invalid indent unit: "+JSON.stringify(C[0]));return h}});function pt(C){let h=C.facet(Pt);return h.charCodeAt(0)==9?C.tabSize*h.length:h.length}function Nt(C,h){let p="",O=C.tabSize,P=C.facet(Pt)[0];if(P=="	"){for(;h>=O;)p+="	",h-=O;P=" "}for(let j=0;j<h;j++)p+=P;return p}function Wt(C,h){C instanceof Q.yy&&(C=new Ge(C));for(let O of C.state.facet(Ne)){let P=O(C,h);if(P!==void 0)return P}let p=Ee(C.state);return p?ht(C,p,h):null}function Be(C,h,p){let O=Object.create(null),P=new Ge(C,{overrideIndentation:J=>{var le;return(le=O[J])!==null&&le!==void 0?le:-1}}),j=[];for(let J=h;J<=p;){let le=C.doc.lineAt(J);J=le.to+1;let oe=Wt(P,le.from);if(oe==null)continue;/\S/.test(le.text)||(oe=0);let Te=/^\s*/.exec(le.text)[0],Pe=Nt(C,oe);Te!=Pe&&(O[le.from]=oe,j.push({from:le.from,to:le.from+Te.length,insert:Pe}))}return C.changes(j)}class Ge{constructor(h,p={}){this.state=h,this.options=p,this.unit=pt(h)}lineAt(h,p=1){let O=this.state.doc.lineAt(h),{simulateBreak:P,simulateDoubleBreak:j}=this.options;return P!=null&&P>=O.from&&P<=O.to?j&&P==h?{text:"",from:h}:(p<0?P<h:P<=h)?{text:O.text.slice(P-O.from),from:P}:{text:O.text.slice(0,P-O.from),from:O.from}:O}textAfterPos(h,p=1){if(this.options.simulateDoubleBreak&&h==this.options.simulateBreak)return"";let{text:O,from:P}=this.lineAt(h,p);return O.slice(h-P,Math.min(O.length,h+100-P))}column(h,p=1){let{text:O,from:P}=this.lineAt(h,p),j=this.countColumn(O,h-P),J=this.options.overrideIndentation?this.options.overrideIndentation(P):-1;return J>-1&&(j+=J-this.countColumn(O,O.search(/\S|$/))),j}countColumn(h,p=h.length){return(0,Q.IS)(h,this.state.tabSize,p)}lineIndent(h,p=1){let{text:O,from:P}=this.lineAt(h,p),j=this.options.overrideIndentation;if(j){let J=j(P);if(J>-1)return J}return this.countColumn(O,O.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Ye=new w.md;function ht(C,h,p){return Bt(h.resolveInner(p).enterUnfinishedNodesBefore(p),p,C)}function Tt(C){return C.pos==C.options.simulateBreak&&C.options.simulateDoubleBreak}function wt(C){let h=C.type.prop(Ye);if(h)return h;let p=C.firstChild,O;if(p&&(O=p.type.prop(w.md.closedBy))){let P=C.lastChild,j=P&&O.indexOf(P.name)>-1;return J=>ee(J,!0,1,void 0,j&&!Tt(J)?P.from:void 0)}return C.parent==null?st:null}function Bt(C,h,p){for(;C;C=C.parent){let O=wt(C);if(O)return O(rt.create(p,h,C))}return null}function st(){return 0}class rt extends Ge{constructor(h,p,O){super(h.state,h.options),this.base=h,this.pos=p,this.node=O}static create(h,p,O){return new rt(h,p,O)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let h=this.state.doc.lineAt(this.node.from);for(;;){let p=this.node.resolve(h.from);for(;p.parent&&p.parent.from==p.from;)p=p.parent;if(xt(p,this.node))break;h=this.state.doc.lineAt(p.from)}return this.lineIndent(h.from)}continue(){let h=this.node.parent;return h?Bt(h,this.pos,this.base):0}}function xt(C,h){for(let p=h;p;p=p.parent)if(C==p)return!0;return!1}function _t(C){let h=C.node,p=h.childAfter(h.from),O=h.lastChild;if(!p)return null;let P=C.options.simulateBreak,j=C.state.doc.lineAt(p.from),J=P==null||P<=j.from?j.to:Math.min(j.to,P);for(let le=p.to;;){let oe=h.childAfter(le);if(!oe||oe==O)return null;if(!oe.type.isSkipped)return oe.from<J?p:null;le=oe.to}}function pe({closing:C,align:h=!0,units:p=1}){return O=>ee(O,h,p,C)}function ee(C,h,p,O,P){let j=C.textAfter,J=j.match(/^\s*/)[0].length,le=O&&j.slice(J,J+O.length)==O||P==C.pos+J,oe=h?_t(C):null;return oe?le?C.column(oe.from):C.column(oe.to):C.baseIndent+(le?0:C.unit*p)}const q=C=>C.baseIndent;function ne({except:C,units:h=1}={}){return p=>{let O=C&&C.test(p.textAfter);return p.baseIndent+(O?0:h*p.unit)}}const re=200;function fe(){return Q.yy.transactionFilter.of(C=>{if(!C.docChanged||!C.isUserEvent("input.type")&&!C.isUserEvent("input.complete"))return C;let h=C.startState.languageDataAt("indentOnInput",C.startState.selection.main.head);if(!h.length)return C;let p=C.newDoc,{head:O}=C.newSelection.main,P=p.lineAt(O);if(O>P.from+re)return C;let j=p.sliceString(P.from,O);if(!h.some(Te=>Te.test(j)))return C;let{state:J}=C,le=-1,oe=[];for(let{head:Te}of J.selection.ranges){let Pe=J.doc.lineAt(Te);if(Pe.from==le)continue;le=Pe.from;let je=Wt(J,Pe.from);if(je==null)continue;let Kt=/^\s*/.exec(Pe.text)[0],Ut=Nt(J,je);Kt!=Ut&&oe.push({from:Pe.from,to:Pe.from+Kt.length,insert:Ut})}return oe.length?[C,{changes:oe,sequential:!0}]:C})}const ve=Q.r$.define(),Ae=new w.md;function Oe(C){let h=C.firstChild,p=C.lastChild;return h&&h.to<p.from?{from:h.to,to:p.type.isError?C.to:p.from}:null}function Fe(C,h,p){let O=Ee(C);if(O.length<p)return null;let P=O.resolveInner(p,1),j=null;for(let J=P;J;J=J.parent){if(J.to<=p||J.from>p)continue;if(j&&J.from<h)break;let le=J.type.prop(Ae);if(le&&(J.to<O.length-50||O.length==C.doc.length||!Re(J))){let oe=le(J,C);oe&&oe.from<=p&&oe.from>=h&&oe.to>p&&(j=oe)}}return j}function Re(C){let h=C.lastChild;return h&&h.to==C.to&&h.type.isError}function qe(C,h,p){for(let O of C.facet(ve)){let P=O(C,h,p);if(P)return P}return Fe(C,h,p)}function Et(C,h){let p=h.mapPos(C.from,1),O=h.mapPos(C.to,-1);return p>=O?void 0:{from:p,to:O}}const Lt=Q.Py.define({map:Et}),vt=Q.Py.define({map:Et});function Ft(C){let h=[];for(let{head:p}of C.state.selection.ranges)h.some(O=>O.from<=p&&O.to>=p)||h.push(C.lineBlockAt(p));return h}const kt=Q.QQ.define({create(){return Z.p.none},update(C,h){C=C.map(h.changes);for(let p of h.effects)p.is(Lt)&&!Ke(C,p.value.from,p.value.to)?C=C.update({add:[ye.range(p.value.from,p.value.to)]}):p.is(vt)&&(C=C.update({filter:(O,P)=>p.value.from!=O||p.value.to!=P,filterFrom:p.value.from,filterTo:p.value.to}));if(h.selection){let p=!1,{head:O}=h.selection.main;C.between(O,O,(P,j)=>{P<O&&j>O&&(p=!0)}),p&&(C=C.update({filterFrom:O,filterTo:O,filter:(P,j)=>j<=O||P>=O}))}return C},provide:C=>Z.tk.decorations.from(C),toJSON(C,h){let p=[];return C.between(0,h.doc.length,(O,P)=>{p.push(O,P)}),p},fromJSON(C){if(!Array.isArray(C)||C.length%2)throw new RangeError("Invalid JSON for fold state");let h=[];for(let p=0;p<C.length;){let O=C[p++],P=C[p++];if(typeof O!="number"||typeof P!="number")throw new RangeError("Invalid JSON for fold state");h.push(ye.range(O,P))}return Z.p.set(h,!0)}});function qt(C){return C.field(kt,!1)||RangeSet.empty}function $t(C,h,p){var O;let P=null;return(O=C.field(kt,!1))===null||O===void 0||O.between(h,p,(j,J)=>{(!P||P.from>j)&&(P={from:j,to:J})}),P}function Ke(C,h,p){let O=!1;return C.between(h,h,(P,j)=>{P==h&&j==p&&(O=!0)}),O}function ke(C,h){return C.field(kt,!1)?h:h.concat(Q.Py.appendConfig.of(se()))}const it=C=>{for(let h of Ft(C)){let p=qe(C.state,h.from,h.to);if(p)return C.dispatch({effects:ke(C.state,[Lt.of(p),Vt(C,p)])}),!0}return!1},ci=C=>{if(!C.state.field(kt,!1))return!1;let h=[];for(let p of Ft(C)){let O=$t(C.state,p.from,p.to);O&&h.push(vt.of(O),Vt(C,O,!1))}return h.length&&C.dispatch({effects:h}),h.length>0};function Vt(C,h,p=!0){let O=C.state.doc.lineAt(h.from).number,P=C.state.doc.lineAt(h.to).number;return Z.tk.announce.of(`${C.state.phrase(p?"Folded lines":"Unfolded lines")} ${O} ${C.state.phrase("to")} ${P}.`)}const pi=C=>{let{state:h}=C,p=[];for(let O=0;O<h.doc.length;){let P=C.lineBlockAt(O),j=qe(h,P.from,P.to);j&&p.push(Lt.of(j)),O=(j?C.lineBlockAt(j.to):P).to+1}return p.length&&C.dispatch({effects:ke(C.state,p)}),!!p.length},oi=C=>{let h=C.state.field(kt,!1);if(!h||!h.size)return!1;let p=[];return h.between(0,C.state.doc.length,(O,P)=>{p.push(vt.of({from:O,to:P}))}),C.dispatch({effects:p}),!0};function H(C,h){for(let p=h;;){let O=qe(C.state,p.from,p.to);if(O&&O.to>h.from)return O;if(!p.from)return null;p=C.lineBlockAt(p.from-1)}}const A=C=>{let h=[];for(let p of Ft(C)){let O=$t(C.state,p.from,p.to);if(O)h.push(vt.of(O),Vt(C,O,!1));else{let P=H(C,p);P&&h.push(Lt.of(P),Vt(C,P))}}return h.length>0&&C.dispatch({effects:ke(C.state,h)}),!!h.length},W=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:it},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:ci},{key:"Ctrl-Alt-[",run:pi},{key:"Ctrl-Alt-]",run:oi}],z={placeholderDOM:null,placeholderText:"\u2026"},_=Q.r$.define({combine(C){return(0,Q.BO)(C,z)}});function se(C){let h=[kt,ot];return C&&h.push(_.of(C)),h}const ye=Z.p.replace({widget:new class extends Z.l9{toDOM(C){let{state:h}=C,p=h.facet(_),O=j=>{let J=C.lineBlockAt(C.posAtDOM(j.target)),le=$t(C.state,J.from,J.to);le&&C.dispatch({effects:vt.of(le)}),j.preventDefault()};if(p.placeholderDOM)return p.placeholderDOM(C,O);let P=document.createElement("span");return P.textContent=p.placeholderText,P.setAttribute("aria-label",h.phrase("folded code")),P.title=h.phrase("unfold"),P.className="cm-foldPlaceholder",P.onclick=O,P}}}),we={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class Me extends Z.SJ{constructor(h,p){super(),this.config=h,this.open=p}eq(h){return this.config==h.config&&this.open==h.open}toDOM(h){if(this.config.markerDOM)return this.config.markerDOM(this.open);let p=document.createElement("span");return p.textContent=this.open?this.config.openText:this.config.closedText,p.title=h.state.phrase(this.open?"Fold line":"Unfold line"),p}}function De(C={}){let h=Object.assign(Object.assign({},we),C),p=new Me(h,!0),O=new Me(h,!1),P=Z.lg.fromClass(class{constructor(J){this.from=J.viewport.from,this.markers=this.buildMarkers(J)}update(J){(J.docChanged||J.viewportChanged||J.startState.facet(Je)!=J.state.facet(Je)||J.startState.field(kt,!1)!=J.state.field(kt,!1)||Ee(J.startState)!=Ee(J.state)||h.foldingChanged(J))&&(this.markers=this.buildMarkers(J.view))}buildMarkers(J){let le=new Q.f_;for(let oe of J.viewportLineBlocks){let Te=$t(J.state,oe.from,oe.to)?O:qe(J.state,oe.from,oe.to)?p:null;Te&&le.add(oe.from,oe.from,Te)}return le.finish()}}),{domEventHandlers:j}=h;return[P,(0,Z.v5)({class:"cm-foldGutter",markers(J){var le;return((le=J.plugin(P))===null||le===void 0?void 0:le.markers)||Q.Xs.empty},initialSpacer(){return new Me(h,!1)},domEventHandlers:Object.assign(Object.assign({},j),{click:(J,le,oe)=>{if(j.click&&j.click(J,le,oe))return!0;let Te=$t(J.state,le.from,le.to);if(Te)return J.dispatch({effects:vt.of(Te)}),!0;let Pe=qe(J.state,le.from,le.to);return Pe?(J.dispatch({effects:Lt.of(Pe)}),!0):!1}})}),se()]}const ot=Z.tk.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class ct{constructor(h,p){this.specs=h;let O;function P(le){let oe=xe.V.newName();return(O||(O=Object.create(null)))["."+oe]=le,oe}const j=typeof p.all=="string"?p.all:p.all?P(p.all):void 0,J=p.scope;this.scope=J instanceof He?le=>le.prop(Ze)==J.data:J?le=>le==J:void 0,this.style=(0,me.QR)(h.map(le=>({tag:le.tag,class:le.class||P(Object.assign({},le,{tag:null}))})),{all:j}).style,this.module=O?new xe.V(O):null,this.themeType=p.themeType}static define(h,p){return new ct(h,p||{})}}const yt=Q.r$.define(),li=Q.r$.define({combine(C){return C.length?[C[0]]:null}});function Qt(C){let h=C.facet(yt);return h.length?h:C.facet(li)}function St(C,h){let p=[xi],O;return C instanceof ct&&(C.module&&p.push(Z.tk.styleModule.of(C.module)),O=C.themeType),h!=null&&h.fallback?p.push(li.of(C)):O?p.push(yt.computeN([Z.tk.darkTheme],P=>P.facet(Z.tk.darkTheme)==(O=="dark")?[C]:[])):p.push(yt.of(C)),p}function Si(C,h,p){let O=Qt(C),P=null;if(O){for(let j of O)if(!j.scope||p&&j.scope(p)){let J=j.style(h);J&&(P=P?P+" "+J:J)}}return P}class Ht{constructor(h){this.markCache=Object.create(null),this.tree=Ee(h.state),this.decorations=this.buildDeco(h,Qt(h.state))}update(h){let p=Ee(h.state),O=Qt(h.state),P=O!=Qt(h.startState);p.length<h.view.viewport.to&&!P&&p.type==this.tree.type?this.decorations=this.decorations.map(h.changes):(p!=this.tree||h.viewportChanged||P)&&(this.tree=p,this.decorations=this.buildDeco(h.view,O))}buildDeco(h,p){if(!p||!this.tree.length)return Z.p.none;let O=new Q.f_;for(let{from:P,to:j}of h.visibleRanges)(0,me.bW)(this.tree,p,(J,le,oe)=>{O.add(J,le,this.markCache[oe]||(this.markCache[oe]=Z.p.mark({class:oe})))},P,j);return O.finish()}}const xi=Q.Wl.high(Z.lg.fromClass(Ht,{decorations:C=>C.decorations})),jt=ct.define([{tag:me.pJ.meta,color:"#404740"},{tag:me.pJ.link,textDecoration:"underline"},{tag:me.pJ.heading,textDecoration:"underline",fontWeight:"bold"},{tag:me.pJ.emphasis,fontStyle:"italic"},{tag:me.pJ.strong,fontWeight:"bold"},{tag:me.pJ.strikethrough,textDecoration:"line-through"},{tag:me.pJ.keyword,color:"#708"},{tag:[me.pJ.atom,me.pJ.bool,me.pJ.url,me.pJ.contentSeparator,me.pJ.labelName],color:"#219"},{tag:[me.pJ.literal,me.pJ.inserted],color:"#164"},{tag:[me.pJ.string,me.pJ.deleted],color:"#a11"},{tag:[me.pJ.regexp,me.pJ.escape,me.pJ.special(me.pJ.string)],color:"#e40"},{tag:me.pJ.definition(me.pJ.variableName),color:"#00f"},{tag:me.pJ.local(me.pJ.variableName),color:"#30a"},{tag:[me.pJ.typeName,me.pJ.namespace],color:"#085"},{tag:me.pJ.className,color:"#167"},{tag:[me.pJ.special(me.pJ.variableName),me.pJ.macroName],color:"#256"},{tag:me.pJ.definition(me.pJ.propertyName),color:"#00c"},{tag:me.pJ.comment,color:"#940"},{tag:me.pJ.invalid,color:"#f00"}]),Xt=Z.tk.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),mt=1e4,ai="()[]{}",vi=Q.r$.define({combine(C){return(0,Q.BO)(C,{afterCursor:!0,brackets:ai,maxScanDistance:mt,renderMatch:yi})}}),fi=Z.p.mark({class:"cm-matchingBracket"}),Zt=Z.p.mark({class:"cm-nonmatchingBracket"});function yi(C){let h=[],p=C.matched?fi:Zt;return h.push(p.range(C.start.from,C.start.to)),C.end&&h.push(p.range(C.end.from,C.end.to)),h}const ki=[Q.QQ.define({create(){return Z.p.none},update(C,h){if(!h.docChanged&&!h.selection)return C;let p=[],O=h.state.facet(vi);for(let P of h.state.selection.ranges){if(!P.empty)continue;let j=c(h.state,P.head,-1,O)||P.head>0&&c(h.state,P.head-1,1,O)||O.afterCursor&&(c(h.state,P.head,1,O)||P.head<h.state.doc.length&&c(h.state,P.head+1,-1,O));j&&(p=p.concat(O.renderMatch(j,h.state)))}return Z.p.set(p,!0)},provide:C=>Z.tk.decorations.from(C)}),Xt];function Yt(C={}){return[vi.of(C),ki]}const D=new w.md;function r(C,h,p){let O=C.prop(h<0?w.md.openedBy:w.md.closedBy);if(O)return O;if(C.name.length==1){let P=p.indexOf(C.name);if(P>-1&&P%2==(h<0?1:0))return[p[P+h]]}return null}function l(C){let h=C.type.prop(D);return h?h(C.node):C}function c(C,h,p,O={}){let P=O.maxScanDistance||mt,j=O.brackets||ai,J=Ee(C),le=J.resolveInner(h,p);for(let oe=le;oe;oe=oe.parent){let Te=r(oe.type,p,j);if(Te&&oe.from<oe.to){let Pe=l(oe);if(Pe&&(p>0?h>=Pe.from&&h<Pe.to:h>Pe.from&&h<=Pe.to))return m(C,h,p,oe,Pe,Te,j)}}return S(C,h,p,J,le.type,P,j)}function m(C,h,p,O,P,j,J){let le=O.parent,oe={from:P.from,to:P.to},Te=0,Pe=le==null?void 0:le.cursor();if(Pe&&(p<0?Pe.childBefore(O.from):Pe.childAfter(O.to)))do if(p<0?Pe.to<=O.from:Pe.from>=O.to){if(Te==0&&j.indexOf(Pe.type.name)>-1&&Pe.from<Pe.to){let je=l(Pe);return{start:oe,end:je?{from:je.from,to:je.to}:void 0,matched:!0}}else if(r(Pe.type,p,J))Te++;else if(r(Pe.type,-p,J)){if(Te==0){let je=l(Pe);return{start:oe,end:je&&je.from<je.to?{from:je.from,to:je.to}:void 0,matched:!1}}Te--}}while(p<0?Pe.prevSibling():Pe.nextSibling());return{start:oe,matched:!1}}function S(C,h,p,O,P,j,J){let le=p<0?C.sliceDoc(h-1,h):C.sliceDoc(h,h+1),oe=J.indexOf(le);if(oe<0||oe%2==0!=p>0)return null;let Te={from:p<0?h-1:h,to:p>0?h+1:h},Pe=C.doc.iterRange(h,p>0?C.doc.length:0),je=0;for(let Kt=0;!Pe.next().done&&Kt<=j;){let Ut=Pe.value;p<0&&(Kt+=Ut.length);let gi=h+Kt*p;for(let Ci=p>0?0:Ut.length-1,_i=p>0?Ut.length:-1;Ci!=_i;Ci+=p){let Wi=J.indexOf(Ut[Ci]);if(!(Wi<0||O.resolveInner(gi+Ci,1).type!=P))if(Wi%2==0==p>0)je++;else{if(je==1)return{start:Te,end:{from:gi+Ci,to:gi+Ci+1},matched:Wi>>1==oe>>1};je--}}p>0&&(Kt+=Ut.length)}return Pe.done?{start:Te,matched:!1}:null}function k(C,h,p,O=0,P=0){h==null&&(h=C.search(/[^\s\u00a0]/),h==-1&&(h=C.length));let j=P;for(let J=O;J<h;J++)C.charCodeAt(J)==9?j+=p-j%p:j++;return j}class L{constructor(h,p,O,P){this.string=h,this.tabSize=p,this.indentUnit=O,this.overrideIndent=P,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(h){let p=this.string.charAt(this.pos),O;if(typeof h=="string"?O=p==h:O=p&&(h instanceof RegExp?h.test(p):h(p)),O)return++this.pos,p}eatWhile(h){let p=this.pos;for(;this.eat(h););return this.pos>p}eatSpace(){let h=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>h}skipToEnd(){this.pos=this.string.length}skipTo(h){let p=this.string.indexOf(h,this.pos);if(p>-1)return this.pos=p,!0}backUp(h){this.pos-=h}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=k(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var h;return(h=this.overrideIndent)!==null&&h!==void 0?h:k(this.string,null,this.tabSize)}match(h,p,O){if(typeof h=="string"){let P=J=>O?J.toLowerCase():J,j=this.string.substr(this.pos,h.length);return P(j)==P(h)?(p!==!1&&(this.pos+=h.length),!0):null}else{let P=this.string.slice(this.pos).match(h);return P&&P.index>0?null:(P&&p!==!1&&(this.pos+=P[0].length),P)}}current(){return this.string.slice(this.start,this.pos)}}function V(C){return{name:C.name||"",token:C.token,blankLine:C.blankLine||(()=>{}),startState:C.startState||(()=>!0),copyState:C.copyState||te,indent:C.indent||(()=>null),languageData:C.languageData||{},tokenTable:C.tokenTable||U}}function te(C){if(typeof C!="object")return C;let h={};for(let p in C){let O=C[p];h[p]=O instanceof Array?O.slice():O}return h}const he=new WeakMap;class y extends He{constructor(h){let p=Mt(h.languageData),O=V(h),P,j=new class extends w._b{createParse(J,le,oe){return new B(P,J,le,oe)}};super(p,j,[Ne.of((J,le)=>this.getIndent(J,le))],h.name),this.topNode=bi(p),P=this,this.streamParser=O,this.stateAfter=new w.md({perNode:!0}),this.tokenTable=h.tokenTable?new Qe(O.tokenTable):mi}static define(h){return new y(h)}getIndent(h,p){let O=Ee(h.state),P=O.resolve(p);for(;P&&P.type!=this.topNode;)P=P.parent;if(!P)return null;let j,{overrideIndentation:J}=h.options;J&&(j=he.get(h.state),j!=null&&j<p-1e4&&(j=void 0));let le=f(this,O,0,P.from,j!=null?j:p),oe,Te;if(le?(Te=le.state,oe=le.pos+1):(Te=this.streamParser.startState(h.unit),oe=0),p-oe>1e4)return null;for(;oe<p;){let je=h.state.doc.lineAt(oe),Kt=Math.min(p,je.to);if(je.length){let Ut=J?J(je.from):-1,gi=new L(je.text,h.state.tabSize,h.unit,Ut<0?void 0:Ut);for(;gi.pos<Kt-je.from;)F(this.streamParser.token,gi,Te)}else this.streamParser.blankLine(Te,h.unit);if(Kt==p)break;oe=je.to+1}let Pe=h.lineAt(p);return J&&j==null&&he.set(h.state,Pe.from),this.streamParser.indent(Te,/^\s*(.*)/.exec(Pe.text)[1],h)}get allowsNesting(){return!1}}function f(C,h,p,O,P){let j=p>=O&&p+h.length<=P&&h.prop(C.stateAfter);if(j)return{state:C.streamParser.copyState(j),pos:p+h.length};for(let J=h.children.length-1;J>=0;J--){let le=h.children[J],oe=p+h.positions[J],Te=le instanceof w.mp&&oe<P&&f(C,le,oe,O,P);if(Te)return Te}return null}function g(C,h,p,O,P){if(P&&p<=0&&O>=h.length)return h;!P&&h.type==C.topNode&&(P=!0);for(let j=h.children.length-1;j>=0;j--){let J=h.positions[j],le=h.children[j],oe;if(J<O&&le instanceof w.mp){if(!(oe=g(C,le,p-J,O-J,P)))break;return P?new w.mp(h.type,h.children.slice(0,j).concat(oe),h.positions.slice(0,j+1),J+oe.length):oe}}return null}function T(C,h,p,O){for(let P of h){let j=P.from+(P.openStart?25:0),J=P.to-(P.openEnd?25:0),le=j<=p&&J>p&&f(C,P.tree,0-P.offset,p,J),oe;if(le&&(oe=g(C,P.tree,p+P.offset,le.pos+P.offset,!1)))return{state:le.state,tree:oe}}return{state:C.streamParser.startState(O?pt(O):4),tree:w.mp.empty}}class B{constructor(h,p,O,P){this.lang=h,this.input=p,this.fragments=O,this.ranges=P,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=P[P.length-1].to;let j=bt.get(),J=P[0].from,{state:le,tree:oe}=T(h,O,J,j==null?void 0:j.state);this.state=le,this.parsedPos=this.chunkStart=J+oe.length;for(let Te=0;Te<oe.children.length;Te++)this.chunks.push(oe.children[Te]),this.chunkPos.push(oe.positions[Te]);j&&this.parsedPos<j.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(pt(j.state)),j.skipUntilInView(this.parsedPos,j.viewport.from),this.parsedPos=j.viewport.from),this.moveRangeIndex()}advance(){let h=bt.get(),p=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),O=Math.min(p,this.chunkStart+2048);for(h&&(O=Math.min(O,h.viewport.to));this.parsedPos<O;)this.parseLine(h);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=p?this.finish():h&&this.parsedPos>=h.viewport.to?(h.skipUntilInView(this.parsedPos,p),this.finish()):null}stopAt(h){this.stoppedAt=h}lineAfter(h){let p=this.input.chunk(h);if(this.input.lineChunks)p==`
`&&(p="");else{let O=p.indexOf(`
`);O>-1&&(p=p.slice(0,O))}return h+p.length<=this.to?p:p.slice(0,this.to-h)}nextLine(){let h=this.parsedPos,p=this.lineAfter(h),O=h+p.length;for(let P=this.rangeIndex;;){let j=this.ranges[P].to;if(j>=O||(p=p.slice(0,j-(O-p.length)),P++,P==this.ranges.length))break;let J=this.ranges[P].from,le=this.lineAfter(J);p+=le,O=J+le.length}return{line:p,end:O}}skipGapsTo(h,p,O){for(;;){let P=this.ranges[this.rangeIndex].to,j=h+p;if(O>0?P>j:P>=j)break;let J=this.ranges[++this.rangeIndex].from;p+=J-P}return p}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(h,p,O,P,j){if(this.ranges.length>1){j=this.skipGapsTo(p,j,1),p+=j;let J=this.chunk.length;j=this.skipGapsTo(O,j,-1),O+=j,P+=this.chunk.length-J}return this.chunk.push(h,p,O,P),j}parseLine(h){let{line:p,end:O}=this.nextLine(),P=0,{streamParser:j}=this.lang,J=new L(p,h?h.state.tabSize:4,h?pt(h.state):2);if(J.eol())j.blankLine(this.state,J.indentUnit);else for(;!J.eol();){let le=F(j.token,J,this.state);if(le&&(P=this.emitToken(this.lang.tokenTable.resolve(le),this.parsedPos+J.start,this.parsedPos+J.pos,4,P)),J.start>1e4)break}this.parsedPos=O,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let h=w.mp.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:ie,topID:0,maxBufferLength:2048,reused:this.chunkReused});h=new w.mp(h.type,h.children,h.positions,h.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(h),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new w.mp(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function F(C,h,p){h.start=h.pos;for(let O=0;O<10;O++){let P=C(h,p);if(h.pos>h.start)return P}throw new Error("Stream parser failed to advance stream.")}const U=Object.create(null),G=[w.Jq.none],ie=new w.Lj(G),be=[],Ce=Object.create(null);for(let[C,h]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Ce[C]=ei(U,h);class Qe{constructor(h){this.extra=h,this.table=Object.assign(Object.create(null),Ce)}resolve(h){return h?this.table[h]||(this.table[h]=ei(this.extra,h)):0}}const mi=new Qe(U);function zt(C,h){be.indexOf(C)>-1||(be.push(C),console.warn(h))}function ei(C,h){let p=null;for(let j of h.split(".")){let J=C[j]||me.pJ[j];J?typeof J=="function"?p?p=J(p):zt(j,`Modifier ${j} used at start of tag`):p?zt(j,`Tag ${j} used as modifier`):p=J:zt(j,`Unknown highlighting tag ${j}`)}if(!p)return 0;let O=h.replace(/ /g,"_"),P=w.Jq.define({id:G.length,name:O,props:[(0,me.Gv)({[O]:p})]});return G.push(P),P.id}function bi(C){let h=w.Jq.define({id:G.length,name:"Document",props:[Ze.add(()=>C)]});return G.push(h),h}},42123:function(Oi,si,Ve){Ve.d(si,{r:function(){return Z}});var w=["true","false","on","off","yes","no"],Q=new RegExp("\\b(("+w.join(")|(")+"))$","i");const Z={name:"yaml",token:function(me,xe){var Xe=me.peek(),Ze=xe.escaped;if(xe.escaped=!1,Xe=="#"&&(me.pos==0||/\s/.test(me.string.charAt(me.pos-1))))return me.skipToEnd(),"comment";if(me.match(/^('([^']|\\.)*'?|"([^"]|\\.)*"?)/))return"string";if(xe.literal&&me.indentation()>xe.keyCol)return me.skipToEnd(),"string";if(xe.literal&&(xe.literal=!1),me.sol()){if(xe.keyCol=0,xe.pair=!1,xe.pairStart=!1,me.match("---")||me.match("..."))return"def";if(me.match(/^\s*-\s+/))return"meta"}if(me.match(/^(\{|\}|\[|\])/))return Xe=="{"?xe.inlinePairs++:Xe=="}"?xe.inlinePairs--:Xe=="["?xe.inlineList++:xe.inlineList--,"meta";if(xe.inlineList>0&&!Ze&&Xe==",")return me.next(),"meta";if(xe.inlinePairs>0&&!Ze&&Xe==",")return xe.keyCol=0,xe.pair=!1,xe.pairStart=!1,me.next(),"meta";if(xe.pairStart){if(me.match(/^\s*(\||\>)\s*/))return xe.literal=!0,"meta";if(me.match(/^\s*(\&|\*)[a-z0-9\._-]+\b/i))return"variable";if(xe.inlinePairs==0&&me.match(/^\s*-?[0-9\.\,]+\s?$/)||xe.inlinePairs>0&&me.match(/^\s*-?[0-9\.\,]+\s?(?=(,|}))/))return"number";if(me.match(Q))return"keyword"}return!xe.pair&&me.match(/^\s*(?:[,\[\]{}&*!|>'"%@`][^\s'":]|[^,\[\]{}#&*!|>'"%@`])[^#]*?(?=\s*:($|\s))/)?(xe.pair=!0,xe.keyCol=me.indentation(),"atom"):xe.pair&&me.match(/^:\s*/)?(xe.pairStart=!0,"meta"):(xe.pairStart=!1,xe.escaped=Xe=="\\",me.next(),null)},startState:function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}},languageData:{commentTokens:{line:"#"}}}},55620:function(Oi,si,Ve){Ve.d(si,{Fv:function(){return ri}});var w=Ve(95885),Q=Ve(1727),Z=Ve(30656);class me{constructor(q,ne,re){this.from=q,this.to=ne,this.diagnostic=re}}class xe{constructor(q,ne,re){this.diagnostics=q,this.panel=ne,this.selected=re}static init(q,ne,re){let fe=q,ve=re.facet(at).markerFilter;ve&&(fe=ve(fe));let Ae=w.p.set(fe.map(Oe=>Oe.from==Oe.to||Oe.from==Oe.to-1&&re.doc.lineAt(Oe.from).to==Oe.from?w.p.widget({widget:new nt(Oe),diagnostic:Oe}).range(Oe.from):w.p.mark({attributes:{class:"cm-lintRange cm-lintRange-"+Oe.severity},diagnostic:Oe}).range(Oe.from,Oe.to)),!0);return new xe(Ae,ne,Xe(Ae))}}function Xe(ee,q=null,ne=0){let re=null;return ee.between(ne,1e9,(fe,ve,{spec:Ae})=>{if(!(q&&Ae.diagnostic!=q))return re=new me(fe,ve,Ae.diagnostic),!1}),re}function Ze(ee,q){return!!(ee.effects.some(ne=>ne.is(He))||ee.changes.touchesRange(q.pos))}function Mt(ee,q){return ee.field(Ee,!1)?q:q.concat(Q.Py.appendConfig.of([Ee,w.tk.decorations.compute([Ee],ne=>{let{selected:re,panel:fe}=ne.field(Ee);return!re||!fe||re.from==re.to?w.p.none:w.p.set([dt.range(re.from,re.to)])}),(0,w.bF)(Gt,{hideOn:Ze}),Wt]))}function Rt(ee,q){return{effects:Mt(ee,[He.of(q)])}}const He=Q.Py.define(),tt=Q.Py.define(),Dt=Q.Py.define(),Ee=Q.QQ.define({create(){return new xe(w.p.none,null,null)},update(ee,q){if(q.docChanged){let ne=ee.diagnostics.map(q.changes),re=null;if(ee.selected){let fe=q.changes.mapPos(ee.selected.from,1);re=Xe(ne,ee.selected.diagnostic,fe)||Xe(ne,null,fe)}ee=new xe(ne,ee.panel,re)}for(let ne of q.effects)ne.is(He)?ee=xe.init(ne.value,ee.panel,q.state):ne.is(tt)?ee=new xe(ee.diagnostics,ne.value?Pt.open:null,ee.selected):ne.is(Dt)&&(ee=new xe(ee.diagnostics,ee.panel,ne.value));return ee},provide:ee=>[w.mH.from(ee,q=>q.panel),w.tk.decorations.from(ee,q=>q.diagnostics)]});function It(ee){let q=ee.field(Ee,!1);return q?q.diagnostics.size:0}const dt=w.p.mark({class:"cm-lintRange cm-lintRange-active"});function Gt(ee,q,ne){let{diagnostics:re}=ee.state.field(Ee),fe=[],ve=2e8,Ae=0;re.between(q-(ne<0?1:0),q+(ne>0?1:0),(Fe,Re,{spec:qe})=>{q>=Fe&&q<=Re&&(Fe==Re||(q>Fe||ne>0)&&(q<Re||ne<0))&&(fe.push(qe.diagnostic),ve=Math.min(Fe,ve),Ae=Math.max(Re,Ae))});let Oe=ee.state.facet(at).tooltipFilter;return Oe&&(fe=Oe(fe)),fe.length?{pos:ve,end:Ae,above:ee.state.doc.lineAt(ve).to<Ae,create(){return{dom:ii(ee,fe)}}}:null}function ii(ee,q){return(0,Z.Z)("ul",{class:"cm-tooltip-lint"},q.map(ne=>We(ee,ne,!1)))}const ni=ee=>{let q=ee.state.field(Ee,!1);(!q||!q.panel)&&ee.dispatch({effects:Mt(ee.state,[tt.of(!0)])});let ne=(0,w.Sd)(ee,Pt.open);return ne&&ne.dom.querySelector(".cm-panel-lint ul").focus(),!0},_e=ee=>{let q=ee.state.field(Ee,!1);return!q||!q.panel?!1:(ee.dispatch({effects:tt.of(!1)}),!0)},ri=[{key:"Mod-Shift-m",run:ni,preventDefault:!0},{key:"F8",run:ee=>{let q=ee.state.field(Ee,!1);if(!q)return!1;let ne=ee.state.selection.main,re=q.diagnostics.iter(ne.to+1);return!re.value&&(re=q.diagnostics.iter(0),!re.value||re.from==ne.from&&re.to==ne.to)?!1:(ee.dispatch({selection:{anchor:re.from,head:re.to},scrollIntoView:!0}),!0)}}],ft=w.lg.fromClass(class{constructor(ee){this.view=ee,this.timeout=-1,this.set=!0;let{delay:q}=ee.state.facet(at);this.lintTime=Date.now()+q,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,q)}run(){let ee=Date.now();if(ee<this.lintTime-10)setTimeout(this.run,this.lintTime-ee);else{this.set=!1;let{state:q}=this.view,{sources:ne}=q.facet(at);Promise.all(ne.map(re=>Promise.resolve(re(this.view)))).then(re=>{let fe=re.reduce((ve,Ae)=>ve.concat(Ae));this.view.state.doc==q.doc&&this.view.dispatch(Rt(this.view.state,fe))},re=>{(0,w.OO)(this.view.state,re)})}}update(ee){let q=ee.state.facet(at);(ee.docChanged||q!=ee.startState.facet(at)||q.needsRefresh&&q.needsRefresh(ee))&&(this.lintTime=Date.now()+q.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,q.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),at=Q.r$.define({combine(ee){return Object.assign({sources:ee.map(q=>q.source)},(0,Q.BO)(ee.map(q=>q.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(q,ne)=>q?ne?re=>q(re)||ne(re):q:ne}))},enables:ft});function Ot(ee,q={}){return at.of({source:ee,config:q})}function At(ee){let q=ee.plugin(ft);q&&q.force()}function Je(ee){let q=[];if(ee)e:for(let{name:ne}of ee){for(let re=0;re<ne.length;re++){let fe=ne[re];if(/[a-zA-Z]/.test(fe)&&!q.some(ve=>ve.toLowerCase()==fe.toLowerCase())){q.push(fe);continue e}}q.push("")}return q}function We(ee,q,ne){var re;let fe=ne?Je(q.actions):[];return(0,Z.Z)("li",{class:"cm-diagnostic cm-diagnostic-"+q.severity},(0,Z.Z)("span",{class:"cm-diagnosticText"},q.renderMessage?q.renderMessage():q.message),(re=q.actions)===null||re===void 0?void 0:re.map((ve,Ae)=>{let Oe=!1,Fe=Lt=>{if(Lt.preventDefault(),Oe)return;Oe=!0;let vt=Xe(ee.state.field(Ee).diagnostics,q);vt&&ve.apply(ee,vt.from,vt.to)},{name:Re}=ve,qe=fe[Ae]?Re.indexOf(fe[Ae]):-1,Et=qe<0?Re:[Re.slice(0,qe),(0,Z.Z)("u",Re.slice(qe,qe+1)),Re.slice(qe+1)];return(0,Z.Z)("button",{type:"button",class:"cm-diagnosticAction",onclick:Fe,onmousedown:Fe,"aria-label":` Action: ${Re}${qe<0?"":` (access key "${fe[Ae]})"`}.`},Et)}),q.source&&(0,Z.Z)("div",{class:"cm-diagnosticSource"},q.source))}class nt extends w.l9{constructor(q){super(),this.diagnostic=q}eq(q){return q.diagnostic==this.diagnostic}toDOM(){return(0,Z.Z)("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class Ne{constructor(q,ne){this.diagnostic=ne,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=We(q,ne,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Pt{constructor(q){this.view=q,this.items=[];let ne=fe=>{if(fe.keyCode==27)_e(this.view),this.view.focus();else if(fe.keyCode==38||fe.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(fe.keyCode==40||fe.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(fe.keyCode==36)this.moveSelection(0);else if(fe.keyCode==35)this.moveSelection(this.items.length-1);else if(fe.keyCode==13)this.view.focus();else if(fe.keyCode>=65&&fe.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:ve}=this.items[this.selectedIndex],Ae=Je(ve.actions);for(let Oe=0;Oe<Ae.length;Oe++)if(Ae[Oe].toUpperCase().charCodeAt(0)==fe.keyCode){let Fe=Xe(this.view.state.field(Ee).diagnostics,ve);Fe&&ve.actions[Oe].apply(q,Fe.from,Fe.to)}}else return;fe.preventDefault()},re=fe=>{for(let ve=0;ve<this.items.length;ve++)this.items[ve].dom.contains(fe.target)&&this.moveSelection(ve)};this.list=(0,Z.Z)("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:ne,onclick:re}),this.dom=(0,Z.Z)("div",{class:"cm-panel-lint"},this.list,(0,Z.Z)("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>_e(this.view)},"\xD7")),this.update()}get selectedIndex(){let q=this.view.state.field(Ee).selected;if(!q)return-1;for(let ne=0;ne<this.items.length;ne++)if(this.items[ne].diagnostic==q.diagnostic)return ne;return-1}update(){let{diagnostics:q,selected:ne}=this.view.state.field(Ee),re=0,fe=!1,ve=null;for(q.between(0,this.view.state.doc.length,(Ae,Oe,{spec:Fe})=>{let Re=-1,qe;for(let Et=re;Et<this.items.length;Et++)if(this.items[Et].diagnostic==Fe.diagnostic){Re=Et;break}Re<0?(qe=new Ne(this.view,Fe.diagnostic),this.items.splice(re,0,qe),fe=!0):(qe=this.items[Re],Re>re&&(this.items.splice(re,Re-re),fe=!0)),ne&&qe.diagnostic==ne.diagnostic?qe.dom.hasAttribute("aria-selected")||(qe.dom.setAttribute("aria-selected","true"),ve=qe):qe.dom.hasAttribute("aria-selected")&&qe.dom.removeAttribute("aria-selected"),re++});re<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)fe=!0,this.items.pop();this.items.length==0&&(this.items.push(new Ne(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),fe=!0),ve?(this.list.setAttribute("aria-activedescendant",ve.id),this.view.requestMeasure({key:this,read:()=>({sel:ve.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:Ae,panel:Oe})=>{Ae.top<Oe.top?this.list.scrollTop-=Oe.top-Ae.top:Ae.bottom>Oe.bottom&&(this.list.scrollTop+=Ae.bottom-Oe.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),fe&&this.sync()}sync(){let q=this.list.firstChild;function ne(){let re=q;q=re.nextSibling,re.remove()}for(let re of this.items)if(re.dom.parentNode==this.list){for(;q!=re.dom;)ne();q=re.dom.nextSibling}else this.list.insertBefore(re.dom,q);for(;q;)ne()}moveSelection(q){if(this.selectedIndex<0)return;let ne=this.view.state.field(Ee),re=Xe(ne.diagnostics,this.items[q].diagnostic);re&&this.view.dispatch({selection:{anchor:re.from,head:re.to},scrollIntoView:!0,effects:Dt.of(re)})}static open(q){return new Pt(q)}}function pt(ee,q='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${q}>${encodeURIComponent(ee)}</svg>')`}function Nt(ee){return pt(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${ee}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const Wt=w.tk.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Nt("#d11")},".cm-lintRange-warning":{backgroundImage:Nt("orange")},".cm-lintRange-info":{backgroundImage:Nt("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});class Be extends w.SJ{constructor(q){super(),this.diagnostics=q,this.severity=q.reduce((ne,re)=>{let fe=re.severity;return fe=="error"||fe=="warning"&&ne=="info"?fe:ne},"info")}toDOM(q){let ne=document.createElement("div");ne.className="cm-lint-marker cm-lint-marker-"+this.severity;let re=this.diagnostics,fe=q.state.facet(xt).tooltipFilter;return fe&&(re=fe(re)),re.length&&(ne.onmouseover=()=>Ye(q,ne,re)),ne}}function Ge(ee,q){let ne=re=>{let fe=q.getBoundingClientRect();if(!(re.clientX>fe.left-10&&re.clientX<fe.right+10&&re.clientY>fe.top-10&&re.clientY<fe.bottom+10)){for(let ve=re.target;ve;ve=ve.parentNode)if(ve.nodeType==1&&ve.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",ne),ee.state.field(st)&&ee.dispatch({effects:Bt.of(null)})}};window.addEventListener("mousemove",ne)}function Ye(ee,q,ne){function re(){let Ae=ee.elementAtHeight(q.getBoundingClientRect().top+5-ee.documentTop);ee.coordsAtPos(Ae.from)&&ee.dispatch({effects:Bt.of({pos:Ae.from,above:!1,create(){return{dom:ii(ee,ne),getCoords:()=>q.getBoundingClientRect()}}})}),q.onmouseout=q.onmousemove=null,Ge(ee,q)}let{hoverTime:fe}=ee.state.facet(xt),ve=setTimeout(re,fe);q.onmouseout=()=>{clearTimeout(ve),q.onmouseout=q.onmousemove=null},q.onmousemove=()=>{clearTimeout(ve),ve=setTimeout(re,fe)}}function ht(ee,q){let ne=Object.create(null);for(let fe of q){let ve=ee.lineAt(fe.from);(ne[ve.from]||(ne[ve.from]=[])).push(fe)}let re=[];for(let fe in ne)re.push(new Be(ne[fe]).range(+fe));return Q.Xs.of(re,!0)}const Tt=(0,w.v5)({class:"cm-gutter-lint",markers:ee=>ee.state.field(wt)}),wt=Q.QQ.define({create(){return Q.Xs.empty},update(ee,q){ee=ee.map(q.changes);let ne=q.state.facet(xt).markerFilter;for(let re of q.effects)if(re.is(He)){let fe=re.value;ne&&(fe=ne(fe||[])),ee=ht(q.state.doc,fe.slice(0))}return ee}}),Bt=Q.Py.define(),st=Q.QQ.define({create(){return null},update(ee,q){return ee&&q.docChanged&&(ee=Ze(q,ee)?null:Object.assign(Object.assign({},ee),{pos:q.changes.mapPos(ee.pos)})),q.effects.reduce((ne,re)=>re.is(Bt)?re.value:ne,ee)},provide:ee=>w.hJ.from(ee)}),rt=w.tk.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:pt('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:pt('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:pt('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),xt=Q.r$.define({combine(ee){return(0,Q.BO)(ee,{hoverTime:300,markerFilter:null,tooltipFilter:null})}});function _t(ee={}){return[xt.of(ee),wt,Tt,rt,st]}function pe(ee,q){let ne=ee.field(Ee,!1);if(ne&&ne.diagnostics.size)for(let re=RangeSet.iter([ne.diagnostics]);re.value;re.next())q(re.value.spec.diagnostic,re.from,re.to)}},8580:function(Oi,si,Ve){Ve.d(si,{Lp:function(){return $t},sW:function(){return ri}});var w=Ve(95885),Q=Ve(1727),Z=Ve(30656);const me=typeof String.prototype.normalize=="function"?H=>H.normalize("NFKD"):H=>H;class xe{constructor(A,W,z=0,_=A.length,se,ye){this.test=ye,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=A.iterRange(z,_),this.bufferStart=z,this.normalize=se?we=>se(me(we)):me,this.query=this.normalize(W)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return(0,Q.gm)(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let A=this.peek();if(A<0)return this.done=!0,this;let W=(0,Q.bg)(A),z=this.bufferStart+this.bufferPos;this.bufferPos+=(0,Q.nZ)(A);let _=this.normalize(W);for(let se=0,ye=z;;se++){let we=_.charCodeAt(se),Me=this.match(we,ye);if(Me)return this.value=Me,this;if(se==_.length-1)break;ye==z&&se<W.length&&W.charCodeAt(se)==we&&ye++}}}match(A,W){let z=null;for(let _=0;_<this.matches.length;_+=2){let se=this.matches[_],ye=!1;this.query.charCodeAt(se)==A&&(se==this.query.length-1?z={from:this.matches[_+1],to:W+1}:(this.matches[_]++,ye=!0)),ye||(this.matches.splice(_,2),_-=2)}return this.query.charCodeAt(0)==A&&(this.query.length==1?z={from:W,to:W+1}:this.matches.push(1,W)),z&&this.test&&!this.test(z.from,z.to,this.buffer,this.bufferPos)&&(z=null),z}}typeof Symbol!="undefined"&&(xe.prototype[Symbol.iterator]=function(){return this});const Xe={from:-1,to:-1,match:/.*/.exec("")},Ze="gm"+(/x/.unicode==null?"":"u");class Mt{constructor(A,W,z,_=0,se=A.length){if(this.text=A,this.to=se,this.curLine="",this.done=!1,this.value=Xe,/\\[sWDnr]|\n|\r|\[\^/.test(W))return new tt(A,W,z,_,se);this.re=new RegExp(W,Ze+(z!=null&&z.ignoreCase?"i":"")),this.test=z==null?void 0:z.test,this.iter=A.iter();let ye=A.lineAt(_);this.curLineStart=ye.from,this.matchPos=Ee(A,_),this.getLine(this.curLineStart)}getLine(A){this.iter.next(A),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let A=this.matchPos-this.curLineStart;;){this.re.lastIndex=A;let W=this.matchPos<=this.to&&this.re.exec(this.curLine);if(W){let z=this.curLineStart+W.index,_=z+W[0].length;if(this.matchPos=Ee(this.text,_+(z==_?1:0)),z==this.curLineStart+this.curLine.length&&this.nextLine(),(z<_||z>this.value.to)&&(!this.test||this.test(z,_,W)))return this.value={from:z,to:_,match:W},this;A=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),A=0;else return this.done=!0,this}}}const Rt=new WeakMap;class He{constructor(A,W){this.from=A,this.text=W}get to(){return this.from+this.text.length}static get(A,W,z){let _=Rt.get(A);if(!_||_.from>=z||_.to<=W){let we=new He(W,A.sliceString(W,z));return Rt.set(A,we),we}if(_.from==W&&_.to==z)return _;let{text:se,from:ye}=_;return ye>W&&(se=A.sliceString(W,ye)+se,ye=W),_.to<z&&(se+=A.sliceString(_.to,z)),Rt.set(A,new He(ye,se)),new He(W,se.slice(W-ye,z-ye))}}class tt{constructor(A,W,z,_,se){this.text=A,this.to=se,this.done=!1,this.value=Xe,this.matchPos=Ee(A,_),this.re=new RegExp(W,Ze+(z!=null&&z.ignoreCase?"i":"")),this.test=z==null?void 0:z.test,this.flat=He.get(A,_,this.chunkEnd(_+5e3))}chunkEnd(A){return A>=this.to?this.to:this.text.lineAt(A).to}next(){for(;;){let A=this.re.lastIndex=this.matchPos-this.flat.from,W=this.re.exec(this.flat.text);if(W&&!W[0]&&W.index==A&&(this.re.lastIndex=A+1,W=this.re.exec(this.flat.text)),W){let z=this.flat.from+W.index,_=z+W[0].length;if((this.flat.to>=this.to||W.index+W[0].length<=this.flat.text.length-10)&&(!this.test||this.test(z,_,W)))return this.value={from:z,to:_,match:W},this.matchPos=Ee(this.text,_+(z==_?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=He.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol!="undefined"&&(Mt.prototype[Symbol.iterator]=tt.prototype[Symbol.iterator]=function(){return this});function Dt(H){try{return new RegExp(H,Ze),!0}catch{return!1}}function Ee(H,A){if(A>=H.length)return A;let W=H.lineAt(A),z;for(;A<W.to&&(z=W.text.charCodeAt(A-W.from))>=56320&&z<57344;)A++;return A}function It(H){let A=(0,Z.Z)("input",{class:"cm-textfield",name:"line"}),W=(0,Z.Z)("form",{class:"cm-gotoLine",onkeydown:_=>{_.keyCode==27?(_.preventDefault(),H.dispatch({effects:dt.of(!1)}),H.focus()):_.keyCode==13&&(_.preventDefault(),z())},onsubmit:_=>{_.preventDefault(),z()}},(0,Z.Z)("label",H.state.phrase("Go to line"),": ",A)," ",(0,Z.Z)("button",{class:"cm-button",type:"submit"},H.state.phrase("go")));function z(){let _=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(A.value);if(!_)return;let{state:se}=H,ye=se.doc.lineAt(se.selection.main.head),[,we,Me,De,ot]=_,ct=De?+De.slice(1):0,yt=Me?+Me:ye.number;if(Me&&ot){let Qt=yt/100;we&&(Qt=Qt*(we=="-"?-1:1)+ye.number/se.doc.lines),yt=Math.round(se.doc.lines*Qt)}else Me&&we&&(yt=yt*(we=="-"?-1:1)+ye.number);let li=se.doc.line(Math.max(1,Math.min(se.doc.lines,yt)));H.dispatch({effects:dt.of(!1),selection:Q.jT.cursor(li.from+Math.max(0,Math.min(ct,li.length))),scrollIntoView:!0}),H.focus()}return{dom:W}}const dt=Q.Py.define(),Gt=Q.QQ.define({create(){return!0},update(H,A){for(let W of A.effects)W.is(dt)&&(H=W.value);return H},provide:H=>w.mH.from(H,A=>A?It:null)}),ii=H=>{let A=(0,w.Sd)(H,It);if(!A){let W=[dt.of(!0)];H.state.field(Gt,!1)==null&&W.push(Q.Py.appendConfig.of([Gt,ni])),H.dispatch({effects:W}),A=(0,w.Sd)(H,It)}return A&&A.dom.querySelector("input").focus(),!0},ni=w.tk.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),_e={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},bt=Q.r$.define({combine(H){return(0,Q.BO)(H,_e,{highlightWordAroundCursor:(A,W)=>A||W,minSelectionLength:Math.min,maxMatches:Math.min})}});function ri(H){let A=[We,Je];return H&&A.push(bt.of(H)),A}const ft=w.p.mark({class:"cm-selectionMatch"}),at=w.p.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function Ot(H,A,W,z){return(W==0||H(A.sliceDoc(W-1,W))!=Q.D0.Word)&&(z==A.doc.length||H(A.sliceDoc(z,z+1))!=Q.D0.Word)}function At(H,A,W,z){return H(A.sliceDoc(W,W+1))==Q.D0.Word&&H(A.sliceDoc(z-1,z))==Q.D0.Word}const Je=w.lg.fromClass(class{constructor(H){this.decorations=this.getDeco(H)}update(H){(H.selectionSet||H.docChanged||H.viewportChanged)&&(this.decorations=this.getDeco(H.view))}getDeco(H){let A=H.state.facet(bt),{state:W}=H,z=W.selection;if(z.ranges.length>1)return w.p.none;let _=z.main,se,ye=null;if(_.empty){if(!A.highlightWordAroundCursor)return w.p.none;let Me=W.wordAt(_.head);if(!Me)return w.p.none;ye=W.charCategorizer(_.head),se=W.sliceDoc(Me.from,Me.to)}else{let Me=_.to-_.from;if(Me<A.minSelectionLength||Me>200)return w.p.none;if(A.wholeWords){if(se=W.sliceDoc(_.from,_.to),ye=W.charCategorizer(_.head),!(Ot(ye,W,_.from,_.to)&&At(ye,W,_.from,_.to)))return w.p.none}else if(se=W.sliceDoc(_.from,_.to).trim(),!se)return w.p.none}let we=[];for(let Me of H.visibleRanges){let De=new xe(W.doc,se,Me.from,Me.to);for(;!De.next().done;){let{from:ot,to:ct}=De.value;if((!ye||Ot(ye,W,ot,ct))&&(_.empty&&ot<=_.from&&ct>=_.to?we.push(at.range(ot,ct)):(ot>=_.to||ct<=_.from)&&we.push(ft.range(ot,ct)),we.length>A.maxMatches))return w.p.none}}return w.p.set(we)}},{decorations:H=>H.decorations}),We=w.tk.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),nt=({state:H,dispatch:A})=>{let{selection:W}=H,z=Q.jT.create(W.ranges.map(_=>H.wordAt(_.head)||Q.jT.cursor(_.head)),W.mainIndex);return z.eq(W)?!1:(A(H.update({selection:z})),!0)};function Ne(H,A){let{main:W,ranges:z}=H.selection,_=H.wordAt(W.head),se=_&&_.from==W.from&&_.to==W.to;for(let ye=!1,we=new xe(H.doc,A,z[z.length-1].to);;)if(we.next(),we.done){if(ye)return null;we=new xe(H.doc,A,0,Math.max(0,z[z.length-1].from-1)),ye=!0}else{if(ye&&z.some(Me=>Me.from==we.value.from))continue;if(se){let Me=H.wordAt(we.value.from);if(!Me||Me.from!=we.value.from||Me.to!=we.value.to)continue}return we.value}}const Pt=({state:H,dispatch:A})=>{let{ranges:W}=H.selection;if(W.some(se=>se.from===se.to))return nt({state:H,dispatch:A});let z=H.sliceDoc(W[0].from,W[0].to);if(H.selection.ranges.some(se=>H.sliceDoc(se.from,se.to)!=z))return!1;let _=Ne(H,z);return _?(A(H.update({selection:H.selection.addRange(Q.jT.range(_.from,_.to),!1),effects:w.tk.scrollIntoView(_.to)})),!0):!1},pt=Q.r$.define({combine(H){return(0,Q.BO)(H,{top:!1,caseSensitive:!1,literal:!1,wholeWord:!1,createPanel:A=>new Ke(A),scrollToMatch:A=>w.tk.scrollIntoView(A)})}});function Nt(H){return H?[pt.of(H),oi]:oi}class Wt{constructor(A){this.search=A.search,this.caseSensitive=!!A.caseSensitive,this.literal=!!A.literal,this.regexp=!!A.regexp,this.replace=A.replace||"",this.valid=!!this.search&&(!this.regexp||Dt(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!A.wholeWord}unquote(A){return this.literal?A:A.replace(/\\([nrt\\])/g,(W,z)=>z=="n"?`
`:z=="r"?"\r":z=="t"?"	":"\\")}eq(A){return this.search==A.search&&this.replace==A.replace&&this.caseSensitive==A.caseSensitive&&this.regexp==A.regexp&&this.wholeWord==A.wholeWord}create(){return this.regexp?new rt(this):new ht(this)}getCursor(A,W=0,z){let _=A.doc?A:Q.yy.create({doc:A});return z==null&&(z=_.doc.length),this.regexp?Tt(this,_,W,z):Ge(this,_,W,z)}}class Be{constructor(A){this.spec=A}}function Ge(H,A,W,z){return new xe(A.doc,H.unquoted,W,z,H.caseSensitive?void 0:_=>_.toLowerCase(),H.wholeWord?Ye(A.doc,A.charCategorizer(A.selection.main.head)):void 0)}function Ye(H,A){return(W,z,_,se)=>((se>W||se+_.length<z)&&(se=Math.max(0,W-2),_=H.sliceString(se,Math.min(H.length,z+2))),(A(wt(_,W-se))!=Q.D0.Word||A(Bt(_,W-se))!=Q.D0.Word)&&(A(Bt(_,z-se))!=Q.D0.Word||A(wt(_,z-se))!=Q.D0.Word))}class ht extends Be{constructor(A){super(A)}nextMatch(A,W,z){let _=Ge(this.spec,A,z,A.doc.length).nextOverlapping();return _.done&&(_=Ge(this.spec,A,0,W).nextOverlapping()),_.done?null:_.value}prevMatchInRange(A,W,z){for(let _=z;;){let se=Math.max(W,_-1e4-this.spec.unquoted.length),ye=Ge(this.spec,A,se,_),we=null;for(;!ye.nextOverlapping().done;)we=ye.value;if(we)return we;if(se==W)return null;_-=1e4}}prevMatch(A,W,z){return this.prevMatchInRange(A,0,W)||this.prevMatchInRange(A,z,A.doc.length)}getReplacement(A){return this.spec.unquote(this.spec.replace)}matchAll(A,W){let z=Ge(this.spec,A,0,A.doc.length),_=[];for(;!z.next().done;){if(_.length>=W)return null;_.push(z.value)}return _}highlight(A,W,z,_){let se=Ge(this.spec,A,Math.max(0,W-this.spec.unquoted.length),Math.min(z+this.spec.unquoted.length,A.doc.length));for(;!se.next().done;)_(se.value.from,se.value.to)}}function Tt(H,A,W,z){return new Mt(A.doc,H.search,{ignoreCase:!H.caseSensitive,test:H.wholeWord?st(A.charCategorizer(A.selection.main.head)):void 0},W,z)}function wt(H,A){return H.slice((0,Q.cp)(H,A,!1),A)}function Bt(H,A){return H.slice(A,(0,Q.cp)(H,A))}function st(H){return(A,W,z)=>!z[0].length||(H(wt(z.input,z.index))!=Q.D0.Word||H(Bt(z.input,z.index))!=Q.D0.Word)&&(H(Bt(z.input,z.index+z[0].length))!=Q.D0.Word||H(wt(z.input,z.index+z[0].length))!=Q.D0.Word)}class rt extends Be{nextMatch(A,W,z){let _=Tt(this.spec,A,z,A.doc.length).next();return _.done&&(_=Tt(this.spec,A,0,W).next()),_.done?null:_.value}prevMatchInRange(A,W,z){for(let _=1;;_++){let se=Math.max(W,z-_*1e4),ye=Tt(this.spec,A,se,z),we=null;for(;!ye.next().done;)we=ye.value;if(we&&(se==W||we.from>se+10))return we;if(se==W)return null}}prevMatch(A,W,z){return this.prevMatchInRange(A,0,W)||this.prevMatchInRange(A,z,A.doc.length)}getReplacement(A){return this.spec.unquote(this.spec.replace.replace(/\$([$&\d+])/g,(W,z)=>z=="$"?"$":z=="&"?A.match[0]:z!="0"&&+z<A.match.length?A.match[z]:W))}matchAll(A,W){let z=Tt(this.spec,A,0,A.doc.length),_=[];for(;!z.next().done;){if(_.length>=W)return null;_.push(z.value)}return _}highlight(A,W,z,_){let se=Tt(this.spec,A,Math.max(0,W-250),Math.min(z+250,A.doc.length));for(;!se.next().done;)_(se.value.from,se.value.to)}}const xt=Q.Py.define(),_t=Q.Py.define(),pe=Q.QQ.define({create(H){return new ne(Ft(H).create(),null)},update(H,A){for(let W of A.effects)W.is(xt)?H=new ne(W.value.create(),H.panel):W.is(_t)&&(H=new ne(H.query,W.value?vt:null));return H},provide:H=>w.mH.from(H,A=>A.panel)});function ee(H){let A=H.field(pe,!1);return A?A.query.spec:Ft(H)}function q(H){var A;return((A=H.field(pe,!1))===null||A===void 0?void 0:A.panel)!=null}class ne{constructor(A,W){this.query=A,this.panel=W}}const re=w.p.mark({class:"cm-searchMatch"}),fe=w.p.mark({class:"cm-searchMatch cm-searchMatch-selected"}),ve=w.lg.fromClass(class{constructor(H){this.view=H,this.decorations=this.highlight(H.state.field(pe))}update(H){let A=H.state.field(pe);(A!=H.startState.field(pe)||H.docChanged||H.selectionSet||H.viewportChanged)&&(this.decorations=this.highlight(A))}highlight({query:H,panel:A}){if(!A||!H.spec.valid)return w.p.none;let{view:W}=this,z=new Q.f_;for(let _=0,se=W.visibleRanges,ye=se.length;_<ye;_++){let{from:we,to:Me}=se[_];for(;_<ye-1&&Me>se[_+1].from-2*250;)Me=se[++_].to;H.highlight(W.state,we,Me,(De,ot)=>{let ct=W.state.selection.ranges.some(yt=>yt.from==De&&yt.to==ot);z.add(De,ot,ct?fe:re)})}return z.finish()}},{decorations:H=>H.decorations});function Ae(H){return A=>{let W=A.state.field(pe,!1);return W&&W.query.spec.valid?H(A,W):kt(A)}}const Oe=Ae((H,{query:A})=>{let{to:W}=H.state.selection.main,z=A.nextMatch(H.state,W,W);if(!z)return!1;let _=Q.jT.single(z.from,z.to),se=H.state.facet(pt);return H.dispatch({selection:_,effects:[Vt(H,z),se.scrollToMatch(_.main)],userEvent:"select.search"}),!0}),Fe=Ae((H,{query:A})=>{let{state:W}=H,{from:z}=W.selection.main,_=A.prevMatch(W,z,z);if(!_)return!1;let se=Q.jT.single(_.from,_.to),ye=H.state.facet(pt);return H.dispatch({selection:se,effects:[Vt(H,_),ye.scrollToMatch(se.main)],userEvent:"select.search"}),!0}),Re=Ae((H,{query:A})=>{let W=A.matchAll(H.state,1e3);return!W||!W.length?!1:(H.dispatch({selection:Q.jT.create(W.map(z=>Q.jT.range(z.from,z.to))),userEvent:"select.search.matches"}),!0)}),qe=({state:H,dispatch:A})=>{let W=H.selection;if(W.ranges.length>1||W.main.empty)return!1;let{from:z,to:_}=W.main,se=[],ye=0;for(let we=new xe(H.doc,H.sliceDoc(z,_));!we.next().done;){if(se.length>1e3)return!1;we.value.from==z&&(ye=se.length),se.push(Q.jT.range(we.value.from,we.value.to))}return A(H.update({selection:Q.jT.create(se,ye),userEvent:"select.search.matches"})),!0},Et=Ae((H,{query:A})=>{let{state:W}=H,{from:z,to:_}=W.selection.main;if(W.readOnly)return!1;let se=A.nextMatch(W,z,z);if(!se)return!1;let ye=[],we,Me,De=[];if(se.from==z&&se.to==_&&(Me=W.toText(A.getReplacement(se)),ye.push({from:se.from,to:se.to,insert:Me}),se=A.nextMatch(W,se.from,se.to),De.push(w.tk.announce.of(W.phrase("replaced match on line $",W.doc.lineAt(z).number)+"."))),se){let ot=ye.length==0||ye[0].from>=se.to?0:se.to-se.from-Me.length;we=Q.jT.single(se.from-ot,se.to-ot),De.push(Vt(H,se)),De.push(W.facet(pt).scrollToMatch(we.main))}return H.dispatch({changes:ye,selection:we,effects:De,userEvent:"input.replace"}),!0}),Lt=Ae((H,{query:A})=>{if(H.state.readOnly)return!1;let W=A.matchAll(H.state,1e9).map(_=>{let{from:se,to:ye}=_;return{from:se,to:ye,insert:A.getReplacement(_)}});if(!W.length)return!1;let z=H.state.phrase("replaced $ matches",W.length)+".";return H.dispatch({changes:W,effects:w.tk.announce.of(z),userEvent:"input.replace.all"}),!0});function vt(H){return H.state.facet(pt).createPanel(H)}function Ft(H,A){var W,z,_,se;let ye=H.selection.main,we=ye.empty||ye.to>ye.from+100?"":H.sliceDoc(ye.from,ye.to);if(A&&!we)return A;let Me=H.facet(pt);return new Wt({search:((W=A==null?void 0:A.literal)!==null&&W!==void 0?W:Me.literal)?we:we.replace(/\n/g,"\\n"),caseSensitive:(z=A==null?void 0:A.caseSensitive)!==null&&z!==void 0?z:Me.caseSensitive,literal:(_=A==null?void 0:A.literal)!==null&&_!==void 0?_:Me.literal,wholeWord:(se=A==null?void 0:A.wholeWord)!==null&&se!==void 0?se:Me.wholeWord})}const kt=H=>{let A=H.state.field(pe,!1);if(A&&A.panel){let W=(0,w.Sd)(H,vt);if(!W)return!1;let z=W.dom.querySelector("[main-field]");if(z&&z!=H.root.activeElement){let _=Ft(H.state,A.query.spec);_.valid&&H.dispatch({effects:xt.of(_)}),z.focus(),z.select()}}else H.dispatch({effects:[_t.of(!0),A?xt.of(Ft(H.state,A.query.spec)):Q.Py.appendConfig.of(oi)]});return!0},qt=H=>{let A=H.state.field(pe,!1);if(!A||!A.panel)return!1;let W=(0,w.Sd)(H,vt);return W&&W.dom.contains(H.root.activeElement)&&H.focus(),H.dispatch({effects:_t.of(!1)}),!0},$t=[{key:"Mod-f",run:kt,scope:"editor search-panel"},{key:"F3",run:Oe,shift:Fe,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Oe,shift:Fe,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:qt,scope:"editor search-panel"},{key:"Mod-Shift-l",run:qe},{key:"Alt-g",run:ii},{key:"Mod-d",run:Pt,preventDefault:!0}];class Ke{constructor(A){this.view=A;let W=this.query=A.state.field(pe).query.spec;this.commit=this.commit.bind(this),this.searchField=(0,Z.Z)("input",{value:W.search,placeholder:ke(A,"Find"),"aria-label":ke(A,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=(0,Z.Z)("input",{value:W.replace,placeholder:ke(A,"Replace"),"aria-label":ke(A,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=(0,Z.Z)("input",{type:"checkbox",name:"case",form:"",checked:W.caseSensitive,onchange:this.commit}),this.reField=(0,Z.Z)("input",{type:"checkbox",name:"re",form:"",checked:W.regexp,onchange:this.commit}),this.wordField=(0,Z.Z)("input",{type:"checkbox",name:"word",form:"",checked:W.wholeWord,onchange:this.commit});function z(_,se,ye){return(0,Z.Z)("button",{class:"cm-button",name:_,onclick:se,type:"button"},ye)}this.dom=(0,Z.Z)("div",{onkeydown:_=>this.keydown(_),class:"cm-search"},[this.searchField,z("next",()=>Oe(A),[ke(A,"next")]),z("prev",()=>Fe(A),[ke(A,"previous")]),z("select",()=>Re(A),[ke(A,"all")]),(0,Z.Z)("label",null,[this.caseField,ke(A,"match case")]),(0,Z.Z)("label",null,[this.reField,ke(A,"regexp")]),(0,Z.Z)("label",null,[this.wordField,ke(A,"by word")]),...A.state.readOnly?[]:[(0,Z.Z)("br"),this.replaceField,z("replace",()=>Et(A),[ke(A,"replace")]),z("replaceAll",()=>Lt(A),[ke(A,"replace all")])],(0,Z.Z)("button",{name:"close",onclick:()=>qt(A),"aria-label":ke(A,"close"),type:"button"},["\xD7"])])}commit(){let A=new Wt({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});A.eq(this.query)||(this.query=A,this.view.dispatch({effects:xt.of(A)}))}keydown(A){(0,w.$1)(this.view,A,"search-panel")?A.preventDefault():A.keyCode==13&&A.target==this.searchField?(A.preventDefault(),(A.shiftKey?Fe:Oe)(this.view)):A.keyCode==13&&A.target==this.replaceField&&(A.preventDefault(),Et(this.view))}update(A){for(let W of A.transactions)for(let z of W.effects)z.is(xt)&&!z.value.eq(this.query)&&this.setQuery(z.value)}setQuery(A){this.query=A,this.searchField.value=A.search,this.replaceField.value=A.replace,this.caseField.checked=A.caseSensitive,this.reField.checked=A.regexp,this.wordField.checked=A.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(pt).top}}function ke(H,A){return H.state.phrase(A)}const it=30,ci=/[\s\.,:;?!]/;function Vt(H,{from:A,to:W}){let z=H.state.doc.lineAt(A),_=H.state.doc.lineAt(W).to,se=Math.max(z.from,A-it),ye=Math.min(_,W+it),we=H.state.sliceDoc(se,ye);if(se!=z.from){for(let Me=0;Me<it;Me++)if(!ci.test(we[Me+1])&&ci.test(we[Me])){we=we.slice(Me);break}}if(ye!=_){for(let Me=we.length-1;Me>we.length-it;Me--)if(!ci.test(we[Me-1])&&ci.test(we[Me])){we=we.slice(0,Me);break}}return w.tk.announce.of(`${H.state.phrase("current match")}. ${we} ${H.state.phrase("on line")} ${z.number}.`)}const pi=w.tk.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),oi=[pe,Q.Wl.lowest(ve),pi]},1727:function(Oi,si,Ve){Ve.d(si,{BO:function(){return ot},D0:function(){return _},Gz:function(){return Yt},IS:function(){return ki},Py:function(){return ke},QQ:function(){return _t},Wl:function(){return q},Xs:function(){return St},YW:function(){return it},as:function(){return Je},bg:function(){return ri},cp:function(){return dt},f_:function(){return Ht},gc:function(){return Ot},gm:function(){return bt},jT:function(){return Be},n0:function(){return At},nZ:function(){return ft},q6:function(){return qt},r$:function(){return ht},uU:function(){return ct},xv:function(){return w},yy:function(){return De}});class w{constructor(){}lineAt(r){if(r<0||r>this.length)throw new RangeError(`Invalid position ${r} in document of length ${this.length}`);return this.lineInner(r,!1,1,0)}line(r){if(r<1||r>this.lines)throw new RangeError(`Invalid line number ${r} in ${this.lines}-line document`);return this.lineInner(r,!0,1,0)}replace(r,l,c){let m=[];return this.decompose(0,r,m,2),c.length&&c.decompose(0,c.length,m,3),this.decompose(l,this.length,m,1),Z.from(m,this.length-(l-r)+c.length)}append(r){return this.replace(this.length,this.length,r)}slice(r,l=this.length){let c=[];return this.decompose(r,l,c,0),Z.from(c,l-r)}eq(r){if(r==this)return!0;if(r.length!=this.length||r.lines!=this.lines)return!1;let l=this.scanIdentical(r,1),c=this.length-this.scanIdentical(r,-1),m=new Ze(this),S=new Ze(r);for(let k=l,L=l;;){if(m.next(k),S.next(k),k=0,m.lineBreak!=S.lineBreak||m.done!=S.done||m.value!=S.value)return!1;if(L+=m.value.length,m.done||L>=c)return!0}}iter(r=1){return new Ze(this,r)}iterRange(r,l=this.length){return new Mt(this,r,l)}iterLines(r,l){let c;if(r==null)c=this.iter();else{l==null&&(l=this.lines+1);let m=this.line(r).from;c=this.iterRange(m,Math.max(m,l==this.lines+1?this.length:l<=1?0:this.line(l-1).to))}return new Rt(c)}toString(){return this.sliceString(0)}toJSON(){let r=[];return this.flatten(r),r}static of(r){if(r.length==0)throw new RangeError("A document must have at least one line");return r.length==1&&!r[0]?w.empty:r.length<=32?new Q(r):Z.from(Q.split(r,[]))}}class Q extends w{constructor(r,l=me(r)){super(),this.text=r,this.length=l}get lines(){return this.text.length}get children(){return null}lineInner(r,l,c,m){for(let S=0;;S++){let k=this.text[S],L=m+k.length;if((l?c:L)>=r)return new He(m,L,c,k);m=L+1,c++}}decompose(r,l,c,m){let S=r<=0&&l>=this.length?this:new Q(Xe(this.text,r,l),Math.min(l,this.length)-Math.max(0,r));if(m&1){let k=c.pop(),L=xe(S.text,k.text.slice(),0,S.length);if(L.length<=32)c.push(new Q(L,k.length+S.length));else{let V=L.length>>1;c.push(new Q(L.slice(0,V)),new Q(L.slice(V)))}}else c.push(S)}replace(r,l,c){if(!(c instanceof Q))return super.replace(r,l,c);let m=xe(this.text,xe(c.text,Xe(this.text,0,r)),l),S=this.length+c.length-(l-r);return m.length<=32?new Q(m,S):Z.from(Q.split(m,[]),S)}sliceString(r,l=this.length,c=`
`){let m="";for(let S=0,k=0;S<=l&&k<this.text.length;k++){let L=this.text[k],V=S+L.length;S>r&&k&&(m+=c),r<V&&l>S&&(m+=L.slice(Math.max(0,r-S),l-S)),S=V+1}return m}flatten(r){for(let l of this.text)r.push(l)}scanIdentical(){return 0}static split(r,l){let c=[],m=-1;for(let S of r)c.push(S),m+=S.length+1,c.length==32&&(l.push(new Q(c,m)),c=[],m=-1);return m>-1&&l.push(new Q(c,m)),l}}class Z extends w{constructor(r,l){super(),this.children=r,this.length=l,this.lines=0;for(let c of r)this.lines+=c.lines}lineInner(r,l,c,m){for(let S=0;;S++){let k=this.children[S],L=m+k.length,V=c+k.lines-1;if((l?V:L)>=r)return k.lineInner(r,l,c,m);m=L+1,c=V+1}}decompose(r,l,c,m){for(let S=0,k=0;k<=l&&S<this.children.length;S++){let L=this.children[S],V=k+L.length;if(r<=V&&l>=k){let te=m&((k<=r?1:0)|(V>=l?2:0));k>=r&&V<=l&&!te?c.push(L):L.decompose(r-k,l-k,c,te)}k=V+1}}replace(r,l,c){if(c.lines<this.lines)for(let m=0,S=0;m<this.children.length;m++){let k=this.children[m],L=S+k.length;if(r>=S&&l<=L){let V=k.replace(r-S,l-S,c),te=this.lines-k.lines+V.lines;if(V.lines<te>>5-1&&V.lines>te>>5+1){let he=this.children.slice();return he[m]=V,new Z(he,this.length-(l-r)+c.length)}return super.replace(S,L,V)}S=L+1}return super.replace(r,l,c)}sliceString(r,l=this.length,c=`
`){let m="";for(let S=0,k=0;S<this.children.length&&k<=l;S++){let L=this.children[S],V=k+L.length;k>r&&S&&(m+=c),r<V&&l>k&&(m+=L.sliceString(r-k,l-k,c)),k=V+1}return m}flatten(r){for(let l of this.children)l.flatten(r)}scanIdentical(r,l){if(!(r instanceof Z))return 0;let c=0,[m,S,k,L]=l>0?[0,0,this.children.length,r.children.length]:[this.children.length-1,r.children.length-1,-1,-1];for(;;m+=l,S+=l){if(m==k||S==L)return c;let V=this.children[m],te=r.children[S];if(V!=te)return c+V.scanIdentical(te,l);c+=V.length+1}}static from(r,l=r.reduce((c,m)=>c+m.length+1,-1)){let c=0;for(let g of r)c+=g.lines;if(c<32){let g=[];for(let T of r)T.flatten(g);return new Q(g,l)}let m=Math.max(32,c>>5),S=m<<1,k=m>>1,L=[],V=0,te=-1,he=[];function y(g){let T;if(g.lines>S&&g instanceof Z)for(let B of g.children)y(B);else g.lines>k&&(V>k||!V)?(f(),L.push(g)):g instanceof Q&&V&&(T=he[he.length-1])instanceof Q&&g.lines+T.lines<=32?(V+=g.lines,te+=g.length+1,he[he.length-1]=new Q(T.text.concat(g.text),T.length+1+g.length)):(V+g.lines>m&&f(),V+=g.lines,te+=g.length+1,he.push(g))}function f(){V!=0&&(L.push(he.length==1?he[0]:Z.from(he,te)),te=-1,V=he.length=0)}for(let g of r)y(g);return f(),L.length==1?L[0]:new Z(L,l)}}w.empty=new Q([""],0);function me(D){let r=-1;for(let l of D)r+=l.length+1;return r}function xe(D,r,l=0,c=1e9){for(let m=0,S=0,k=!0;S<D.length&&m<=c;S++){let L=D[S],V=m+L.length;V>=l&&(V>c&&(L=L.slice(0,c-m)),m<l&&(L=L.slice(l-m)),k?(r[r.length-1]+=L,k=!1):r.push(L)),m=V+1}return r}function Xe(D,r,l){return xe(D,[""],r,l)}class Ze{constructor(r,l=1){this.dir=l,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[r],this.offsets=[l>0?1:(r instanceof Q?r.text.length:r.children.length)<<1]}nextInner(r,l){for(this.done=this.lineBreak=!1;;){let c=this.nodes.length-1,m=this.nodes[c],S=this.offsets[c],k=S>>1,L=m instanceof Q?m.text.length:m.children.length;if(k==(l>0?L:0)){if(c==0)return this.done=!0,this.value="",this;l>0&&this.offsets[c-1]++,this.nodes.pop(),this.offsets.pop()}else if((S&1)==(l>0?0:1)){if(this.offsets[c]+=l,r==0)return this.lineBreak=!0,this.value=`
`,this;r--}else if(m instanceof Q){let V=m.text[k+(l<0?-1:0)];if(this.offsets[c]+=l,V.length>Math.max(0,r))return this.value=r==0?V:l>0?V.slice(r):V.slice(0,V.length-r),this;r-=V.length}else{let V=m.children[k+(l<0?-1:0)];r>V.length?(r-=V.length,this.offsets[c]+=l):(l<0&&this.offsets[c]--,this.nodes.push(V),this.offsets.push(l>0?1:(V instanceof Q?V.text.length:V.children.length)<<1))}}}next(r=0){return r<0&&(this.nextInner(-r,-this.dir),r=this.value.length),this.nextInner(r,this.dir)}}class Mt{constructor(r,l,c){this.value="",this.done=!1,this.cursor=new Ze(r,l>c?-1:1),this.pos=l>c?r.length:0,this.from=Math.min(l,c),this.to=Math.max(l,c)}nextInner(r,l){if(l<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;r+=Math.max(0,l<0?this.pos-this.to:this.from-this.pos);let c=l<0?this.pos-this.from:this.to-this.pos;r>c&&(r=c),c-=r;let{value:m}=this.cursor.next(r);return this.pos+=(m.length+r)*l,this.value=m.length<=c?m:l<0?m.slice(m.length-c):m.slice(0,c),this.done=!this.value,this}next(r=0){return r<0?r=Math.max(r,this.from-this.pos):r>0&&(r=Math.min(r,this.to-this.pos)),this.nextInner(r,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class Rt{constructor(r){this.inner=r,this.afterBreak=!0,this.value="",this.done=!1}next(r=0){let{done:l,lineBreak:c,value:m}=this.inner.next(r);return l?(this.done=!0,this.value=""):c?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=m,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol!="undefined"&&(w.prototype[Symbol.iterator]=function(){return this.iter()},Ze.prototype[Symbol.iterator]=Mt.prototype[Symbol.iterator]=Rt.prototype[Symbol.iterator]=function(){return this});class He{constructor(r,l,c,m){this.from=r,this.to=l,this.number=c,this.text=m}get length(){return this.to-this.from}}let tt="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(D=>D?parseInt(D,36):1);for(let D=1;D<tt.length;D++)tt[D]+=tt[D-1];function Dt(D){for(let r=1;r<tt.length;r+=2)if(tt[r]>D)return tt[r-1]<=D;return!1}function Ee(D){return D>=127462&&D<=127487}const It=8205;function dt(D,r,l=!0,c=!0){return(l?Gt:ii)(D,r,c)}function Gt(D,r,l){if(r==D.length)return r;r&&ni(D.charCodeAt(r))&&_e(D.charCodeAt(r-1))&&r--;let c=bt(D,r);for(r+=ft(c);r<D.length;){let m=bt(D,r);if(c==It||m==It||l&&Dt(m))r+=ft(m),c=m;else if(Ee(m)){let S=0,k=r-2;for(;k>=0&&Ee(bt(D,k));)S++,k-=2;if(S%2==0)break;r+=2}else break}return r}function ii(D,r,l){for(;r>0;){let c=Gt(D,r-2,l);if(c<r)return c;r--}return 0}function ni(D){return D>=56320&&D<57344}function _e(D){return D>=55296&&D<56320}function bt(D,r){let l=D.charCodeAt(r);if(!_e(l)||r+1==D.length)return l;let c=D.charCodeAt(r+1);return ni(c)?(l-55296<<10)+(c-56320)+65536:l}function ri(D){return D<=65535?String.fromCharCode(D):(D-=65536,String.fromCharCode((D>>10)+55296,(D&1023)+56320))}function ft(D){return D<65536?1:2}const at=/\r\n?|\n/;var Ot=function(D){return D[D.Simple=0]="Simple",D[D.TrackDel=1]="TrackDel",D[D.TrackBefore=2]="TrackBefore",D[D.TrackAfter=3]="TrackAfter",D}(Ot||(Ot={}));class At{constructor(r){this.sections=r}get length(){let r=0;for(let l=0;l<this.sections.length;l+=2)r+=this.sections[l];return r}get newLength(){let r=0;for(let l=0;l<this.sections.length;l+=2){let c=this.sections[l+1];r+=c<0?this.sections[l]:c}return r}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(r){for(let l=0,c=0,m=0;l<this.sections.length;){let S=this.sections[l++],k=this.sections[l++];k<0?(r(c,m,S),m+=S):m+=k,c+=S}}iterChangedRanges(r,l=!1){Ne(this,r,l)}get invertedDesc(){let r=[];for(let l=0;l<this.sections.length;){let c=this.sections[l++],m=this.sections[l++];m<0?r.push(c,m):r.push(m,c)}return new At(r)}composeDesc(r){return this.empty?r:r.empty?this:pt(this,r)}mapDesc(r,l=!1){return r.empty?this:Pt(this,r,l)}mapPos(r,l=-1,c=Ot.Simple){let m=0,S=0;for(let k=0;k<this.sections.length;){let L=this.sections[k++],V=this.sections[k++],te=m+L;if(V<0){if(te>r)return S+(r-m);S+=L}else{if(c!=Ot.Simple&&te>=r&&(c==Ot.TrackDel&&m<r&&te>r||c==Ot.TrackBefore&&m<r||c==Ot.TrackAfter&&te>r))return null;if(te>r||te==r&&l<0&&!L)return r==m||l<0?S:S+V;S+=V}m=te}if(r>m)throw new RangeError(`Position ${r} is out of range for changeset of length ${m}`);return S}touchesRange(r,l=r){for(let c=0,m=0;c<this.sections.length&&m<=l;){let S=this.sections[c++],k=this.sections[c++],L=m+S;if(k>=0&&m<=l&&L>=r)return m<r&&L>l?"cover":!0;m=L}return!1}toString(){let r="";for(let l=0;l<this.sections.length;){let c=this.sections[l++],m=this.sections[l++];r+=(r?" ":"")+c+(m>=0?":"+m:"")}return r}toJSON(){return this.sections}static fromJSON(r){if(!Array.isArray(r)||r.length%2||r.some(l=>typeof l!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new At(r)}static create(r){return new At(r)}}class Je extends At{constructor(r,l){super(r),this.inserted=l}apply(r){if(this.length!=r.length)throw new RangeError("Applying change set to a document with the wrong length");return Ne(this,(l,c,m,S,k)=>r=r.replace(m,m+(c-l),k),!1),r}mapDesc(r,l=!1){return Pt(this,r,l,!0)}invert(r){let l=this.sections.slice(),c=[];for(let m=0,S=0;m<l.length;m+=2){let k=l[m],L=l[m+1];if(L>=0){l[m]=L,l[m+1]=k;let V=m>>1;for(;c.length<V;)c.push(w.empty);c.push(k?r.slice(S,S+k):w.empty)}S+=k}return new Je(l,c)}compose(r){return this.empty?r:r.empty?this:pt(this,r,!0)}map(r,l=!1){return r.empty?this:Pt(this,r,l,!0)}iterChanges(r,l=!1){Ne(this,r,l)}get desc(){return At.create(this.sections)}filter(r){let l=[],c=[],m=[],S=new Nt(this);e:for(let k=0,L=0;;){let V=k==r.length?1e9:r[k++];for(;L<V||L==V&&S.len==0;){if(S.done)break e;let he=Math.min(S.len,V-L);We(m,he,-1);let y=S.ins==-1?-1:S.off==0?S.ins:0;We(l,he,y),y>0&&nt(c,l,S.text),S.forward(he),L+=he}let te=r[k++];for(;L<te;){if(S.done)break e;let he=Math.min(S.len,te-L);We(l,he,-1),We(m,he,S.ins==-1?-1:S.off==0?S.ins:0),S.forward(he),L+=he}}return{changes:new Je(l,c),filtered:At.create(m)}}toJSON(){let r=[];for(let l=0;l<this.sections.length;l+=2){let c=this.sections[l],m=this.sections[l+1];m<0?r.push(c):m==0?r.push([c]):r.push([c].concat(this.inserted[l>>1].toJSON()))}return r}static of(r,l,c){let m=[],S=[],k=0,L=null;function V(he=!1){if(!he&&!m.length)return;k<l&&We(m,l-k,-1);let y=new Je(m,S);L=L?L.compose(y.map(L)):y,m=[],S=[],k=0}function te(he){if(Array.isArray(he))for(let y of he)te(y);else if(he instanceof Je){if(he.length!=l)throw new RangeError(`Mismatched change set length (got ${he.length}, expected ${l})`);V(),L=L?L.compose(he.map(L)):he}else{let{from:y,to:f=y,insert:g}=he;if(y>f||y<0||f>l)throw new RangeError(`Invalid change range ${y} to ${f} (in doc of length ${l})`);let T=g?typeof g=="string"?w.of(g.split(c||at)):g:w.empty,B=T.length;if(y==f&&B==0)return;y<k&&V(),y>k&&We(m,y-k,-1),We(m,f-y,B),nt(S,m,T),k=f}}return te(r),V(!L),L}static empty(r){return new Je(r?[r,-1]:[],[])}static fromJSON(r){if(!Array.isArray(r))throw new RangeError("Invalid JSON representation of ChangeSet");let l=[],c=[];for(let m=0;m<r.length;m++){let S=r[m];if(typeof S=="number")l.push(S,-1);else{if(!Array.isArray(S)||typeof S[0]!="number"||S.some((k,L)=>L&&typeof k!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(S.length==1)l.push(S[0],0);else{for(;c.length<m;)c.push(w.empty);c[m]=w.of(S.slice(1)),l.push(S[0],c[m].length)}}}return new Je(l,c)}static createSet(r,l){return new Je(r,l)}}function We(D,r,l,c=!1){if(r==0&&l<=0)return;let m=D.length-2;m>=0&&l<=0&&l==D[m+1]?D[m]+=r:r==0&&D[m]==0?D[m+1]+=l:c?(D[m]+=r,D[m+1]+=l):D.push(r,l)}function nt(D,r,l){if(l.length==0)return;let c=r.length-2>>1;if(c<D.length)D[D.length-1]=D[D.length-1].append(l);else{for(;D.length<c;)D.push(w.empty);D.push(l)}}function Ne(D,r,l){let c=D.inserted;for(let m=0,S=0,k=0;k<D.sections.length;){let L=D.sections[k++],V=D.sections[k++];if(V<0)m+=L,S+=L;else{let te=m,he=S,y=w.empty;for(;te+=L,he+=V,V&&c&&(y=y.append(c[k-2>>1])),!(l||k==D.sections.length||D.sections[k+1]<0);)L=D.sections[k++],V=D.sections[k++];r(m,te,S,he,y),m=te,S=he}}}function Pt(D,r,l,c=!1){let m=[],S=c?[]:null,k=new Nt(D),L=new Nt(r);for(let V=-1;;)if(k.ins==-1&&L.ins==-1){let te=Math.min(k.len,L.len);We(m,te,-1),k.forward(te),L.forward(te)}else if(L.ins>=0&&(k.ins<0||V==k.i||k.off==0&&(L.len<k.len||L.len==k.len&&!l))){let te=L.len;for(We(m,L.ins,-1);te;){let he=Math.min(k.len,te);k.ins>=0&&V<k.i&&k.len<=he&&(We(m,0,k.ins),S&&nt(S,m,k.text),V=k.i),k.forward(he),te-=he}L.next()}else if(k.ins>=0){let te=0,he=k.len;for(;he;)if(L.ins==-1){let y=Math.min(he,L.len);te+=y,he-=y,L.forward(y)}else if(L.ins==0&&L.len<he)he-=L.len,L.next();else break;We(m,te,V<k.i?k.ins:0),S&&V<k.i&&nt(S,m,k.text),V=k.i,k.forward(k.len-he)}else{if(k.done&&L.done)return S?Je.createSet(m,S):At.create(m);throw new Error("Mismatched change set lengths")}}function pt(D,r,l=!1){let c=[],m=l?[]:null,S=new Nt(D),k=new Nt(r);for(let L=!1;;){if(S.done&&k.done)return m?Je.createSet(c,m):At.create(c);if(S.ins==0)We(c,S.len,0,L),S.next();else if(k.len==0&&!k.done)We(c,0,k.ins,L),m&&nt(m,c,k.text),k.next();else{if(S.done||k.done)throw new Error("Mismatched change set lengths");{let V=Math.min(S.len2,k.len),te=c.length;if(S.ins==-1){let he=k.ins==-1?-1:k.off?0:k.ins;We(c,V,he,L),m&&he&&nt(m,c,k.text)}else k.ins==-1?(We(c,S.off?0:S.len,V,L),m&&nt(m,c,S.textBit(V))):(We(c,S.off?0:S.len,k.off?0:k.ins,L),m&&!k.off&&nt(m,c,k.text));L=(S.ins>V||k.ins>=0&&k.len>V)&&(L||c.length>te),S.forward2(V),k.forward(V)}}}}class Nt{constructor(r){this.set=r,this.i=0,this.next()}next(){let{sections:r}=this.set;this.i<r.length?(this.len=r[this.i++],this.ins=r[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:r}=this.set,l=this.i-2>>1;return l>=r.length?w.empty:r[l]}textBit(r){let{inserted:l}=this.set,c=this.i-2>>1;return c>=l.length&&!r?w.empty:l[c].slice(this.off,r==null?void 0:this.off+r)}forward(r){r==this.len?this.next():(this.len-=r,this.off+=r)}forward2(r){this.ins==-1?this.forward(r):r==this.ins?this.next():(this.ins-=r,this.off+=r)}}class Wt{constructor(r,l,c){this.from=r,this.to=l,this.flags=c}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let r=this.flags&3;return r==3?null:r}get goalColumn(){let r=this.flags>>5;return r==33554431?void 0:r}map(r,l=-1){let c,m;return this.empty?c=m=r.mapPos(this.from,l):(c=r.mapPos(this.from,1),m=r.mapPos(this.to,-1)),c==this.from&&m==this.to?this:new Wt(c,m,this.flags)}extend(r,l=r){if(r<=this.anchor&&l>=this.anchor)return Be.range(r,l);let c=Math.abs(r-this.anchor)>Math.abs(l-this.anchor)?r:l;return Be.range(this.anchor,c)}eq(r){return this.anchor==r.anchor&&this.head==r.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(r){if(!r||typeof r.anchor!="number"||typeof r.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return Be.range(r.anchor,r.head)}static create(r,l,c){return new Wt(r,l,c)}}class Be{constructor(r,l){this.ranges=r,this.mainIndex=l}map(r,l=-1){return r.empty?this:Be.create(this.ranges.map(c=>c.map(r,l)),this.mainIndex)}eq(r){if(this.ranges.length!=r.ranges.length||this.mainIndex!=r.mainIndex)return!1;for(let l=0;l<this.ranges.length;l++)if(!this.ranges[l].eq(r.ranges[l]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new Be([this.main],0)}addRange(r,l=!0){return Be.create([r].concat(this.ranges),l?0:this.mainIndex+1)}replaceRange(r,l=this.mainIndex){let c=this.ranges.slice();return c[l]=r,Be.create(c,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(r=>r.toJSON()),main:this.mainIndex}}static fromJSON(r){if(!r||!Array.isArray(r.ranges)||typeof r.main!="number"||r.main>=r.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new Be(r.ranges.map(l=>Wt.fromJSON(l)),r.main)}static single(r,l=r){return new Be([Be.range(r,l)],0)}static create(r,l=0){if(r.length==0)throw new RangeError("A selection needs at least one range");for(let c=0,m=0;m<r.length;m++){let S=r[m];if(S.empty?S.from<=c:S.from<c)return Be.normalized(r.slice(),l);c=S.to}return new Be(r,l)}static cursor(r,l=0,c,m){return Wt.create(r,r,(l==0?0:l<0?4:8)|(c==null?3:Math.min(2,c))|(m!=null?m:33554431)<<5)}static range(r,l,c,m){let S=(c!=null?c:33554431)<<5|(m==null?3:Math.min(2,m));return l<r?Wt.create(l,r,24|S):Wt.create(r,l,(l>r?4:0)|S)}static normalized(r,l=0){let c=r[l];r.sort((m,S)=>m.from-S.from),l=r.indexOf(c);for(let m=1;m<r.length;m++){let S=r[m],k=r[m-1];if(S.empty?S.from<=k.to:S.from<k.to){let L=k.from,V=Math.max(S.to,k.to);m<=l&&l--,r.splice(--m,2,S.anchor>S.head?Be.range(V,L):Be.range(L,V))}}return new Be(r,l)}}function Ge(D,r){for(let l of D.ranges)if(l.to>r)throw new RangeError("Selection points outside of document")}let Ye=0;class ht{constructor(r,l,c,m,S){this.combine=r,this.compareInput=l,this.compare=c,this.isStatic=m,this.id=Ye++,this.default=r([]),this.extensions=typeof S=="function"?S(this):S}static define(r={}){return new ht(r.combine||(l=>l),r.compareInput||((l,c)=>l===c),r.compare||(r.combine?(l,c)=>l===c:Tt),!!r.static,r.enables)}of(r){return new wt([],this,0,r)}compute(r,l){if(this.isStatic)throw new Error("Can't compute a static facet");return new wt(r,this,1,l)}computeN(r,l){if(this.isStatic)throw new Error("Can't compute a static facet");return new wt(r,this,2,l)}from(r,l){return l||(l=c=>c),this.compute([r],c=>l(c.field(r)))}}function Tt(D,r){return D==r||D.length==r.length&&D.every((l,c)=>l===r[c])}class wt{constructor(r,l,c,m){this.dependencies=r,this.facet=l,this.type=c,this.value=m,this.id=Ye++}dynamicSlot(r){var l;let c=this.value,m=this.facet.compareInput,S=this.id,k=r[S]>>1,L=this.type==2,V=!1,te=!1,he=[];for(let y of this.dependencies)y=="doc"?V=!0:y=="selection"?te=!0:((l=r[y.id])!==null&&l!==void 0?l:1)&1||he.push(r[y.id]);return{create(y){return y.values[k]=c(y),1},update(y,f){if(V&&f.docChanged||te&&(f.docChanged||f.selection)||st(y,he)){let g=c(y);if(L?!Bt(g,y.values[k],m):!m(g,y.values[k]))return y.values[k]=g,1}return 0},reconfigure:(y,f)=>{let g,T=f.config.address[S];if(T!=null){let B=Fe(f,T);if(this.dependencies.every(F=>F instanceof ht?f.facet(F)===y.facet(F):F instanceof _t?f.field(F,!1)==y.field(F,!1):!0)||(L?Bt(g=c(y),B,m):m(g=c(y),B)))return y.values[k]=B,0}else g=c(y);return y.values[k]=g,1}}}}function Bt(D,r,l){if(D.length!=r.length)return!1;for(let c=0;c<D.length;c++)if(!l(D[c],r[c]))return!1;return!0}function st(D,r){let l=!1;for(let c of r)Oe(D,c)&1&&(l=!0);return l}function rt(D,r,l){let c=l.map(V=>D[V.id]),m=l.map(V=>V.type),S=c.filter(V=>!(V&1)),k=D[r.id]>>1;function L(V){let te=[];for(let he=0;he<c.length;he++){let y=Fe(V,c[he]);if(m[he]==2)for(let f of y)te.push(f);else te.push(y)}return r.combine(te)}return{create(V){for(let te of c)Oe(V,te);return V.values[k]=L(V),1},update(V,te){if(!st(V,S))return 0;let he=L(V);return r.compare(he,V.values[k])?0:(V.values[k]=he,1)},reconfigure(V,te){let he=st(V,c),y=te.config.facets[r.id],f=te.facet(r);if(y&&!he&&Tt(l,y))return V.values[k]=f,0;let g=L(V);return r.compare(g,f)?(V.values[k]=f,0):(V.values[k]=g,1)}}}const xt=ht.define({static:!0});class _t{constructor(r,l,c,m,S){this.id=r,this.createF=l,this.updateF=c,this.compareF=m,this.spec=S,this.provides=void 0}static define(r){let l=new _t(Ye++,r.create,r.update,r.compare||((c,m)=>c===m),r);return r.provide&&(l.provides=r.provide(l)),l}create(r){let l=r.facet(xt).find(c=>c.field==this);return((l==null?void 0:l.create)||this.createF)(r)}slot(r){let l=r[this.id]>>1;return{create:c=>(c.values[l]=this.create(c),1),update:(c,m)=>{let S=c.values[l],k=this.updateF(S,m);return this.compareF(S,k)?0:(c.values[l]=k,1)},reconfigure:(c,m)=>m.config.address[this.id]!=null?(c.values[l]=m.field(this),0):(c.values[l]=this.create(c),1)}}init(r){return[this,xt.of({field:this,create:r})]}get extension(){return this}}const pe={lowest:4,low:3,default:2,high:1,highest:0};function ee(D){return r=>new ne(r,D)}const q={highest:ee(pe.highest),high:ee(pe.high),default:ee(pe.default),low:ee(pe.low),lowest:ee(pe.lowest)};class ne{constructor(r,l){this.inner=r,this.prec=l}}class re{of(r){return new fe(this,r)}reconfigure(r){return re.reconfigure.of({compartment:this,extension:r})}get(r){return r.config.compartments.get(this)}}class fe{constructor(r,l){this.compartment=r,this.inner=l}}class ve{constructor(r,l,c,m,S,k){for(this.base=r,this.compartments=l,this.dynamicSlots=c,this.address=m,this.staticValues=S,this.facets=k,this.statusTemplate=[];this.statusTemplate.length<c.length;)this.statusTemplate.push(0)}staticFacet(r){let l=this.address[r.id];return l==null?r.default:this.staticValues[l>>1]}static resolve(r,l,c){let m=[],S=Object.create(null),k=new Map;for(let f of Ae(r,l,k))f instanceof _t?m.push(f):(S[f.facet.id]||(S[f.facet.id]=[])).push(f);let L=Object.create(null),V=[],te=[];for(let f of m)L[f.id]=te.length<<1,te.push(g=>f.slot(g));let he=c==null?void 0:c.config.facets;for(let f in S){let g=S[f],T=g[0].facet,B=he&&he[f]||[];if(g.every(F=>F.type==0))if(L[T.id]=V.length<<1|1,Tt(B,g))V.push(c.facet(T));else{let F=T.combine(g.map(U=>U.value));V.push(c&&T.compare(F,c.facet(T))?c.facet(T):F)}else{for(let F of g)F.type==0?(L[F.id]=V.length<<1|1,V.push(F.value)):(L[F.id]=te.length<<1,te.push(U=>F.dynamicSlot(U)));L[T.id]=te.length<<1,te.push(F=>rt(F,T,g))}}let y=te.map(f=>f(L));return new ve(r,k,y,L,V,S)}}function Ae(D,r,l){let c=[[],[],[],[],[]],m=new Map;function S(k,L){let V=m.get(k);if(V!=null){if(V<=L)return;let te=c[V].indexOf(k);te>-1&&c[V].splice(te,1),k instanceof fe&&l.delete(k.compartment)}if(m.set(k,L),Array.isArray(k))for(let te of k)S(te,L);else if(k instanceof fe){if(l.has(k.compartment))throw new RangeError("Duplicate use of compartment in extensions");let te=r.get(k.compartment)||k.inner;l.set(k.compartment,te),S(te,L)}else if(k instanceof ne)S(k.inner,k.prec);else if(k instanceof _t)c[L].push(k),k.provides&&S(k.provides,L);else if(k instanceof wt)c[L].push(k),k.facet.extensions&&S(k.facet.extensions,pe.default);else{let te=k.extension;if(!te)throw new Error(`Unrecognized extension value in extension set (${k}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);S(te,L)}}return S(D,pe.default),c.reduce((k,L)=>k.concat(L))}function Oe(D,r){if(r&1)return 2;let l=r>>1,c=D.status[l];if(c==4)throw new Error("Cyclic dependency between fields and/or facets");if(c&2)return c;D.status[l]=4;let m=D.computeSlot(D,D.config.dynamicSlots[l]);return D.status[l]=2|m}function Fe(D,r){return r&1?D.config.staticValues[r>>1]:D.values[r>>1]}const Re=ht.define(),qe=ht.define({combine:D=>D.some(r=>r),static:!0}),Et=ht.define({combine:D=>D.length?D[0]:void 0,static:!0}),Lt=ht.define(),vt=ht.define(),Ft=ht.define(),kt=ht.define({combine:D=>D.length?D[0]:!1});class qt{constructor(r,l){this.type=r,this.value=l}static define(){return new $t}}class $t{of(r){return new qt(this,r)}}class Ke{constructor(r){this.map=r}of(r){return new ke(this,r)}}class ke{constructor(r,l){this.type=r,this.value=l}map(r){let l=this.type.map(this.value,r);return l===void 0?void 0:l==this.value?this:new ke(this.type,l)}is(r){return this.type==r}static define(r={}){return new Ke(r.map||(l=>l))}static mapEffects(r,l){if(!r.length)return r;let c=[];for(let m of r){let S=m.map(l);S&&c.push(S)}return c}}ke.reconfigure=ke.define(),ke.appendConfig=ke.define();class it{constructor(r,l,c,m,S,k){this.startState=r,this.changes=l,this.selection=c,this.effects=m,this.annotations=S,this.scrollIntoView=k,this._doc=null,this._state=null,c&&Ge(c,l.newLength),S.some(L=>L.type==it.time)||(this.annotations=S.concat(it.time.of(Date.now())))}static create(r,l,c,m,S,k){return new it(r,l,c,m,S,k)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(r){for(let l of this.annotations)if(l.type==r)return l.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(r){let l=this.annotation(it.userEvent);return!!(l&&(l==r||l.length>r.length&&l.slice(0,r.length)==r&&l[r.length]=="."))}}it.time=qt.define(),it.userEvent=qt.define(),it.addToHistory=qt.define(),it.remote=qt.define();function ci(D,r){let l=[];for(let c=0,m=0;;){let S,k;if(c<D.length&&(m==r.length||r[m]>=D[c]))S=D[c++],k=D[c++];else if(m<r.length)S=r[m++],k=r[m++];else return l;!l.length||l[l.length-1]<S?l.push(S,k):l[l.length-1]<k&&(l[l.length-1]=k)}}function Vt(D,r,l){var c;let m,S,k;return l?(m=r.changes,S=Je.empty(r.changes.length),k=D.changes.compose(r.changes)):(m=r.changes.map(D.changes),S=D.changes.mapDesc(r.changes,!0),k=D.changes.compose(m)),{changes:k,selection:r.selection?r.selection.map(S):(c=D.selection)===null||c===void 0?void 0:c.map(m),effects:ke.mapEffects(D.effects,m).concat(ke.mapEffects(r.effects,S)),annotations:D.annotations.length?D.annotations.concat(r.annotations):r.annotations,scrollIntoView:D.scrollIntoView||r.scrollIntoView}}function pi(D,r,l){let c=r.selection,m=z(r.annotations);return r.userEvent&&(m=m.concat(it.userEvent.of(r.userEvent))),{changes:r.changes instanceof Je?r.changes:Je.of(r.changes||[],l,D.facet(Et)),selection:c&&(c instanceof Be?c:Be.single(c.anchor,c.head)),effects:z(r.effects),annotations:m,scrollIntoView:!!r.scrollIntoView}}function oi(D,r,l){let c=pi(D,r.length?r[0]:{},D.doc.length);r.length&&r[0].filter===!1&&(l=!1);for(let S=1;S<r.length;S++){r[S].filter===!1&&(l=!1);let k=!!r[S].sequential;c=Vt(c,pi(D,r[S],k?c.changes.newLength:D.doc.length),k)}let m=it.create(D,c.changes,c.selection,c.effects,c.annotations,c.scrollIntoView);return A(l?H(m):m)}function H(D){let r=D.startState,l=!0;for(let m of r.facet(Lt)){let S=m(D);if(S===!1){l=!1;break}Array.isArray(S)&&(l=l===!0?S:ci(l,S))}if(l!==!0){let m,S;if(l===!1)S=D.changes.invertedDesc,m=Je.empty(r.doc.length);else{let k=D.changes.filter(l);m=k.changes,S=k.filtered.mapDesc(k.changes).invertedDesc}D=it.create(r,m,D.selection&&D.selection.map(S),ke.mapEffects(D.effects,S),D.annotations,D.scrollIntoView)}let c=r.facet(vt);for(let m=c.length-1;m>=0;m--){let S=c[m](D);S instanceof it?D=S:Array.isArray(S)&&S.length==1&&S[0]instanceof it?D=S[0]:D=oi(r,z(S),!1)}return D}function A(D){let r=D.startState,l=r.facet(Ft),c=D;for(let m=l.length-1;m>=0;m--){let S=l[m](D);S&&Object.keys(S).length&&(c=Vt(c,pi(r,S,D.changes.newLength),!0))}return c==D?D:it.create(r,D.changes,D.selection,c.effects,c.annotations,c.scrollIntoView)}const W=[];function z(D){return D==null?W:Array.isArray(D)?D:[D]}var _=function(D){return D[D.Word=0]="Word",D[D.Space=1]="Space",D[D.Other=2]="Other",D}(_||(_={}));const se=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let ye;try{ye=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function we(D){if(ye)return ye.test(D);for(let r=0;r<D.length;r++){let l=D[r];if(/\w/.test(l)||l>"\x80"&&(l.toUpperCase()!=l.toLowerCase()||se.test(l)))return!0}return!1}function Me(D){return r=>{if(!/\S/.test(r))return _.Space;if(we(r))return _.Word;for(let l=0;l<D.length;l++)if(r.indexOf(D[l])>-1)return _.Word;return _.Other}}class De{constructor(r,l,c,m,S,k){this.config=r,this.doc=l,this.selection=c,this.values=m,this.status=r.statusTemplate.slice(),this.computeSlot=S,k&&(k._state=this);for(let L=0;L<this.config.dynamicSlots.length;L++)Oe(this,L<<1);this.computeSlot=null}field(r,l=!0){let c=this.config.address[r.id];if(c==null){if(l)throw new RangeError("Field is not present in this state");return}return Oe(this,c),Fe(this,c)}update(...r){return oi(this,r,!0)}applyTransaction(r){let l=this.config,{base:c,compartments:m}=l;for(let k of r.effects)k.is(re.reconfigure)?(l&&(m=new Map,l.compartments.forEach((L,V)=>m.set(V,L)),l=null),m.set(k.value.compartment,k.value.extension)):k.is(ke.reconfigure)?(l=null,c=k.value):k.is(ke.appendConfig)&&(l=null,c=z(c).concat(k.value));let S;l?S=r.startState.values.slice():(l=ve.resolve(c,m,this),S=new De(l,this.doc,this.selection,l.dynamicSlots.map(()=>null),(L,V)=>V.reconfigure(L,this),null).values),new De(l,r.newDoc,r.newSelection,S,(k,L)=>L.update(k,r),r)}replaceSelection(r){return typeof r=="string"&&(r=this.toText(r)),this.changeByRange(l=>({changes:{from:l.from,to:l.to,insert:r},range:Be.cursor(l.from+r.length)}))}changeByRange(r){let l=this.selection,c=r(l.ranges[0]),m=this.changes(c.changes),S=[c.range],k=z(c.effects);for(let L=1;L<l.ranges.length;L++){let V=r(l.ranges[L]),te=this.changes(V.changes),he=te.map(m);for(let f=0;f<L;f++)S[f]=S[f].map(he);let y=m.mapDesc(te,!0);S.push(V.range.map(y)),m=m.compose(he),k=ke.mapEffects(k,he).concat(ke.mapEffects(z(V.effects),y))}return{changes:m,selection:Be.create(S,l.mainIndex),effects:k}}changes(r=[]){return r instanceof Je?r:Je.of(r,this.doc.length,this.facet(De.lineSeparator))}toText(r){return w.of(r.split(this.facet(De.lineSeparator)||at))}sliceDoc(r=0,l=this.doc.length){return this.doc.sliceString(r,l,this.lineBreak)}facet(r){let l=this.config.address[r.id];return l==null?r.default:(Oe(this,l),Fe(this,l))}toJSON(r){let l={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(r)for(let c in r){let m=r[c];m instanceof _t&&this.config.address[m.id]!=null&&(l[c]=m.spec.toJSON(this.field(r[c]),this))}return l}static fromJSON(r,l={},c){if(!r||typeof r.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let m=[];if(c){for(let S in c)if(Object.prototype.hasOwnProperty.call(r,S)){let k=c[S],L=r[S];m.push(k.init(V=>k.spec.fromJSON(L,V)))}}return De.create({doc:r.doc,selection:Be.fromJSON(r.selection),extensions:l.extensions?m.concat([l.extensions]):m})}static create(r={}){let l=ve.resolve(r.extensions||[],new Map),c=r.doc instanceof w?r.doc:w.of((r.doc||"").split(l.staticFacet(De.lineSeparator)||at)),m=r.selection?r.selection instanceof Be?r.selection:Be.single(r.selection.anchor,r.selection.head):Be.single(0);return Ge(m,c.length),l.staticFacet(qe)||(m=m.asSingle()),new De(l,c,m,l.dynamicSlots.map(()=>null),(S,k)=>k.create(S),null)}get tabSize(){return this.facet(De.tabSize)}get lineBreak(){return this.facet(De.lineSeparator)||`
`}get readOnly(){return this.facet(kt)}phrase(r,...l){for(let c of this.facet(De.phrases))if(Object.prototype.hasOwnProperty.call(c,r)){r=c[r];break}return l.length&&(r=r.replace(/\$(\$|\d*)/g,(c,m)=>{if(m=="$")return"$";let S=+(m||1);return!S||S>l.length?c:l[S-1]})),r}languageDataAt(r,l,c=-1){let m=[];for(let S of this.facet(Re))for(let k of S(this,l,c))Object.prototype.hasOwnProperty.call(k,r)&&m.push(k[r]);return m}charCategorizer(r){return Me(this.languageDataAt("wordChars",r).join(""))}wordAt(r){let{text:l,from:c,length:m}=this.doc.lineAt(r),S=this.charCategorizer(r),k=r-c,L=r-c;for(;k>0;){let V=dt(l,k,!1);if(S(l.slice(V,k))!=_.Word)break;k=V}for(;L<m;){let V=dt(l,L);if(S(l.slice(L,V))!=_.Word)break;L=V}return k==L?null:Be.range(k+c,L+c)}}De.allowMultipleSelections=qe,De.tabSize=ht.define({combine:D=>D.length?D[0]:4}),De.lineSeparator=Et,De.readOnly=kt,De.phrases=ht.define({compare(D,r){let l=Object.keys(D),c=Object.keys(r);return l.length==c.length&&l.every(m=>D[m]==r[m])}}),De.languageData=Re,De.changeFilter=Lt,De.transactionFilter=vt,De.transactionExtender=Ft,re.reconfigure=ke.define();function ot(D,r,l={}){let c={};for(let m of D)for(let S of Object.keys(m)){let k=m[S],L=c[S];if(L===void 0)c[S]=k;else if(!(L===k||k===void 0))if(Object.hasOwnProperty.call(l,S))c[S]=l[S](L,k);else throw new Error("Config merge conflict for field "+S)}for(let m in r)c[m]===void 0&&(c[m]=r[m]);return c}class ct{eq(r){return this==r}range(r,l=r){return yt.create(r,l,this)}}ct.prototype.startSide=ct.prototype.endSide=0,ct.prototype.point=!1,ct.prototype.mapMode=Ot.TrackDel;class yt{constructor(r,l,c){this.from=r,this.to=l,this.value=c}static create(r,l,c){return new yt(r,l,c)}}function li(D,r){return D.from-r.from||D.value.startSide-r.value.startSide}class Qt{constructor(r,l,c,m){this.from=r,this.to=l,this.value=c,this.maxPoint=m}get length(){return this.to[this.to.length-1]}findIndex(r,l,c,m=0){let S=c?this.to:this.from;for(let k=m,L=S.length;;){if(k==L)return k;let V=k+L>>1,te=S[V]-r||(c?this.value[V].endSide:this.value[V].startSide)-l;if(V==k)return te>=0?k:L;te>=0?L=V:k=V+1}}between(r,l,c,m){for(let S=this.findIndex(l,-1e9,!0),k=this.findIndex(c,1e9,!1,S);S<k;S++)if(m(this.from[S]+r,this.to[S]+r,this.value[S])===!1)return!1}map(r,l){let c=[],m=[],S=[],k=-1,L=-1;for(let V=0;V<this.value.length;V++){let te=this.value[V],he=this.from[V]+r,y=this.to[V]+r,f,g;if(he==y){let T=l.mapPos(he,te.startSide,te.mapMode);if(T==null||(f=g=T,te.startSide!=te.endSide&&(g=l.mapPos(he,te.endSide),g<f)))continue}else if(f=l.mapPos(he,te.startSide),g=l.mapPos(y,te.endSide),f>g||f==g&&te.startSide>0&&te.endSide<=0)continue;(g-f||te.endSide-te.startSide)<0||(k<0&&(k=f),te.point&&(L=Math.max(L,g-f)),c.push(te),m.push(f-k),S.push(g-k))}return{mapped:c.length?new Qt(m,S,c,L):null,pos:k}}}class St{constructor(r,l,c,m){this.chunkPos=r,this.chunk=l,this.nextLayer=c,this.maxPoint=m}static create(r,l,c,m){return new St(r,l,c,m)}get length(){let r=this.chunk.length-1;return r<0?0:Math.max(this.chunkEnd(r),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let r=this.nextLayer.size;for(let l of this.chunk)r+=l.value.length;return r}chunkEnd(r){return this.chunkPos[r]+this.chunk[r].length}update(r){let{add:l=[],sort:c=!1,filterFrom:m=0,filterTo:S=this.length}=r,k=r.filter;if(l.length==0&&!k)return this;if(c&&(l=l.slice().sort(li)),this.isEmpty)return l.length?St.of(l):this;let L=new jt(this,null,-1).goto(0),V=0,te=[],he=new Ht;for(;L.value||V<l.length;)if(V<l.length&&(L.from-l[V].from||L.startSide-l[V].value.startSide)>=0){let y=l[V++];he.addInner(y.from,y.to,y.value)||te.push(y)}else L.rangeIndex==1&&L.chunkIndex<this.chunk.length&&(V==l.length||this.chunkEnd(L.chunkIndex)<l[V].from)&&(!k||m>this.chunkEnd(L.chunkIndex)||S<this.chunkPos[L.chunkIndex])&&he.addChunk(this.chunkPos[L.chunkIndex],this.chunk[L.chunkIndex])?L.nextChunk():((!k||m>L.to||S<L.from||k(L.from,L.to,L.value))&&(he.addInner(L.from,L.to,L.value)||te.push(yt.create(L.from,L.to,L.value))),L.next());return he.finishInner(this.nextLayer.isEmpty&&!te.length?St.empty:this.nextLayer.update({add:te,filter:k,filterFrom:m,filterTo:S}))}map(r){if(r.empty||this.isEmpty)return this;let l=[],c=[],m=-1;for(let k=0;k<this.chunk.length;k++){let L=this.chunkPos[k],V=this.chunk[k],te=r.touchesRange(L,L+V.length);if(te===!1)m=Math.max(m,V.maxPoint),l.push(V),c.push(r.mapPos(L));else if(te===!0){let{mapped:he,pos:y}=V.map(L,r);he&&(m=Math.max(m,he.maxPoint),l.push(he),c.push(y))}}let S=this.nextLayer.map(r);return l.length==0?S:new St(c,l,S||St.empty,m)}between(r,l,c){if(!this.isEmpty){for(let m=0;m<this.chunk.length;m++){let S=this.chunkPos[m],k=this.chunk[m];if(l>=S&&r<=S+k.length&&k.between(S,r-S,l-S,c)===!1)return}this.nextLayer.between(r,l,c)}}iter(r=0){return Xt.from([this]).goto(r)}get isEmpty(){return this.nextLayer==this}static iter(r,l=0){return Xt.from(r).goto(l)}static compare(r,l,c,m,S=-1){let k=r.filter(y=>y.maxPoint>0||!y.isEmpty&&y.maxPoint>=S),L=l.filter(y=>y.maxPoint>0||!y.isEmpty&&y.maxPoint>=S),V=xi(k,L,c),te=new ai(k,V,S),he=new ai(L,V,S);c.iterGaps((y,f,g)=>vi(te,y,he,f,g,m)),c.empty&&c.length==0&&vi(te,0,he,0,0,m)}static eq(r,l,c=0,m){m==null&&(m=1e9-1);let S=r.filter(he=>!he.isEmpty&&l.indexOf(he)<0),k=l.filter(he=>!he.isEmpty&&r.indexOf(he)<0);if(S.length!=k.length)return!1;if(!S.length)return!0;let L=xi(S,k),V=new ai(S,L,0).goto(c),te=new ai(k,L,0).goto(c);for(;;){if(V.to!=te.to||!fi(V.active,te.active)||V.point&&(!te.point||!V.point.eq(te.point)))return!1;if(V.to>m)return!0;V.next(),te.next()}}static spans(r,l,c,m,S=-1){let k=new ai(r,null,S).goto(l),L=l,V=k.openStart;for(;;){let te=Math.min(k.to,c);if(k.point){let he=k.activeForPoint(k.to),y=k.pointFrom<l?he.length+1:Math.min(he.length,V);m.point(L,te,k.point,he,y,k.pointRank),V=Math.min(k.openEnd(te),he.length)}else te>L&&(m.span(L,te,k.active,V),V=k.openEnd(te));if(k.to>c)return V+(k.point&&k.to>c?1:0);L=k.to,k.next()}}static of(r,l=!1){let c=new Ht;for(let m of r instanceof yt?[r]:l?Si(r):r)c.add(m.from,m.to,m.value);return c.finish()}}St.empty=new St([],[],null,-1);function Si(D){if(D.length>1)for(let r=D[0],l=1;l<D.length;l++){let c=D[l];if(li(r,c)>0)return D.slice().sort(li);r=c}return D}St.empty.nextLayer=St.empty;class Ht{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(r){this.chunks.push(new Qt(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,r&&(this.from=[],this.to=[],this.value=[])}add(r,l,c){this.addInner(r,l,c)||(this.nextLayer||(this.nextLayer=new Ht)).add(r,l,c)}addInner(r,l,c){let m=r-this.lastTo||c.startSide-this.last.endSide;if(m<=0&&(r-this.lastFrom||c.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return m<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=r),this.from.push(r-this.chunkStart),this.to.push(l-this.chunkStart),this.last=c,this.lastFrom=r,this.lastTo=l,this.value.push(c),c.point&&(this.maxPoint=Math.max(this.maxPoint,l-r)),!0)}addChunk(r,l){if((r-this.lastTo||l.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,l.maxPoint),this.chunks.push(l),this.chunkPos.push(r);let c=l.value.length-1;return this.last=l.value[c],this.lastFrom=l.from[c]+r,this.lastTo=l.to[c]+r,!0}finish(){return this.finishInner(St.empty)}finishInner(r){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return r;let l=St.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(r):r,this.setMaxPoint);return this.from=null,l}}function xi(D,r,l){let c=new Map;for(let S of D)for(let k=0;k<S.chunk.length;k++)S.chunk[k].maxPoint<=0&&c.set(S.chunk[k],S.chunkPos[k]);let m=new Set;for(let S of r)for(let k=0;k<S.chunk.length;k++){let L=c.get(S.chunk[k]);L!=null&&(l?l.mapPos(L):L)==S.chunkPos[k]&&!(l!=null&&l.touchesRange(L,L+S.chunk[k].length))&&m.add(S.chunk[k])}return m}class jt{constructor(r,l,c,m=0){this.layer=r,this.skip=l,this.minPoint=c,this.rank=m}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(r,l=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(r,l,!1),this}gotoInner(r,l,c){for(;this.chunkIndex<this.layer.chunk.length;){let m=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(m)||this.layer.chunkEnd(this.chunkIndex)<r||m.maxPoint<this.minPoint))break;this.chunkIndex++,c=!1}if(this.chunkIndex<this.layer.chunk.length){let m=this.layer.chunk[this.chunkIndex].findIndex(r-this.layer.chunkPos[this.chunkIndex],l,!0);(!c||this.rangeIndex<m)&&this.setRangeIndex(m)}this.next()}forward(r,l){(this.to-r||this.endSide-l)<0&&this.gotoInner(r,l,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let r=this.layer.chunkPos[this.chunkIndex],l=this.layer.chunk[this.chunkIndex],c=r+l.from[this.rangeIndex];if(this.from=c,this.to=r+l.to[this.rangeIndex],this.value=l.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(r){if(r==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=r}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(r){return this.from-r.from||this.startSide-r.startSide||this.rank-r.rank||this.to-r.to||this.endSide-r.endSide}}class Xt{constructor(r){this.heap=r}static from(r,l=null,c=-1){let m=[];for(let S=0;S<r.length;S++)for(let k=r[S];!k.isEmpty;k=k.nextLayer)k.maxPoint>=c&&m.push(new jt(k,l,c,S));return m.length==1?m[0]:new Xt(m)}get startSide(){return this.value?this.value.startSide:0}goto(r,l=-1e9){for(let c of this.heap)c.goto(r,l);for(let c=this.heap.length>>1;c>=0;c--)mt(this.heap,c);return this.next(),this}forward(r,l){for(let c of this.heap)c.forward(r,l);for(let c=this.heap.length>>1;c>=0;c--)mt(this.heap,c);(this.to-r||this.value.endSide-l)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let r=this.heap[0];this.from=r.from,this.to=r.to,this.value=r.value,this.rank=r.rank,r.value&&r.next(),mt(this.heap,0)}}}function mt(D,r){for(let l=D[r];;){let c=(r<<1)+1;if(c>=D.length)break;let m=D[c];if(c+1<D.length&&m.compare(D[c+1])>=0&&(m=D[c+1],c++),l.compare(m)<0)break;D[c]=l,D[r]=m,r=c}}class ai{constructor(r,l,c){this.minPoint=c,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Xt.from(r,l,c)}goto(r,l=-1e9){return this.cursor.goto(r,l),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=r,this.endSide=l,this.openStart=-1,this.next(),this}forward(r,l){for(;this.minActive>-1&&(this.activeTo[this.minActive]-r||this.active[this.minActive].endSide-l)<0;)this.removeActive(this.minActive);this.cursor.forward(r,l)}removeActive(r){Zt(this.active,r),Zt(this.activeTo,r),Zt(this.activeRank,r),this.minActive=Ai(this.active,this.activeTo)}addActive(r){let l=0,{value:c,to:m,rank:S}=this.cursor;for(;l<this.activeRank.length&&this.activeRank[l]<=S;)l++;yi(this.active,l,c),yi(this.activeTo,l,m),yi(this.activeRank,l,S),r&&yi(r,l,this.cursor.from),this.minActive=Ai(this.active,this.activeTo)}next(){let r=this.to,l=this.point;this.point=null;let c=this.openStart<0?[]:null;for(;;){let m=this.minActive;if(m>-1&&(this.activeTo[m]-this.cursor.from||this.active[m].endSide-this.cursor.startSide)<0){if(this.activeTo[m]>r){this.to=this.activeTo[m],this.endSide=this.active[m].endSide;break}this.removeActive(m),c&&Zt(c,m)}else if(this.cursor.value)if(this.cursor.from>r){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let S=this.cursor.value;if(!S.point)this.addActive(c),this.cursor.next();else if(l&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=S,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=S.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(c){this.openStart=0;for(let m=c.length-1;m>=0&&c[m]<r;m--)this.openStart++}}activeForPoint(r){if(!this.active.length)return this.active;let l=[];for(let c=this.active.length-1;c>=0&&!(this.activeRank[c]<this.pointRank);c--)(this.activeTo[c]>r||this.activeTo[c]==r&&this.active[c].endSide>=this.point.endSide)&&l.push(this.active[c]);return l.reverse()}openEnd(r){let l=0;for(let c=this.activeTo.length-1;c>=0&&this.activeTo[c]>r;c--)l++;return l}}function vi(D,r,l,c,m,S){D.goto(r),l.goto(c);let k=c+m,L=c,V=c-r;for(;;){let te=D.to+V-l.to||D.endSide-l.endSide,he=te<0?D.to+V:l.to,y=Math.min(he,k);if(D.point||l.point?D.point&&l.point&&(D.point==l.point||D.point.eq(l.point))&&fi(D.activeForPoint(D.to+V),l.activeForPoint(l.to))||S.comparePoint(L,y,D.point,l.point):y>L&&!fi(D.active,l.active)&&S.compareRange(L,y,D.active,l.active),he>k)break;L=he,te<=0&&D.next(),te>=0&&l.next()}}function fi(D,r){if(D.length!=r.length)return!1;for(let l=0;l<D.length;l++)if(D[l]!=r[l]&&!D[l].eq(r[l]))return!1;return!0}function Zt(D,r){for(let l=r,c=D.length-1;l<c;l++)D[l]=D[l+1];D.pop()}function yi(D,r,l){for(let c=D.length-1;c>=r;c--)D[c+1]=D[c];D[r]=l}function Ai(D,r){let l=-1,c=1e9;for(let m=0;m<r.length;m++)(r[m]-c||D[m].endSide-D[l].endSide)<0&&(l=m,c=r[m]);return l}function ki(D,r,l=D.length){let c=0;for(let m=0;m<l;)D.charCodeAt(m)==9?(c+=r-c%r,m++):(c++,m=dt(D,m));return c}function Yt(D,r,l,c){for(let m=0,S=0;;){if(S>=r)return m;if(m==D.length)break;S+=D.charCodeAt(m)==9?l-S%l:1,m=dt(D,m)}return c===!0?-1:D.length}},69185:function(Oi,si,Ve){Ve.d(si,{vk:function(){return at}});var w=Ve(95885),Q=Ve(77120),Z=Ve(86253);const me="#e5c07b",xe="#e06c75",Xe="#56b6c2",Ze="#ffffff",Mt="#abb2bf",Rt="#7d8799",He="#61afef",tt="#98c379",Dt="#d19a66",Ee="#c678dd",It="#21252b",dt="#2c313a",Gt="#282c34",ii="#353a42",ni="#3E4451",_e="#528bff",bt={chalky:me,coral:xe,cyan:Xe,invalid:Ze,ivory:Mt,stone:Rt,malibu:He,sage:tt,whiskey:Dt,violet:Ee,darkBackground:It,highlightBackground:dt,background:Gt,tooltipBackground:ii,selection:ni,cursor:_e},ri=w.tk.theme({"&":{color:Mt,backgroundColor:Gt},".cm-content":{caretColor:_e},".cm-cursor, .cm-dropCursor":{borderLeftColor:_e},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:ni},".cm-panels":{backgroundColor:It,color:Mt},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:Gt,color:Rt,border:"none"},".cm-activeLineGutter":{backgroundColor:dt},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:ii},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:ii,borderBottomColor:ii},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:dt,color:Mt}}},{dark:!0}),ft=Q.Qf.define([{tag:Z.pJ.keyword,color:Ee},{tag:[Z.pJ.name,Z.pJ.deleted,Z.pJ.character,Z.pJ.propertyName,Z.pJ.macroName],color:xe},{tag:[Z.pJ.function(Z.pJ.variableName),Z.pJ.labelName],color:He},{tag:[Z.pJ.color,Z.pJ.constant(Z.pJ.name),Z.pJ.standard(Z.pJ.name)],color:Dt},{tag:[Z.pJ.definition(Z.pJ.name),Z.pJ.separator],color:Mt},{tag:[Z.pJ.typeName,Z.pJ.className,Z.pJ.number,Z.pJ.changed,Z.pJ.annotation,Z.pJ.modifier,Z.pJ.self,Z.pJ.namespace],color:me},{tag:[Z.pJ.operator,Z.pJ.operatorKeyword,Z.pJ.url,Z.pJ.escape,Z.pJ.regexp,Z.pJ.link,Z.pJ.special(Z.pJ.string)],color:Xe},{tag:[Z.pJ.meta,Z.pJ.comment],color:Rt},{tag:Z.pJ.strong,fontWeight:"bold"},{tag:Z.pJ.emphasis,fontStyle:"italic"},{tag:Z.pJ.strikethrough,textDecoration:"line-through"},{tag:Z.pJ.link,color:Rt,textDecoration:"underline"},{tag:Z.pJ.heading,fontWeight:"bold",color:xe},{tag:[Z.pJ.atom,Z.pJ.bool,Z.pJ.special(Z.pJ.variableName)],color:Dt},{tag:[Z.pJ.processingInstruction,Z.pJ.string,Z.pJ.inserted],color:tt},{tag:Z.pJ.invalid,color:Ze}]),at=[ri,(0,Q.nF)(ft)]},95885:function(Oi,si,Ve){Ve.d(si,{$1:function(){return ur},$f:function(){return cs},AE:function(){return Tr},Eu:function(){return ho},HQ:function(){return uo},Nm:function(){return r},OO:function(){return Ht},S2:function(){return Jr},SJ:function(){return Ti},Sd:function(){return to},Uw:function(){return br},W$:function(){return Fr},ZO:function(){return Rr},Zs:function(){return zr},bF:function(){return Zr},gB:function(){return Yr},hJ:function(){return Wn},l9:function(){return $t},lg:function(){return mt},mH:function(){return Hn},p:function(){return ke},qr:function(){return Sr},tk:function(){return ut},v5:function(){return no}});var w=Ve(1727),Q=Ve(37207),Z=Ve(16453);function me(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function xe(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function Xe(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Ze(n,e){if(!e.anchorNode)return!1;try{return xe(n,e.anchorNode)}catch{return!1}}function Mt(n){return n.nodeType==3?ft(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function Rt(n,e,t,i){return t?tt(n,e,t,i,-1)||tt(n,e,t,i,1):!1}function He(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function tt(n,e,t,i,s){for(;;){if(n==t&&e==i)return!0;if(e==(s<0?0:Dt(n))){if(n.nodeName=="DIV")return!1;let o=n.parentNode;if(!o||o.nodeType!=1)return!1;e=He(n)+(s<0?0:1),n=o}else if(n.nodeType==1){if(n=n.childNodes[e+(s<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=s<0?Dt(n):0}else return!1}}function Dt(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}const Ee={left:0,right:0,top:0,bottom:0};function It(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function dt(n){return{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function Gt(n,e,t,i,s,o,a,u){let b=n.ownerDocument,x=b.defaultView||window;for(let M=n;M;)if(M.nodeType==1){let I,K=M==b.body;if(K)I=dt(x);else{if(M.scrollHeight<=M.clientHeight&&M.scrollWidth<=M.clientWidth){M=M.assignedSlot||M.parentNode;continue}let ue=M.getBoundingClientRect();I={left:ue.left,right:ue.left+M.clientWidth,top:ue.top,bottom:ue.top+M.clientHeight}}let Y=0,ae=0;if(s=="nearest")e.top<I.top?(ae=-(I.top-e.top+a),t>0&&e.bottom>I.bottom+ae&&(ae=e.bottom-I.bottom+ae+a)):e.bottom>I.bottom&&(ae=e.bottom-I.bottom+a,t<0&&e.top-ae<I.top&&(ae=-(I.top+ae-e.top+a)));else{let ue=e.bottom-e.top,ce=I.bottom-I.top;ae=(s=="center"&&ue<=ce?e.top+ue/2-ce/2:s=="start"||s=="center"&&t<0?e.top-a:e.bottom-ce+a)-I.top}if(i=="nearest"?e.left<I.left?(Y=-(I.left-e.left+o),t>0&&e.right>I.right+Y&&(Y=e.right-I.right+Y+o)):e.right>I.right&&(Y=e.right-I.right+o,t<0&&e.left<I.left+Y&&(Y=-(I.left+Y-e.left+o))):Y=(i=="center"?e.left+(e.right-e.left)/2-(I.right-I.left)/2:i=="start"==u?e.left-o:e.right-(I.right-I.left)+o)-I.left,Y||ae)if(K)x.scrollBy(Y,ae);else{let ue=0,ce=0;if(ae){let ge=M.scrollTop;M.scrollTop+=ae,ce=M.scrollTop-ge}if(Y){let ge=M.scrollLeft;M.scrollLeft+=Y,ue=M.scrollLeft-ge}e={left:e.left-ue,top:e.top-ce,right:e.right-ue,bottom:e.bottom-ce},ue&&Math.abs(ue-Y)<1&&(i="nearest"),ce&&Math.abs(ce-ae)<1&&(s="nearest")}if(K)break;M=M.assignedSlot||M.parentNode}else if(M.nodeType==11)M=M.host;else break}function ii(n){let e=n.ownerDocument;for(let t=n.parentNode;t&&t!=e.body;)if(t.nodeType==1){if(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)return t;t=t.assignedSlot||t.parentNode}else if(t.nodeType==11)t=t.host;else break;return null}class ni{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){this.set(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)}set(e,t,i,s){this.anchorNode=e,this.anchorOffset=t,this.focusNode=i,this.focusOffset=s}}let _e=null;function bt(n){if(n.setActive)return n.setActive();if(_e)return n.focus(_e);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(_e==null?{get preventScroll(){return _e={preventScroll:!0},!0}}:void 0),!_e){_e=!1;for(let t=0;t<e.length;){let i=e[t++],s=e[t++],o=e[t++];i.scrollTop!=s&&(i.scrollTop=s),i.scrollLeft!=o&&(i.scrollLeft=o)}}}let ri;function ft(n,e,t=e){let i=ri||(ri=document.createRange());return i.setEnd(n,t),i.setStart(n,e),i}function at(n,e,t){let i={key:e,code:e,keyCode:t,which:t,cancelable:!0},s=new KeyboardEvent("keydown",i);s.synthetic=!0,n.dispatchEvent(s);let o=new KeyboardEvent("keyup",i);return o.synthetic=!0,n.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function Ot(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function At(n){for(;n.attributes.length;)n.removeAttributeNode(n.attributes[0])}function Je(n,e){let t=e.focusNode,i=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=i)return!1;for(;;)if(i){if(t.nodeType!=1)return!1;let s=t.childNodes[i-1];s.contentEditable=="false"?i--:(t=s,i=Dt(t))}else{if(t==n)return!0;i=He(t),t=t.parentNode}}class We{constructor(e,t,i=!0){this.node=e,this.offset=t,this.precise=i}static before(e,t){return new We(e.parentNode,He(e),t)}static after(e,t){return new We(e.parentNode,He(e)+1,t)}}const nt=[];class Ne{constructor(){this.parent=null,this.dom=null,this.dirty=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let i of this.children){if(i==e)return t;t+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}coordsAt(e,t){return null}sync(e,t){if(this.dirty&2){let i=this.dom,s=null,o;for(let a of this.children){if(a.dirty){if(!a.dom&&(o=s?s.nextSibling:i.firstChild)){let u=Ne.get(o);(!u||!u.parent&&u.canReuseDOM(a))&&a.reuseDOM(o)}a.sync(e,t),a.dirty=0}if(o=s?s.nextSibling:i.firstChild,t&&!t.written&&t.node==i&&o!=a.dom&&(t.written=!0),a.dom.parentNode==i)for(;o&&o!=a.dom;)o=Pt(o);else i.insertBefore(a.dom,o);s=a.dom}for(o=s?s.nextSibling:i.firstChild,o&&t&&t.node==i&&(t.written=!0);o;)o=Pt(o)}else if(this.dirty&1)for(let i of this.children)i.dirty&&(i.sync(e,t),i.dirty=0)}reuseDOM(e){}localPosFromDOM(e,t){let i;if(e==this.dom)i=this.dom.childNodes[t];else{let s=Dt(e)==0?0:t==0?-1:1;for(;;){let o=e.parentNode;if(o==this.dom)break;s==0&&o.firstChild!=o.lastChild&&(e==o.firstChild?s=-1:s=1),e=o}s<0?i=e:i=e.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!Ne.get(i);)i=i.nextSibling;if(!i)return this.length;for(let s=0,o=0;;s++){let a=this.children[s];if(a.dom==i)return o;o+=a.length+a.breakAfter}}domBoundsAround(e,t,i=0){let s=-1,o=-1,a=-1,u=-1;for(let b=0,x=i,M=i;b<this.children.length;b++){let I=this.children[b],K=x+I.length;if(x<e&&K>t)return I.domBoundsAround(e,t,x);if(K>=e&&s==-1&&(s=b,o=x),x>t&&I.dom.parentNode==this.dom){a=b,u=M;break}M=K,x=K+I.breakAfter}return{from:o,to:u<0?i+this.length:u,startDOM:(s?this.children[s-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:a<this.children.length&&a>=0?this.children[a].dom:null}}markDirty(e=!1){this.dirty|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.dirty|=2),t.dirty&1)return;t.dirty|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.dirty&&this.markParentsDirty(!0))}setDOM(e){this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,i=nt){this.markDirty();for(let s=e;s<t;s++){let o=this.children[s];o.parent==this&&o.destroy()}this.children.splice(e,t-e,...i);for(let s=0;s<i.length;s++)i[s].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new pt(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}merge(e,t,i,s,o,a){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor}getSide(){return 0}destroy(){this.parent=null}}Ne.prototype.breakAfter=0;function Pt(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class pt{constructor(e,t,i){this.children=e,this.pos=t,this.i=i,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function Nt(n,e,t,i,s,o,a,u,b){let{children:x}=n,M=x.length?x[e]:null,I=o.length?o[o.length-1]:null,K=I?I.breakAfter:a;if(!(e==i&&M&&!a&&!K&&o.length<2&&M.merge(t,s,o.length?I:null,t==0,u,b))){if(i<x.length){let Y=x[i];Y&&s<Y.length?(e==i&&(Y=Y.split(s),s=0),!K&&I&&Y.merge(0,s,I,!0,0,b)?o[o.length-1]=Y:(s&&Y.merge(0,s,null,!1,0,b),o.push(Y))):Y!=null&&Y.breakAfter&&(I?I.breakAfter=1:a=1),i++}for(M&&(M.breakAfter=a,t>0&&(!a&&o.length&&M.merge(t,M.length,o[0],!1,u,0)?M.breakAfter=o.shift().breakAfter:(t<M.length||M.children.length&&M.children[M.children.length-1].length==0)&&M.merge(t,M.length,null,!1,u,0),e++));e<i&&o.length;)if(x[i-1].become(o[o.length-1]))i--,o.pop(),b=o.length?0:u;else if(x[e].become(o[0]))e++,o.shift(),u=o.length?0:b;else break;!o.length&&e&&i<x.length&&!x[e-1].breakAfter&&x[i].merge(0,0,x[e-1],!1,u,b)&&e--,(e<i||o.length)&&n.replaceChildren(e,i,o)}}function Wt(n,e,t,i,s,o){let a=n.childCursor(),{i:u,off:b}=a.findPos(t,1),{i:x,off:M}=a.findPos(e,-1),I=e-t;for(let K of i)I+=K.length;n.length+=I,Nt(n,x,M,u,b,i,0,s,o)}let Be=typeof navigator!="undefined"?navigator:{userAgent:"",vendor:"",platform:""},Ge=typeof document!="undefined"?document:{documentElement:{style:{}}};const Ye=/Edge\/(\d+)/.exec(Be.userAgent),ht=/MSIE \d/.test(Be.userAgent),Tt=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Be.userAgent),wt=!!(ht||Tt||Ye),Bt=!wt&&/gecko\/(\d+)/i.test(Be.userAgent),st=!wt&&/Chrome\/(\d+)/.exec(Be.userAgent),rt="webkitFontSmoothing"in Ge.documentElement.style,xt=!wt&&/Apple Computer/.test(Be.vendor),_t=xt&&(/Mobile\/\w+/.test(Be.userAgent)||Be.maxTouchPoints>2);var pe={mac:_t||/Mac/.test(Be.platform),windows:/Win/.test(Be.platform),linux:/Linux|X11/.test(Be.platform),ie:wt,ie_version:ht?Ge.documentMode||6:Tt?+Tt[1]:Ye?+Ye[1]:0,gecko:Bt,gecko_version:Bt?+(/Firefox\/(\d+)/.exec(Be.userAgent)||[0,0])[1]:0,chrome:!!st,chrome_version:st?+st[1]:0,ios:_t,android:/Android\b/.test(Be.userAgent),webkit:rt,safari:xt,webkit_version:rt?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:Ge.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const ee=256;class q extends Ne{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,i){return i&&(!(i instanceof q)||this.length-(t-e)+i.length>ee)?!1:(this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new q(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new We(this.dom,e)}domBoundsAround(e,t,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return re(this.dom,e,t)}}class ne extends Ne{constructor(e,t=[],i=0){super(),this.mark=e,this.children=t,this.length=i;for(let s of t)s.setParent(this)}setAttrs(e){if(At(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.dirty|=6)}sync(e,t){this.dom?this.dirty&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,i,s,o,a){return i&&(!(i instanceof ne&&i.mark.eq(this.mark))||e&&o<=0||t<this.length&&a<=0)?!1:(Wt(this,e,t,i?i.children:[],o-1,a-1),this.markDirty(),!0)}split(e){let t=[],i=0,s=-1,o=0;for(let u of this.children){let b=i+u.length;b>e&&t.push(i<e?u.split(e-i):u),s<0&&i>=e&&(s=o),i=b,o++}let a=this.length-e;return this.length=e,s>-1&&(this.children.length=s,this.markDirty()),new ne(this.mark,t,a)}domAtPos(e){return qe(this,e)}coordsAt(e,t){return Lt(this,e,t)}}function re(n,e,t){let i=n.nodeValue.length;e>i&&(e=i);let s=e,o=e,a=0;e==0&&t<0||e==i&&t>=0?pe.chrome||pe.gecko||(e?(s--,a=1):o<i&&(o++,a=-1)):t<0?s--:o<i&&o++;let u=ft(n,s,o).getClientRects();if(!u.length)return Ee;let b=u[(a?a<0:t>=0)?0:u.length-1];return pe.safari&&!a&&b.width==0&&(b=Array.prototype.find.call(u,x=>x.width)||b),a?It(b,a<0):b||null}class fe extends Ne{constructor(e,t,i){super(),this.widget=e,this.length=t,this.side=i,this.prevWidget=null}static create(e,t,i){return new(e.customView||fe)(e,t,i)}split(e){let t=fe.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,t,i,s,o,a){return i&&(!(i instanceof fe)||!this.widget.compare(i.widget)||e>0&&o<=0||t<this.length&&a<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}become(e){return e.length==this.length&&e instanceof fe&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.eq(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return w.xv.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,i=t&&t.state.doc,s=this.posAtStart;return i?i.slice(s,s+this.length):w.xv.empty}domAtPos(e){return e==0?We.before(this.dom):We.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let i=this.dom.getClientRects(),s=null;if(!i.length)return Ee;for(let o=e>0?i.length-1:0;s=i[o],!(e>0?o==0:o==i.length-1||s.top<s.bottom);o+=e>0?-1:1);return this.length?s:It(s,this.side>0)}get isEditable(){return!1}get isWidget(){return!0}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class ve extends fe{domAtPos(e){let{topView:t,text:i}=this.widget;return t?Ae(e,0,t,i,(s,o)=>s.domAtPos(o),s=>new We(i,Math.min(s,i.nodeValue.length))):new We(i,Math.min(e,i.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(e,t){let{topView:i,text:s}=this.widget;return i?Oe(e,t,i,s):Math.min(t,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(e,t){let{topView:i,text:s}=this.widget;return i?Ae(e,t,i,s,(o,a,u)=>o.coordsAt(a,u),(o,a)=>re(s,o,a)):re(s,e,t)}destroy(){var e;super.destroy(),(e=this.widget.topView)===null||e===void 0||e.destroy()}get isEditable(){return!0}canReuseDOM(){return!0}}function Ae(n,e,t,i,s,o){if(t instanceof ne){for(let a=t.dom.firstChild;a;a=a.nextSibling){let u=Ne.get(a);if(!u)return o(n,e);let b=xe(a,i),x=u.length+(b?i.nodeValue.length:0);if(n<x||n==x&&u.getSide()<=0)return b?Ae(n,e,u,i,s,o):s(u,n,e);n-=x}return s(t,t.length,-1)}else return t.dom==i?o(n,e):s(t,n,e)}function Oe(n,e,t,i){if(t instanceof ne){let s=0;for(let o of t.children){let a=xe(o.dom,i);if(xe(o.dom,n))return s+(a?Oe(n,e,o,i):o.localPosFromDOM(n,e));s+=a?i.nodeValue.length:o.length}}else if(t.dom==i)return Math.min(e,i.nodeValue.length);return t.localPosFromDOM(n,e)}class Fe extends Ne{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Fe&&e.side==this.side}split(){return new Fe(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?We.before(this.dom):We.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){let t=this.dom.getBoundingClientRect(),i=Re(this,this.side>0?-1:1);return i&&i.top<t.bottom&&i.bottom>t.top?{left:t.left,right:t.right,top:i.top,bottom:i.bottom}:t}get overrideDOMText(){return w.xv.empty}}q.prototype.children=fe.prototype.children=Fe.prototype.children=nt;function Re(n,e){let t=n.parent,i=t?t.children.indexOf(n):-1;for(;t&&i>=0;)if(e<0?i>0:i<t.children.length){let s=t.children[i+e];if(s instanceof q){let o=s.coordsAt(e<0?s.length:0,e);if(o)return o}i+=e}else if(t instanceof ne&&t.parent)i=t.parent.children.indexOf(t)+(e<0?0:1),t=t.parent;else{let s=t.dom.lastChild;if(s&&s.nodeName=="BR")return s.getClientRects()[0];break}}function qe(n,e){let t=n.dom,{children:i}=n,s=0;for(let o=0;s<i.length;s++){let a=i[s],u=o+a.length;if(!(u==o&&a.getSide()<=0)){if(e>o&&e<u&&a.dom.parentNode==t)return a.domAtPos(e-o);if(e<=o)break;o=u}}for(let o=s;o>0;o--){let a=i[o-1];if(a.dom.parentNode==t)return a.domAtPos(a.length)}for(let o=s;o<i.length;o++){let a=i[o];if(a.dom.parentNode==t)return a.domAtPos(0)}return new We(t,0)}function Et(n,e,t){let i,{children:s}=n;t>0&&e instanceof ne&&s.length&&(i=s[s.length-1])instanceof ne&&i.mark.eq(e.mark)?Et(i,e.children[0],t-1):(s.push(e),e.setParent(n)),n.length+=e.length}function Lt(n,e,t){let i=null,s=-1,o=null,a=-1;function u(x,M){for(let I=0,K=0;I<x.children.length&&K<=M;I++){let Y=x.children[I],ae=K+Y.length;ae>=M&&(Y.children.length?u(Y,M-K):!o&&(ae>M||K==ae&&Y.getSide()>0)?(o=Y,a=M-K):(K<M||K==ae&&Y.getSide()<0)&&(i=Y,s=M-K)),K=ae}}u(n,e);let b=(t<0?i:o)||i||o;return b?b.coordsAt(Math.max(0,b==i?s:a),t):vt(n)}function vt(n){let e=n.dom.lastChild;if(!e)return n.dom.getBoundingClientRect();let t=Mt(e);return t[t.length-1]||null}function Ft(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}function kt(n,e){if(n==e)return!0;if(!n||!e)return!1;let t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let s of t)if(i.indexOf(s)==-1||n[s]!==e[s])return!1;return!0}function qt(n,e,t){let i=null;if(e)for(let s in e)t&&s in t||n.removeAttribute(i=s);if(t)for(let s in t)e&&e[s]==t[s]||n.setAttribute(i=s,t[s]);return!!i}class $t{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}ignoreEvent(e){return!0}get customView(){return null}destroy(e){}}var Ke=function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n}(Ke||(Ke={}));class ke extends w.uU{constructor(e,t,i,s){super(),this.startSide=e,this.endSide=t,this.widget=i,this.spec=s}get heightRelevant(){return!1}static mark(e){return new it(e)}static widget(e){let t=e.side||0,i=!!e.block;return t+=i?t>0?3e8:-4e8:t>0?1e8:-1e8,new Vt(e,t,t,i,e.widget||null,!1)}static replace(e){let t=!!e.block,i,s;if(e.isBlockGap)i=-5e8,s=4e8;else{let{start:o,end:a}=pi(e,t);i=(o?t?-3e8:-1:5e8)-1,s=(a?t?2e8:1:-6e8)+1}return new Vt(e,i,s,t,e.widget||null,!0)}static line(e){return new ci(e)}static set(e,t=!1){return w.Xs.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}ke.none=w.Xs.empty;class it extends ke{constructor(e){let{start:t,end:i}=pi(e);super(t?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){return this==e||e instanceof it&&this.tagName==e.tagName&&this.class==e.class&&kt(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}it.prototype.point=!1;class ci extends ke{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof ci&&this.spec.class==e.spec.class&&kt(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}ci.prototype.mapMode=w.gc.TrackBefore,ci.prototype.point=!0;class Vt extends ke{constructor(e,t,i,s,o,a){super(t,i,o,e),this.block=s,this.isReplace=a,this.mapMode=s?t<=0?w.gc.TrackBefore:w.gc.TrackAfter:w.gc.TrackDel}get type(){return this.startSide<this.endSide?Ke.WidgetRange:this.startSide<=0?Ke.WidgetBefore:Ke.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(e){return e instanceof Vt&&oi(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}Vt.prototype.point=!0;function pi(n,e=!1){let{inclusiveStart:t,inclusiveEnd:i}=n;return t==null&&(t=n.inclusive),i==null&&(i=n.inclusive),{start:t!=null?t:e,end:i!=null?i:e}}function oi(n,e){return n==e||!!(n&&e&&n.compare(e))}function H(n,e,t,i=0){let s=t.length-1;s>=0&&t[s]+i>=n?t[s]=Math.max(t[s],e):t.push(n,e)}class A extends Ne{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,i,s,o,a){if(i){if(!(i instanceof A))return!1;this.dom||i.transferDOM(this)}return s&&this.setDeco(i?i.attrs:null),Wt(this,e,t,i?i.children:[],o,a),!0}split(e){let t=new A;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i,off:s}=this.childPos(e);s&&(t.append(this.children[i].split(s),0),this.children[i].merge(s,this.children[i].length,null,!1,0,0),i++);for(let o=i;o<this.children.length;o++)t.append(this.children[o],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){kt(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){Et(this,e,t)}addLineDeco(e){let t=e.spec.attributes,i=e.spec.class;t&&(this.attrs=Ft(t,this.attrs||{})),i&&(this.attrs=Ft({class:i},this.attrs||{}))}domAtPos(e){return qe(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.dirty|=6)}sync(e,t){var i;this.dom?this.dirty&4&&(At(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(qt(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let s=this.dom.lastChild;for(;s&&Ne.get(s)instanceof ne;)s=s.lastChild;if(!s||!this.length||s.nodeName!="BR"&&((i=Ne.get(s))===null||i===void 0?void 0:i.isEditable)==!1&&(!pe.ios||!this.children.some(o=>o instanceof q))){let o=document.createElement("BR");o.cmIgnore=!0,this.dom.appendChild(o)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let i of this.children){if(!(i instanceof q)||/[^ -~]/.test(i.text))return null;let s=Mt(i.dom);if(s.length!=1)return null;e+=s[0].width,t=s[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let i=Lt(this,e,t);if(!this.children.length&&i&&this.parent){let{heightOracle:s}=this.parent.view.viewState,o=i.bottom-i.top;if(Math.abs(o-s.lineHeight)<2&&s.textHeight<o){let a=(o-s.textHeight)/2;return{top:i.top+a,bottom:i.bottom-a,left:i.left,right:i.left}}}return i}become(e){return!1}get type(){return Ke.Text}static find(e,t){for(let i=0,s=0;i<e.children.length;i++){let o=e.children[i],a=s+o.length;if(a>=t){if(o instanceof A)return o;if(a>t)break}s=a+o.breakAfter}return null}}class W extends Ne{constructor(e,t,i){super(),this.widget=e,this.length=t,this.type=i,this.breakAfter=0,this.prevWidget=null}merge(e,t,i,s,o,a){return i&&(!(i instanceof W)||!this.widget.compare(i.widget)||e>0&&o<=0||t<this.length&&a<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?We.before(this.dom):We.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let i=new W(this.widget,t,this.type);return i.breakAfter=this.breakAfter,i}get children(){return nt}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):w.xv.empty}domBoundsAround(){return null}become(e){return e instanceof W&&e.type==this.type&&e.widget.constructor==this.widget.constructor?(e.widget.eq(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class z{constructor(e,t,i,s){this.doc=e,this.pos=t,this.end=i,this.disallowBlockEffectsFor=s,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!e.breakAfter&&!(e instanceof W&&e.type==Ke.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new A),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(_(new Fe(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||this.getLine()}buildText(e,t,i){for(;e>0;){if(this.textOff==this.text.length){let{value:o,lineBreak:a,done:u}=this.cursor.next(this.skip);if(this.skip=0,u)throw new Error("Ran out of text content when drawing inline views");if(a){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=o,this.textOff=0}let s=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-i)),this.getLine().append(_(new q(this.text.slice(this.textOff,this.textOff+s)),t),i),this.atCursorPos=!0,this.textOff+=s,e-=s,i=0}}span(e,t,i,s){this.buildText(t-e,i,s),this.pos=t,this.openStart<0&&(this.openStart=s)}point(e,t,i,s,o,a){if(this.disallowBlockEffectsFor[a]&&i instanceof Vt){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let u=t-e;if(i instanceof Vt)if(i.block){let{type:b}=i;b==Ke.WidgetAfter&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new W(i.widget||new se("div"),u,b))}else{let b=fe.create(i.widget||new se("span"),u,u?0:i.startSide),x=this.atCursorPos&&!b.isEditable&&o<=s.length&&(e<t||i.startSide>0),M=!b.isEditable&&(e<t||o>s.length||i.startSide<=0),I=this.getLine();this.pendingBuffer==2&&!x&&(this.pendingBuffer=0),this.flushBuffer(s),x&&(I.append(_(new Fe(1),s),o),o=s.length+Math.max(0,o-s.length)),I.append(_(b,s),o),this.atCursorPos=M,this.pendingBuffer=M?e<t||o>s.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=s.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);u&&(this.textOff+u<=this.text.length?this.textOff+=u:(this.skip+=u-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=o)}static build(e,t,i,s,o){let a=new z(e,t,i,o);return a.openEnd=w.Xs.spans(s,t,i,a),a.openStart<0&&(a.openStart=a.openEnd),a.finish(a.openEnd),a}}function _(n,e){for(let t of e)n=new ne(t,[n],n.length);return n}class se extends $t{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}}const ye=w.r$.define(),we=w.r$.define(),Me=w.r$.define(),De=w.r$.define(),ot=w.r$.define(),ct=w.r$.define(),yt=w.r$.define(),li=w.r$.define({combine:n=>n.some(e=>e)}),Qt=w.r$.define({combine:n=>n.some(e=>e)});class St{constructor(e,t="nearest",i="nearest",s=5,o=5){this.range=e,this.y=t,this.x=i,this.yMargin=s,this.xMargin=o}map(e){return e.empty?this:new St(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin)}}const Si=w.Py.define({map:(n,e)=>n.map(e)});function Ht(n,e,t){let i=n.facet(De);i.length?i[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const xi=w.r$.define({combine:n=>n.length?n[0]:!0});let jt=0;const Xt=w.r$.define();class mt{constructor(e,t,i,s){this.id=e,this.create=t,this.domEventHandlers=i,this.extension=s(this)}static define(e,t){const{eventHandlers:i,provide:s,decorations:o}=t||{};return new mt(jt++,e,i,a=>{let u=[Xt.of(a)];return o&&u.push(Zt.of(b=>{let x=b.plugin(a);return x?o(x):ke.none})),s&&u.push(s(a)),u})}static fromClass(e,t){return mt.define(i=>new e(i),t)}}class ai{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(i){if(Ht(t.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){Ht(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(i){Ht(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const vi=w.r$.define(),fi=w.r$.define(),Zt=w.r$.define(),yi=w.r$.define(),Ai=w.r$.define(),ki=w.r$.define();class Yt{constructor(e,t,i,s){this.fromA=e,this.toA=t,this.fromB=i,this.toB=s}join(e){return new Yt(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,i=this;for(;t>0;t--){let s=e[t-1];if(!(s.fromA>i.toA)){if(s.toA<i.fromA)break;i=i.join(s),e.splice(t-1,1)}}return e.splice(t,0,i),e}static extendWithRanges(e,t){if(t.length==0)return e;let i=[];for(let s=0,o=0,a=0,u=0;;s++){let b=s==e.length?null:e[s],x=a-u,M=b?b.fromB:1e9;for(;o<t.length&&t[o]<M;){let I=t[o],K=t[o+1],Y=Math.max(u,I),ae=Math.min(M,K);if(Y<=ae&&new Yt(Y+x,ae+x,Y,ae).addToSet(i),K>M)break;o+=2}if(!b)return i;new Yt(b.fromA,b.toA,b.fromB,b.toB).addToSet(i),a=b.toA,u=b.toB}}}class D{constructor(e,t,i){this.view=e,this.state=t,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=w.as.empty(this.startState.doc.length);for(let o of i)this.changes=this.changes.compose(o.changes);let s=[];this.changes.iterChangedRanges((o,a,u,b)=>s.push(new Yt(o,a,u,b))),this.changedRanges=s}static create(e,t,i){return new D(e,t,i)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var r=function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n}(r||(r={}));const l=r.LTR,c=r.RTL;function m(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const S=m("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),k=m("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),L=Object.create(null),V=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);L[e]=t,L[t]=-e}function te(n){return n<=247?S[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?k[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8203?256:64336<=n&&n<=65023?4:n==8204?256:1}const he=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class y{constructor(e,t,i){this.from=e,this.to=t,this.level=i}get dir(){return this.level%2?c:l}side(e,t){return this.dir==t==e?this.to:this.from}static find(e,t,i,s){let o=-1;for(let a=0;a<e.length;a++){let u=e[a];if(u.from<=t&&u.to>=t){if(u.level==i)return a;(o<0||(s!=0?s<0?u.from<t:u.to>t:e[o].level>u.level))&&(o=a)}}if(o<0)throw new RangeError("Index out of range");return o}}const f=[];function g(n,e){let t=n.length,i=e==l?1:2,s=e==l?2:1;if(!n||i==1&&!he.test(n))return T(t);for(let a=0,u=i,b=i;a<t;a++){let x=te(n.charCodeAt(a));x==512?x=u:x==8&&b==4&&(x=16),f[a]=x==4?2:x,x&7&&(b=x),u=x}for(let a=0,u=i,b=i;a<t;a++){let x=f[a];if(x==128)a<t-1&&u==f[a+1]&&u&24?x=f[a]=u:f[a]=256;else if(x==64){let M=a+1;for(;M<t&&f[M]==64;)M++;let I=a&&u==8||M<t&&f[M]==8?b==1?1:8:256;for(let K=a;K<M;K++)f[K]=I;a=M-1}else x==8&&b==1&&(f[a]=1);u=x,x&7&&(b=x)}for(let a=0,u=0,b=0,x,M,I;a<t;a++)if(M=L[x=n.charCodeAt(a)])if(M<0){for(let K=u-3;K>=0;K-=3)if(V[K+1]==-M){let Y=V[K+2],ae=Y&2?i:Y&4?Y&1?s:i:0;ae&&(f[a]=f[V[K]]=ae),u=K;break}}else{if(V.length==189)break;V[u++]=a,V[u++]=x,V[u++]=b}else if((I=f[a])==2||I==1){let K=I==i;b=K?0:1;for(let Y=u-3;Y>=0;Y-=3){let ae=V[Y+2];if(ae&2)break;if(K)V[Y+2]|=2;else{if(ae&4)break;V[Y+2]|=4}}}for(let a=0;a<t;a++)if(f[a]==256){let u=a+1;for(;u<t&&f[u]==256;)u++;let b=(a?f[a-1]:i)==1,x=(u<t?f[u]:i)==1,M=b==x?b?1:2:i;for(let I=a;I<u;I++)f[I]=M;a=u-1}let o=[];if(i==1)for(let a=0;a<t;){let u=a,b=f[a++]!=1;for(;a<t&&b==(f[a]!=1);)a++;if(b)for(let x=a;x>u;){let M=x,I=f[--x]!=2;for(;x>u&&I==(f[x-1]!=2);)x--;o.push(new y(x,M,I?2:1))}else o.push(new y(u,a,0))}else for(let a=0;a<t;){let u=a,b=f[a++]==2;for(;a<t&&b==(f[a]==2);)a++;o.push(new y(u,a,b?1:2))}return o}function T(n){return[new y(0,n,0)]}let B="";function F(n,e,t,i,s){var o;let a=i.head-n.from,u=-1;if(a==0){if(!s||!n.length)return null;e[0].level!=t&&(a=e[0].side(!1,t),u=0)}else if(a==n.length){if(s)return null;let K=e[e.length-1];K.level!=t&&(a=K.side(!0,t),u=e.length-1)}u<0&&(u=y.find(e,a,(o=i.bidiLevel)!==null&&o!==void 0?o:-1,i.assoc));let b=e[u];a==b.side(s,t)&&(b=e[u+=s?1:-1],a=b.side(!s,t));let x=s==(b.dir==t),M=(0,w.cp)(n.text,a,x);if(B=n.text.slice(Math.min(a,M),Math.max(a,M)),M!=b.side(s,t))return w.jT.cursor(M+n.from,x?-1:1,b.level);let I=u==(s?e.length-1:0)?null:e[u+(s?1:-1)];return!I&&b.level!=t?w.jT.cursor(s?n.to:n.from,s?-1:1,t):I&&I.level<b.level?w.jT.cursor(I.side(!s,t)+n.from,s?1:-1,I.level):w.jT.cursor(M+n.from,s?-1:1,b.level)}const U="\uFFFF";class G{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(w.yy.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=U}readRange(e,t){if(!e)return this;let i=e.parentNode;for(let s=e;;){this.findPointBefore(i,s),this.readNode(s);let o=s.nextSibling;if(o==t)break;let a=Ne.get(s),u=Ne.get(o);(a&&u?a.breakAfter:(a?a.breakAfter:ie(s))||ie(o)&&(s.nodeName!="BR"||s.cmIgnore))&&this.lineBreak(),s=o}return this.findPointBefore(i,t),this}readTextNode(e){let t=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,t.length));for(let i=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let o=-1,a=1,u;if(this.lineSeparator?(o=t.indexOf(this.lineSeparator,i),a=this.lineSeparator.length):(u=s.exec(t))&&(o=u.index,a=u[0].length),this.append(t.slice(i,o<0?t.length:o)),o<0)break;if(this.lineBreak(),a>1)for(let b of this.points)b.node==e&&b.pos>this.text.length&&(b.pos-=a-1);i=o+a}}readNode(e){if(e.cmIgnore)return;let t=Ne.get(e),i=t&&t.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let s=i.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==t&&(i.pos=this.text.length)}findPointInside(e,t){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+Math.min(t,i.offset))}}function ie(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}class be{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class Ce extends Ne{constructor(e){super(),this.view=e,this.compositionDeco=ke.none,this.decorations=[],this.dynamicDecorationMap=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new A],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Yt(0,0,0,e.state.doc.length)],0)}get length(){return this.view.state.doc.length}update(e){let t=e.changedRanges;this.minWidth>0&&t.length&&(t.every(({fromA:a,toA:u})=>u<this.minWidthFrom||a>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=ke.none:(e.transactions.length||this.dirty)&&(this.compositionDeco=ei(this.view,e.changes)),(pe.ie||pe.chrome)&&!this.compositionDeco.size&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let i=this.decorations,s=this.updateDeco(),o=O(i,s,e.changes);return t=Yt.extendWithRanges(t,o),this.dirty==0&&t.length==0?!1:(this.updateInner(t,e.startState.doc.length),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t);let{observer:i}=this.view;i.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=pe.chrome||pe.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.dirty=0,o&&(o.written||i.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""});let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof W&&o.widget instanceof mi&&s.push(o.dom);i.updateGaps(s)}updateChildren(e,t){let i=this.childCursor(t);for(let s=e.length-1;;s--){let o=s>=0?e[s]:null;if(!o)break;let{fromA:a,toA:u,fromB:b,toB:x}=o,{content:M,breakAtStart:I,openStart:K,openEnd:Y}=z.build(this.view.state.doc,b,x,this.decorations,this.dynamicDecorationMap),{i:ae,off:ue}=i.findPos(u,1),{i:ce,off:ge}=i.findPos(a,-1);Nt(this,ce,ge,ae,ue,M,I,K,Y)}}updateSelection(e=!1,t=!1){if((e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange(),!(t||this.mayControlSelection()))return;let i=this.forceSelection;this.forceSelection=!1;let s=this.view.state.selection.main,o=this.domAtPos(s.anchor),a=s.empty?o:this.domAtPos(s.head);if(pe.gecko&&s.empty&&Qe(o)){let b=document.createTextNode("");this.view.observer.ignore(()=>o.node.insertBefore(b,o.node.childNodes[o.offset]||null)),o=a=new We(b,0),i=!0}let u=this.view.observer.selectionRange;(i||!u.focusNode||!Rt(o.node,o.offset,u.anchorNode,u.anchorOffset)||!Rt(a.node,a.offset,u.focusNode,u.focusOffset))&&(this.view.observer.ignore(()=>{pe.android&&pe.chrome&&this.dom.contains(u.focusNode)&&P(u.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let b=me(this.view.root);if(b)if(s.empty){if(pe.gecko){let x=h(o.node,o.offset);if(x&&x!=3){let M=C(o.node,o.offset,x==1?1:-1);M&&(o=new We(M,x==1?0:M.nodeValue.length))}}b.collapse(o.node,o.offset),s.bidiLevel!=null&&u.cursorBidiLevel!=null&&(u.cursorBidiLevel=s.bidiLevel)}else if(b.extend){b.collapse(o.node,o.offset);try{b.extend(a.node,a.offset)}catch{}}else{let x=document.createRange();s.anchor>s.head&&([o,a]=[a,o]),x.setEnd(a.node,a.offset),x.setStart(o.node,o.offset),b.removeAllRanges(),b.addRange(x)}}),this.view.observer.setSelectionRange(o,a)),this.impreciseAnchor=o.precise?null:new We(u.anchorNode,u.anchorOffset),this.impreciseHead=a.precise?null:new We(u.focusNode,u.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let{view:e}=this,t=e.state.selection.main,i=me(e.root),{anchorNode:s,anchorOffset:o}=e.observer.selectionRange;if(!i||!t.empty||!t.assoc||!i.modify)return;let a=A.find(this,t.head);if(!a)return;let u=a.posAtStart;if(t.head==u||t.head==u+a.length)return;let b=this.coordsAt(t.head,-1),x=this.coordsAt(t.head,1);if(!b||!x||b.bottom>x.top)return;let M=this.domAtPos(t.head+t.assoc);i.collapse(M.node,M.offset),i.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let I=e.observer.selectionRange;e.docView.posFromDOM(I.anchorNode,I.anchorOffset)!=t.from&&i.collapse(s,o)}mayControlSelection(){let e=this.view.root.activeElement;return e==this.dom||Ze(this.dom,this.view.observer.selectionRange)&&!(e&&this.dom.contains(e))}nearest(e){for(let t=e;t;){let i=Ne.get(t);if(i&&i.rootView==this)return i;t=t.parentNode}return null}posFromDOM(e,t){let i=this.nearest(e);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(e,t)+i.posAtStart}domAtPos(e){let{i:t,off:i}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let s=this.children[t];if(i<s.length||s instanceof A)break;t++,i=0}return this.children[t].domAtPos(i)}coordsAt(e,t){for(let i=this.length,s=this.children.length-1;;s--){let o=this.children[s],a=i-o.breakAfter-o.length;if(e>a||e==a&&o.type!=Ke.WidgetBefore&&o.type!=Ke.WidgetAfter&&(!s||t==2||this.children[s-1].breakAfter||this.children[s-1].type==Ke.WidgetBefore&&t>-2))return o.coordsAt(e-a,t);i=a}}measureVisibleLineHeights(e){let t=[],{from:i,to:s}=e,o=this.view.contentDOM.clientWidth,a=o>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,u=-1,b=this.view.textDirection==r.LTR;for(let x=0,M=0;M<this.children.length;M++){let I=this.children[M],K=x+I.length;if(K>s)break;if(x>=i){let Y=I.dom.getBoundingClientRect();if(t.push(Y.height),a){let ae=I.dom.lastChild,ue=ae?Mt(ae):[];if(ue.length){let ce=ue[ue.length-1],ge=b?ce.right-Y.left:Y.right-ce.left;ge>u&&(u=ge,this.minWidth=o,this.minWidthFrom=x,this.minWidthTo=K)}}}x=K+I.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?r.RTL:r.LTR}measureTextSize(){for(let o of this.children)if(o instanceof A){let a=o.measureTextSize();if(a)return a}let e=document.createElement("div"),t,i,s;return e.className="cm-line",e.style.width="99999px",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let o=Mt(e.firstChild)[0];t=e.getBoundingClientRect().height,i=o?o.width/27:7,s=o?o.height:t,e.remove()}),{lineHeight:t,charWidth:i,textHeight:s}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new pt(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let i=0,s=0;;s++){let o=s==t.viewports.length?null:t.viewports[s],a=o?o.from-1:this.length;if(a>i){let u=t.lineBlockAt(a).bottom-t.lineBlockAt(i).top;e.push(ke.replace({widget:new mi(u),block:!0,inclusive:!0,isBlockGap:!0}).range(i,a))}if(!o)break;i=o.to+1}return ke.set(e)}updateDeco(){let e=this.view.state.facet(Zt).map((t,i)=>(this.dynamicDecorationMap[i]=typeof t=="function")?t(this.view):t);for(let t=e.length;t<e.length+3;t++)this.dynamicDecorationMap[t]=!1;return this.decorations=[...e,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){let{range:t}=e,i=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),s;if(!i)return;!t.empty&&(s=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(i={left:Math.min(i.left,s.left),top:Math.min(i.top,s.top),right:Math.max(i.right,s.right),bottom:Math.max(i.bottom,s.bottom)});let o=0,a=0,u=0,b=0;for(let M of this.view.state.facet(Ai).map(I=>I(this.view)))if(M){let{left:I,right:K,top:Y,bottom:ae}=M;I!=null&&(o=Math.max(o,I)),K!=null&&(a=Math.max(a,K)),Y!=null&&(u=Math.max(u,Y)),ae!=null&&(b=Math.max(b,ae))}let x={left:i.left-o,top:i.top-u,right:i.right+a,bottom:i.bottom+b};Gt(this.view.scrollDOM,x,t.head<t.anchor?-1:1,e.x,e.y,e.xMargin,e.yMargin,this.view.textDirection==r.LTR)}}function Qe(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}class mi extends $t{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function zt(n){let e=n.observer.selectionRange,t=e.focusNode&&C(e.focusNode,e.focusOffset,0);if(!t)return null;let i=n.docView.nearest(t);if(!i)return null;if(i instanceof A){let s=t;for(;s.parentNode!=i.dom;)s=s.parentNode;let o=s.previousSibling;for(;o&&!Ne.get(o);)o=o.previousSibling;let a=o?Ne.get(o).posAtEnd:i.posAtStart;return{from:a,to:a,node:s,text:t}}else{for(;;){let{parent:o}=i;if(!o)return null;if(o instanceof A)break;i=o}let s=i.posAtStart;return{from:s,to:s+i.length,node:i.dom,text:t}}}function ei(n,e){let t=zt(n);if(!t)return ke.none;let{from:i,to:s,node:o,text:a}=t,u=e.mapPos(i,1),b=Math.max(u,e.mapPos(s,-1)),{state:x}=n,M=o.nodeType==3?o.nodeValue:new G([],x).readRange(o.firstChild,null).text;if(b-u<M.length)if(x.doc.sliceString(u,Math.min(x.doc.length,u+M.length),U)==M)b=u+M.length;else if(x.doc.sliceString(Math.max(0,b-M.length),b,U)==M)u=b-M.length;else return ke.none;else if(x.doc.sliceString(u,b,U)!=M)return ke.none;let I=Ne.get(o);return I instanceof ve?I=I.widget.topView:I&&(I.parent=null),ke.set(ke.replace({widget:new bi(o,a,I),inclusive:!0}).range(u,b))}class bi extends $t{constructor(e,t,i){super(),this.top=e,this.text=t,this.topView=i}eq(e){return this.top==e.top&&this.text==e.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return ve}}function C(n,e,t){if(t<=0)for(let i=n,s=e;;){if(i.nodeType==3)return i;if(i.nodeType==1&&s>0)i=i.childNodes[s-1],s=Dt(i);else break}if(t>=0)for(let i=n,s=e;;){if(i.nodeType==3)return i;if(i.nodeType==1&&s<i.childNodes.length&&t>=0)i=i.childNodes[s],s=0;else break}return null}function h(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}class p{constructor(){this.changes=[]}compareRange(e,t){H(e,t,this.changes)}comparePoint(e,t){H(e,t,this.changes)}}function O(n,e,t){let i=new p;return w.Xs.compare(n,e,t,i),i.changes}function P(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function j(n,e,t=1){let i=n.charCategorizer(e),s=n.doc.lineAt(e),o=e-s.from;if(s.length==0)return w.jT.cursor(e);o==0?t=1:o==s.length&&(t=-1);let a=o,u=o;t<0?a=(0,w.cp)(s.text,o,!1):u=(0,w.cp)(s.text,o);let b=i(s.text.slice(a,u));for(;a>0;){let x=(0,w.cp)(s.text,a,!1);if(i(s.text.slice(x,a))!=b)break;a=x}for(;u<s.length;){let x=(0,w.cp)(s.text,u);if(i(s.text.slice(u,x))!=b)break;u=x}return w.jT.range(a+s.from,u+s.from)}function J(n,e){return e.left>n?e.left-n:Math.max(0,n-e.right)}function le(n,e){return e.top>n?e.top-n:Math.max(0,n-e.bottom)}function oe(n,e){return n.top<e.bottom-1&&n.bottom>e.top+1}function Te(n,e){return e<n.top?{top:e,left:n.left,right:n.right,bottom:n.bottom}:n}function Pe(n,e){return e>n.bottom?{top:n.top,left:n.left,right:n.right,bottom:e}:n}function je(n,e,t){let i,s,o,a,u=!1,b,x,M,I;for(let ae=n.firstChild;ae;ae=ae.nextSibling){let ue=Mt(ae);for(let ce=0;ce<ue.length;ce++){let ge=ue[ce];s&&oe(s,ge)&&(ge=Te(Pe(ge,s.bottom),s.top));let ze=J(e,ge),et=le(t,ge);if(ze==0&&et==0)return ae.nodeType==3?Kt(ae,e,t):je(ae,e,t);if(!i||a>et||a==et&&o>ze){i=ae,s=ge,o=ze,a=et;let Ue=et?t<ge.top?-1:1:ze?e<ge.left?-1:1:0;u=!Ue||(Ue>0?ce<ue.length-1:ce>0)}ze==0?t>ge.bottom&&(!M||M.bottom<ge.bottom)?(b=ae,M=ge):t<ge.top&&(!I||I.top>ge.top)&&(x=ae,I=ge):M&&oe(M,ge)?M=Pe(M,ge.bottom):I&&oe(I,ge)&&(I=Te(I,ge.top))}}if(M&&M.bottom>=t?(i=b,s=M):I&&I.top<=t&&(i=x,s=I),!i)return{node:n,offset:0};let K=Math.max(s.left,Math.min(s.right,e));if(i.nodeType==3)return Kt(i,K,t);if(u&&i.contentEditable!="false")return je(i,K,t);let Y=Array.prototype.indexOf.call(n.childNodes,i)+(e>=(s.left+s.right)/2?1:0);return{node:n,offset:Y}}function Kt(n,e,t){let i=n.nodeValue.length,s=-1,o=1e9,a=0;for(let u=0;u<i;u++){let b=ft(n,u,u+1).getClientRects();for(let x=0;x<b.length;x++){let M=b[x];if(M.top==M.bottom)continue;a||(a=e-M.left);let I=(M.top>t?M.top-t:t-M.bottom)-1;if(M.left-1<=e&&M.right+1>=e&&I<o){let K=e>=(M.left+M.right)/2,Y=K;if((pe.chrome||pe.gecko)&&ft(n,u).getBoundingClientRect().left==M.right&&(Y=!K),I<=0)return{node:n,offset:u+(Y?1:0)};s=u+(Y?1:0),o=I}}}return{node:n,offset:s>-1?s:a>0?n.nodeValue.length:0}}function Ut(n,e,t,i=-1){var s,o;let a=n.contentDOM.getBoundingClientRect(),u=a.top+n.viewState.paddingTop,b,{docHeight:x}=n.viewState,{x:M,y:I}=e,K=I-u;if(K<0)return 0;if(K>x)return n.state.doc.length;for(let Ue=n.defaultLineHeight/2,lt=!1;b=n.elementAtHeight(K),b.type!=Ke.Text;)for(;K=i>0?b.bottom+Ue:b.top-Ue,!(K>=0&&K<=x);){if(lt)return t?null:0;lt=!0,i=-i}I=u+K;let Y=b.from;if(Y<n.viewport.from)return n.viewport.from==0?0:t?null:gi(n,a,b,M,I);if(Y>n.viewport.to)return n.viewport.to==n.state.doc.length?n.state.doc.length:t?null:gi(n,a,b,M,I);let ae=n.dom.ownerDocument,ue=n.root.elementFromPoint?n.root:ae,ce=ue.elementFromPoint(M,I);ce&&!n.contentDOM.contains(ce)&&(ce=null),ce||(M=Math.max(a.left+1,Math.min(a.right-1,M)),ce=ue.elementFromPoint(M,I),ce&&!n.contentDOM.contains(ce)&&(ce=null));let ge,ze=-1;if(ce&&((s=n.docView.nearest(ce))===null||s===void 0?void 0:s.isEditable)!=!1){if(ae.caretPositionFromPoint){let Ue=ae.caretPositionFromPoint(M,I);Ue&&({offsetNode:ge,offset:ze}=Ue)}else if(ae.caretRangeFromPoint){let Ue=ae.caretRangeFromPoint(M,I);Ue&&({startContainer:ge,startOffset:ze}=Ue,(!n.contentDOM.contains(ge)||pe.safari&&Ci(ge,ze,M)||pe.chrome&&_i(ge,ze,M))&&(ge=void 0))}}if(!ge||!n.docView.dom.contains(ge)){let Ue=A.find(n.docView,Y);if(!Ue)return K>b.top+b.height/2?b.to:b.from;({node:ge,offset:ze}=je(Ue.dom,M,I))}let et=n.docView.nearest(ge);if(!et)return null;if(et.isWidget&&((o=et.dom)===null||o===void 0?void 0:o.nodeType)==1){let Ue=et.dom.getBoundingClientRect();return e.y<Ue.top||e.y<=Ue.bottom&&e.x<=(Ue.left+Ue.right)/2?et.posAtStart:et.posAtEnd}else return et.localPosFromDOM(ge,ze)+et.posAtStart}function gi(n,e,t,i,s){let o=Math.round((i-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&t.height>n.defaultLineHeight*1.5){let u=Math.floor((s-t.top)/n.defaultLineHeight);o+=u*n.viewState.heightOracle.lineLength}let a=n.state.sliceDoc(t.from,t.to);return t.from+(0,w.Gz)(a,o,n.state.tabSize)}function Ci(n,e,t){let i;if(n.nodeType!=3||e!=(i=n.nodeValue.length))return!1;for(let s=n.nextSibling;s;s=s.nextSibling)if(s.nodeType!=1||s.nodeName!="BR")return!1;return ft(n,i-1,i).getBoundingClientRect().left>t}function _i(n,e,t){if(e!=0)return!1;for(let s=n;;){let o=s.parentNode;if(!o||o.nodeType!=1||o.firstChild!=s)return!1;if(o.classList.contains("cm-line"))break;s=o}let i=n.nodeType==1?n.getBoundingClientRect():ft(n,0,Math.max(n.nodeValue.length,1)).getBoundingClientRect();return t-i.left>5}function Wi(n,e,t,i){let s=n.state.doc.lineAt(e.head),o=!i||!n.lineWrapping?null:n.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head);if(o){let b=n.dom.getBoundingClientRect(),x=n.textDirectionAt(s.from),M=n.posAtCoords({x:t==(x==r.LTR)?b.right-1:b.left+1,y:(o.top+o.bottom)/2});if(M!=null)return w.jT.cursor(M,t?-1:1)}let a=A.find(n.docView,e.head),u=a?t?a.posAtEnd:a.posAtStart:t?s.to:s.from;return w.jT.cursor(u,t?-1:1)}function en(n,e,t,i){let s=n.state.doc.lineAt(e.head),o=n.bidiSpans(s),a=n.textDirectionAt(s.from);for(let u=e,b=null;;){let x=F(s,o,a,u,t),M=B;if(!x){if(s.number==(t?n.state.doc.lines:1))return u;M=`
`,s=n.state.doc.line(s.number+(t?1:-1)),o=n.bidiSpans(s),x=w.jT.cursor(t?s.from:s.to)}if(b){if(!b(M))return u}else{if(!i)return x;b=i(M)}u=x}}function $n(n,e,t){let i=n.state.charCategorizer(e),s=i(t);return o=>{let a=i(o);return s==w.D0.Space&&(s=a),s==a}}function vn(n,e,t,i){let s=e.head,o=t?1:-1;if(s==(t?n.state.doc.length:0))return w.jT.cursor(s,e.assoc);let a=e.goalColumn,u,b=n.contentDOM.getBoundingClientRect(),x=n.coordsAtPos(s),M=n.documentTop;if(x)a==null&&(a=x.left-b.left),u=o<0?x.top:x.bottom;else{let Y=n.viewState.lineBlockAt(s);a==null&&(a=Math.min(b.right-b.left,n.defaultCharacterWidth*(s-Y.from))),u=(o<0?Y.top:Y.bottom)+M}let I=b.left+a,K=i!=null?i:n.defaultLineHeight>>1;for(let Y=0;;Y+=10){let ae=u+(K+Y)*o,ue=Ut(n,{x:I,y:ae},!1,o);if(ae<b.top||ae>b.bottom||(o<0?ue<s:ue>s))return w.jT.cursor(ue,e.assoc,void 0,a)}}function $i(n,e,t){let i=n.state.facet(yi).map(s=>s(n));for(;;){let s=!1;for(let o of i)o.between(t.from-1,t.from+1,(a,u,b)=>{t.from>a&&t.from<u&&(t=e.head>t.from?w.jT.cursor(a,1):w.jT.cursor(u,-1),s=!0)});if(!s)return t}}class kn{constructor(e){this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.mouseSelection=null;let t=(i,s)=>{this.ignoreDuringComposition(s)||s.type=="keydown"&&this.keydown(e,s)||(this.mustFlushObserver(s)&&e.observer.forceFlush(),this.runCustomHandlers(s.type,e,s)?s.preventDefault():i(e,s))};for(let i in Jt){let s=Jt[i];e.contentDOM.addEventListener(i,o=>{sn(e,o)&&t(s,o)},d[i]),this.registeredEvents.push(i)}e.scrollDOM.addEventListener("mousedown",i=>{if(i.target==e.scrollDOM&&i.clientY>e.contentDOM.getBoundingClientRect().bottom&&(t(Jt.mousedown,i),!i.defaultPrevented&&i.button==2)){let s=e.contentDOM.style.minHeight;e.contentDOM.style.minHeight="100%",setTimeout(()=>e.contentDOM.style.minHeight=s,200)}}),pe.chrome&&pe.chrome_version==102&&e.scrollDOM.addEventListener("wheel",()=>{this.chromeScrollHack<0?e.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout(()=>{this.chromeScrollHack=-1,e.contentDOM.style.pointerEvents=""},100)},{passive:!0}),this.notifiedFocused=e.hasFocus,pe.safari&&e.contentDOM.addEventListener("input",()=>null)}setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}ensureHandlers(e,t){var i;let s;this.customHandlers=[];for(let o of t)if(s=(i=o.update(e).spec)===null||i===void 0?void 0:i.domEventHandlers){this.customHandlers.push({plugin:o.value,handlers:s});for(let a in s)this.registeredEvents.indexOf(a)<0&&a!="scroll"&&(this.registeredEvents.push(a),e.contentDOM.addEventListener(a,u=>{sn(e,u)&&this.runCustomHandlers(a,e,u)&&u.preventDefault()}))}}runCustomHandlers(e,t,i){for(let s of this.customHandlers){let o=s.handlers[e];if(o)try{if(o.call(s.plugin,i,t)||i.defaultPrevented)return!0}catch(a){Ht(t.state,a)}}return!1}runScrollHandlers(e,t){this.lastScrollTop=e.scrollDOM.scrollTop,this.lastScrollLeft=e.scrollDOM.scrollLeft;for(let i of this.customHandlers){let s=i.handlers.scroll;if(s)try{s.call(i.plugin,t,e)}catch(o){Ht(e.state,o)}}}keydown(e,t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(pe.android&&pe.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return e.observer.delayAndroidKey(t.key,t.keyCode),!0;let i;return pe.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((i=Ji.find(s=>s.keyCode==t.keyCode))&&!t.ctrlKey||qi.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=i||t,setTimeout(()=>this.flushIOSKey(e),250),!0):!1}flushIOSKey(e){let t=this.pendingIOSKey;return t?(this.pendingIOSKey=void 0,at(e.contentDOM,t.key,t.keyCode)):!1}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:pe.safari&&!pe.ios&&Date.now()-this.compositionEndedAt<100?(this.compositionEndedAt=0,!0):!1:!1}mustFlushObserver(e){return e.type=="keydown"&&e.keyCode!=229}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const Ji=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],qi="dthko",tn=[16,17,18,20,91,92,224,225];function Pi(n){return n*.7+8}class nn{constructor(e,t,i,s){this.view=e,this.style=i,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParent=ii(e.contentDOM);let o=e.contentDOM.ownerDocument;o.addEventListener("mousemove",this.move=this.move.bind(this)),o.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(w.yy.allowMultipleSelections)&&Jn(e,t),this.dragMove=Sn(e,t),this.dragging=Cn(e,t)&&Mi(t)==1?null:!1}start(e){this.dragging===!1&&(e.preventDefault(),this.select(e))}move(e){var t;if(e.buttons==0)return this.destroy();if(this.dragging!==!1)return;this.select(this.lastEvent=e);let i=0,s=0,o=((t=this.scrollParent)===null||t===void 0?void 0:t.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight};e.clientX<=o.left?i=-Pi(o.left-e.clientX):e.clientX>=o.right&&(i=Pi(e.clientX-o.right)),e.clientY<=o.top?s=-Pi(o.top-e.clientY):e.clientY>=o.bottom&&(s=Pi(e.clientY-o.bottom)),this.setScrollSpeed(i,s)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}select(e){let t=this.style.get(e,this.extend,this.multiple);(this.mustSelect||!t.eq(this.view.state.selection)||t.main.assoc!=this.view.state.selection.main.assoc)&&this.view.dispatch({selection:t,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.docChanged&&this.dragging&&(this.dragging=this.dragging.map(e.changes)),this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Jn(n,e){let t=n.state.facet(ye);return t.length?t[0](e):pe.mac?e.metaKey:e.ctrlKey}function Sn(n,e){let t=n.state.facet(we);return t.length?t[0](e):pe.mac?!e.altKey:!e.ctrlKey}function Cn(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let i=me(n.root);if(!i||i.rangeCount==0)return!0;let s=i.getRangeAt(0).getClientRects();for(let o=0;o<s.length;o++){let a=s[o];if(a.left<=e.clientX&&a.right>=e.clientX&&a.top<=e.clientY&&a.bottom>=e.clientY)return!0}return!1}function sn(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,i;t!=n.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(i=Ne.get(t))&&i.ignoreEvent(e))return!1;return!0}const Jt=Object.create(null),d=Object.create(null),v=pe.ie&&pe.ie_version<15||pe.ios&&pe.webkit_version<604;function R(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),E(n,t.value)},50)}function E(n,e){let{state:t}=n,i,s=1,o=t.toText(e),a=o.lines==t.selection.ranges.length;if(Mn!=null&&t.selection.ranges.every(b=>b.empty)&&Mn==o.toString()){let b=-1;i=t.changeByRange(x=>{let M=t.doc.lineAt(x.from);if(M.from==b)return{range:x};b=M.from;let I=t.toText((a?o.line(s++).text:e)+t.lineBreak);return{changes:{from:M.from,insert:I},range:w.jT.cursor(x.from+I.length)}})}else a?i=t.changeByRange(b=>{let x=o.line(s++);return{changes:{from:b.from,to:b.to,insert:x.text},range:w.jT.cursor(b.from+x.length)}}):i=t.replaceSelection(o);n.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}Jt.keydown=(n,e)=>{n.inputState.setSelectionOrigin("select"),e.keyCode==27?n.inputState.lastEscPress=Date.now():tn.indexOf(e.keyCode)<0&&(n.inputState.lastEscPress=0)},Jt.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")},Jt.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")},d.touchstart=d.touchmove={passive:!0},Jt.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return;let t=null;for(let i of n.state.facet(Me))if(t=i(n,e),t)break;if(!t&&e.button==0&&(t=Fi(n,e)),t){let i=n.root.activeElement!=n.contentDOM;n.inputState.startMouseSelection(new nn(n,e,t,i)),i&&n.observer.ignore(()=>bt(n.contentDOM)),n.inputState.mouseSelection&&n.inputState.mouseSelection.start(e)}};function $(n,e,t,i){if(i==1)return w.jT.cursor(e,t);if(i==2)return j(n.state,e,t);{let s=A.find(n.docView,e),o=n.state.doc.lineAt(s?s.posAtEnd:e),a=s?s.posAtStart:o.from,u=s?s.posAtEnd:o.to;return u<n.state.doc.length&&u==o.to&&u++,w.jT.range(a,u)}}let N=(n,e)=>n>=e.top&&n<=e.bottom,X=(n,e,t)=>N(e,t)&&n>=t.left&&n<=t.right;function de(n,e,t,i){let s=A.find(n.docView,e);if(!s)return 1;let o=e-s.posAtStart;if(o==0)return 1;if(o==s.length)return-1;let a=s.coordsAt(o,-1);if(a&&X(t,i,a))return-1;let u=s.coordsAt(o,1);return u&&X(t,i,u)?1:a&&N(i,a)?-1:1}function Se(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:de(n,t,e.clientX,e.clientY)}}const Le=pe.ie&&pe.ie_version<=11;let Ie=null,$e=0,ti=0;function Mi(n){if(!Le)return n.detail;let e=Ie,t=ti;return Ie=n,ti=Date.now(),$e=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?($e+1)%3:1}function Fi(n,e){let t=Se(n,e),i=Mi(e),s=n.state.selection;return{update(o){o.docChanged&&(t.pos=o.changes.mapPos(t.pos),s=s.map(o.changes))},get(o,a,u){let b=Se(n,o),x=$(n,b.pos,b.bias,i);if(t.pos!=b.pos&&!a){let M=$(n,t.pos,t.bias,i),I=Math.min(M.from,x.from),K=Math.max(M.to,x.to);x=I<x.from?w.jT.range(I,K):w.jT.range(K,I)}return a?s.replaceRange(s.main.extend(x.from,x.to)):u&&s.ranges.length>1&&s.ranges.some(M=>M.eq(x))?js(s,x):u?s.addRange(x):w.jT.create([x])}}}function js(n,e){for(let t=0;;t++)if(n.ranges[t].eq(e))return w.jT.create(n.ranges.slice(0,t).concat(n.ranges.slice(t+1)),n.mainIndex==t?0:n.mainIndex-(n.mainIndex>t?1:0))}Jt.dragstart=(n,e)=>{let{selection:{main:t}}=n.state,{mouseSelection:i}=n.inputState;i&&(i.dragging=t),e.dataTransfer&&(e.dataTransfer.setData("Text",n.state.sliceDoc(t.from,t.to)),e.dataTransfer.effectAllowed="copyMove")};function qn(n,e,t,i){if(!t)return;let s=n.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:o}=n.inputState,a=i&&o&&o.dragging&&o.dragMove?{from:o.dragging.from,to:o.dragging.to}:null,u={from:s,insert:t},b=n.state.changes(a?[a,u]:u);n.focus(),n.dispatch({changes:b,selection:{anchor:b.mapPos(s,-1),head:b.mapPos(s,1)},userEvent:a?"move.drop":"input.drop"})}Jt.drop=(n,e)=>{if(!e.dataTransfer)return;if(n.state.readOnly)return e.preventDefault();let t=e.dataTransfer.files;if(t&&t.length){e.preventDefault();let i=Array(t.length),s=0,o=()=>{++s==t.length&&qn(n,e,i.filter(a=>a!=null).join(n.state.lineBreak),!1)};for(let a=0;a<t.length;a++){let u=new FileReader;u.onerror=o,u.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(u.result)||(i[a]=u.result),o()},u.readAsText(t[a])}}else qn(n,e,e.dataTransfer.getData("Text"),!0)},Jt.paste=(n,e)=>{if(n.state.readOnly)return e.preventDefault();n.observer.flush();let t=v?null:e.clipboardData;t?(E(n,t.getData("text/plain")||t.getData("text/uri-text")),e.preventDefault()):R(n)};function zs(n,e){let t=n.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),n.focus()},50)}function _s(n){let e=[],t=[],i=!1;for(let s of n.selection.ranges)s.empty||(e.push(n.sliceDoc(s.from,s.to)),t.push(s));if(!e.length){let s=-1;for(let{from:o}of n.selection.ranges){let a=n.doc.lineAt(o);a.number>s&&(e.push(a.text),t.push({from:a.from,to:Math.min(n.doc.length,a.to+1)})),s=a.number}i=!0}return{text:e.join(n.lineBreak),ranges:t,linewise:i}}let Mn=null;Jt.copy=Jt.cut=(n,e)=>{let{text:t,ranges:i,linewise:s}=_s(n.state);if(!t&&!s)return;Mn=s?t:null;let o=v?null:e.clipboardData;o?(e.preventDefault(),o.clearData(),o.setData("text/plain",t)):zs(n,t),e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"})};const Kn=w.q6.define();function Un(n,e){let t=[];for(let i of n.facet(yt)){let s=i(n,e);s&&t.push(s)}return t?n.update({effects:t,annotations:Kn.of(!0)}):null}function Gn(n){setTimeout(()=>{let e=n.hasFocus;if(e!=n.inputState.notifiedFocused){let t=Un(n.state,e);t?n.dispatch(t):n.update([])}},10)}Jt.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),Gn(n)},Jt.blur=n=>{n.observer.clearSelectionRange(),Gn(n)},Jt.compositionstart=Jt.compositionupdate=n=>{n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0)},Jt.compositionend=n=>{n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionFirstChange=null,pe.chrome&&pe.android&&n.observer.flushSoon(),setTimeout(()=>{n.inputState.composing<0&&n.docView.compositionDeco.size&&n.update([])},50)},Jt.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()},Jt.beforeinput=(n,e)=>{var t;let i;if(pe.chrome&&pe.android&&(i=Ji.find(s=>s.inputType==e.inputType))&&(n.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let s=((t=window.visualViewport)===null||t===void 0?void 0:t.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>s+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}};const Qn=["pre-wrap","normal","pre-line","break-spaces"];class Xn{constructor(e){this.lineWrapping=e,this.doc=w.xv.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let i=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((t-e-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return Qn.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let i=0;i<e.length;i++){let s=e[i];s<0?i++:this.heightSamples[Math.floor(s*10)]||(t=!0,this.heightSamples[Math.floor(s*10)]=!0)}return t}refresh(e,t,i,s,o,a){let u=Qn.indexOf(e)>-1,b=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=u;if(this.lineWrapping=u,this.lineHeight=t,this.charWidth=i,this.textHeight=s,this.lineLength=o,b){this.heightSamples={};for(let x=0;x<a.length;x++){let M=a[x];M<0?x++:this.heightSamples[Math.floor(M*10)]=!0}}return b}}class Zn{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class Di{constructor(e,t,i,s,o){this.from=e,this.length=t,this.top=i,this.height=s,this.type=o}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(e){let t=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(e.type)?e.type:[e]);return new Di(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var Ct=function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n}(Ct||(Ct={}));const rn=.001;class ui{constructor(e,t,i=2){this.length=e,this.height=t,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,t){this.height!=t&&(Math.abs(this.height-t)>rn&&(e.heightChanged=!0),this.height=t)}replace(e,t,i){return ui.of(i)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,i,s){let o=this,a=i.doc;for(let u=s.length-1;u>=0;u--){let{fromA:b,toA:x,fromB:M,toB:I}=s[u],K=o.lineAt(b,Ct.ByPosNoHeight,i.setDoc(t),0,0),Y=K.to>=x?K:o.lineAt(x,Ct.ByPosNoHeight,i,0,0);for(I+=Y.to-x,x=Y.to;u>0&&K.from<=s[u-1].toA;)b=s[u-1].fromA,M=s[u-1].fromB,u--,b<K.from&&(K=o.lineAt(b,Ct.ByPosNoHeight,i,0,0));M+=K.from-b,b=K.from;let ae=An.build(i.setDoc(a),e,M,I);o=o.replace(b,x,ae)}return o.updateHeight(i,0)}static empty(){return new wi(0,0)}static of(e){if(e.length==1)return e[0];let t=0,i=e.length,s=0,o=0;for(;;)if(t==i)if(s>o*2){let u=e[t-1];u.break?e.splice(--t,1,u.left,null,u.right):e.splice(--t,1,u.left,u.right),i+=1+u.break,s-=u.size}else if(o>s*2){let u=e[i];u.break?e.splice(i,1,u.left,null,u.right):e.splice(i,1,u.left,u.right),i+=2+u.break,o-=u.size}else break;else if(s<o){let u=e[t++];u&&(s+=u.size)}else{let u=e[--i];u&&(o+=u.size)}let a=0;return e[t-1]==null?(a=1,t--):e[t]==null&&(a=1,i++),new $s(ui.of(e.slice(0,t)),a,ui.of(e.slice(i)))}}ui.prototype.size=1;class Yn extends ui{constructor(e,t,i){super(e,t),this.type=i}blockAt(e,t,i,s){return new Di(s,this.length,i,this.height,this.type)}lineAt(e,t,i,s,o){return this.blockAt(0,i,s,o)}forEachLine(e,t,i,s,o,a){e<=o+this.length&&t>=o&&a(this.blockAt(0,i,s,o))}updateHeight(e,t=0,i=!1,s){return s&&s.from<=t&&s.more&&this.setHeight(e,s.heights[s.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class wi extends Yn{constructor(e,t){super(e,t,Ke.Text),this.collapsed=0,this.widgetHeight=0}replace(e,t,i){let s=i[0];return i.length==1&&(s instanceof wi||s instanceof hi&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof hi?s=new wi(s.length,this.height):s.height=this.height,this.outdated||(s.outdated=!1),s):ui.of(i)}updateHeight(e,t=0,i=!1,s){return s&&s.from<=t&&s.more?this.setHeight(e,s.heights[s.index++]):(i||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class hi extends ui{constructor(e){super(e,0)}heightMetrics(e,t){let i=e.doc.lineAt(t).number,s=e.doc.lineAt(t+this.length).number,o=s-i+1,a,u=0;if(e.lineWrapping){let b=Math.min(this.height,e.lineHeight*o);a=b/o,u=(this.height-b)/(this.length-o-1)}else a=this.height/o;return{firstLine:i,lastLine:s,perLine:a,perChar:u}}blockAt(e,t,i,s){let{firstLine:o,lastLine:a,perLine:u,perChar:b}=this.heightMetrics(t,s);if(t.lineWrapping){let x=s+Math.round(Math.max(0,Math.min(1,(e-i)/this.height))*this.length),M=t.doc.lineAt(x),I=u+M.length*b,K=Math.max(i,e-I/2);return new Di(M.from,M.length,K,I,Ke.Text)}else{let x=Math.max(0,Math.min(a-o,Math.floor((e-i)/u))),{from:M,length:I}=t.doc.line(o+x);return new Di(M,I,i+u*x,u,Ke.Text)}}lineAt(e,t,i,s,o){if(t==Ct.ByHeight)return this.blockAt(e,i,s,o);if(t==Ct.ByPosNoHeight){let{from:Y,to:ae}=i.doc.lineAt(e);return new Di(Y,ae-Y,0,0,Ke.Text)}let{firstLine:a,perLine:u,perChar:b}=this.heightMetrics(i,o),x=i.doc.lineAt(e),M=u+x.length*b,I=x.number-a,K=s+u*I+b*(x.from-o-I);return new Di(x.from,x.length,Math.max(s,Math.min(K,s+this.height-M)),M,Ke.Text)}forEachLine(e,t,i,s,o,a){e=Math.max(e,o),t=Math.min(t,o+this.length);let{firstLine:u,perLine:b,perChar:x}=this.heightMetrics(i,o);for(let M=e,I=s;M<=t;){let K=i.doc.lineAt(M);if(M==e){let ae=K.number-u;I+=b*ae+x*(e-o-ae)}let Y=b+x*K.length;a(new Di(K.from,K.length,I,Y,Ke.Text)),I+=Y,M=K.to+1}}replace(e,t,i){let s=this.length-t;if(s>0){let o=i[i.length-1];o instanceof hi?i[i.length-1]=new hi(o.length+s):i.push(null,new hi(s-1))}if(e>0){let o=i[0];o instanceof hi?i[0]=new hi(e+o.length):i.unshift(new hi(e-1),null)}return ui.of(i)}decomposeLeft(e,t){t.push(new hi(e-1),null)}decomposeRight(e,t){t.push(null,new hi(this.length-e-1))}updateHeight(e,t=0,i=!1,s){let o=t+this.length;if(s&&s.from<=t+this.length&&s.more){let a=[],u=Math.max(t,s.from),b=-1;for(s.from>t&&a.push(new hi(s.from-t-1).updateHeight(e,t));u<=o&&s.more;){let M=e.doc.lineAt(u).length;a.length&&a.push(null);let I=s.heights[s.index++];b==-1?b=I:Math.abs(I-b)>=rn&&(b=-2);let K=new wi(M,I);K.outdated=!1,a.push(K),u+=M+1}u<=o&&a.push(null,new hi(o-u).updateHeight(e,u));let x=ui.of(a);return(b<0||Math.abs(x.height-this.height)>=rn||Math.abs(b-this.heightMetrics(e,t).perLine)>=rn)&&(e.heightChanged=!0),x}else(i||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class $s extends ui{constructor(e,t,i){super(e.length+t+i.length,e.height+i.height,t|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,t,i,s){let o=i+this.left.height;return e<o?this.left.blockAt(e,t,i,s):this.right.blockAt(e,t,o,s+this.left.length+this.break)}lineAt(e,t,i,s,o){let a=s+this.left.height,u=o+this.left.length+this.break,b=t==Ct.ByHeight?e<a:e<u,x=b?this.left.lineAt(e,t,i,s,o):this.right.lineAt(e,t,i,a,u);if(this.break||(b?x.to<u:x.from>u))return x;let M=t==Ct.ByPosNoHeight?Ct.ByPosNoHeight:Ct.ByPos;return b?x.join(this.right.lineAt(u,M,i,a,u)):this.left.lineAt(u,M,i,s,o).join(x)}forEachLine(e,t,i,s,o,a){let u=s+this.left.height,b=o+this.left.length+this.break;if(this.break)e<b&&this.left.forEachLine(e,t,i,s,o,a),t>=b&&this.right.forEachLine(e,t,i,u,b,a);else{let x=this.lineAt(b,Ct.ByPos,i,s,o);e<x.from&&this.left.forEachLine(e,x.from-1,i,s,o,a),x.to>=e&&x.from<=t&&a(x),t>x.to&&this.right.forEachLine(x.to+1,t,i,u,b,a)}}replace(e,t,i){let s=this.left.length+this.break;if(t<s)return this.balanced(this.left.replace(e,t,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-s,t-s,i));let o=[];e>0&&this.decomposeLeft(e,o);let a=o.length;for(let u of i)o.push(u);if(e>0&&es(o,a-1),t<this.length){let u=o.length;this.decomposeRight(t,o),es(o,u)}return ui.of(o)}decomposeLeft(e,t){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(i++,e>=i&&t.push(null)),e>i&&this.right.decomposeLeft(e-i,t)}decomposeRight(e,t){let i=this.left.length,s=i+this.break;if(e>=s)return this.right.decomposeRight(e-s,t);e<i&&this.left.decomposeRight(e,t),this.break&&e<s&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?ui.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,i=!1,s){let{left:o,right:a}=this,u=t+o.length+this.break,b=null;return s&&s.from<=t+o.length&&s.more?b=o=o.updateHeight(e,t,i,s):o.updateHeight(e,t,i),s&&s.from<=u+a.length&&s.more?b=a=a.updateHeight(e,u,i,s):a.updateHeight(e,u,i),b?this.balanced(o,a):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function es(n,e){let t,i;n[e]==null&&(t=n[e-1])instanceof hi&&(i=n[e+1])instanceof hi&&n.splice(e-1,3,new hi(t.length+1+i.length))}const Js=5;class An{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let i=Math.min(t,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof wi?s.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new wi(i-this.pos,-1)),this.writtenTo=i,t>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,i){if(e<t||i.heightRelevant){let s=i.widget?i.widget.estimatedHeight:0;s<0&&(s=this.oracle.lineHeight);let o=t-e;i.block?this.addBlock(new Yn(o,s,i.type)):(o||s>=Js)&&this.addLineDeco(s,o)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new wi(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let i=new hi(t-e);return this.oracle.doc.lineAt(e).to==t&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof wi)return e;let t=new wi(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine(),e.type==Ke.WidgetAfter&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,e.type!=Ke.WidgetBefore&&(this.covering=e)}addLineDeco(e,t){let i=this.ensureLine();i.length+=t,i.collapsed+=t,i.widgetHeight=Math.max(i.widgetHeight,e),this.writtenTo=this.pos=this.pos+t}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof wi)&&!this.isCovered?this.nodes.push(new wi(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let s of this.nodes)s instanceof wi&&s.updateHeight(this.oracle,i),i+=s?s.length:1;return this.nodes}static build(e,t,i,s){let o=new An(i,e);return w.Xs.spans(t,i,s,o,0),o.finish(i)}}function qs(n,e,t){let i=new Ks;return w.Xs.compare(n,e,t,i,0),i.changes}class Ks{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,i,s){(e<t||i&&i.heightRelevant||s&&s.heightRelevant)&&H(e,t,this.changes,5)}}function Us(n,e){let t=n.getBoundingClientRect(),i=n.ownerDocument,s=i.defaultView||window,o=Math.max(0,t.left),a=Math.min(s.innerWidth,t.right),u=Math.max(0,t.top),b=Math.min(s.innerHeight,t.bottom);for(let x=n.parentNode;x&&x!=i.body;)if(x.nodeType==1){let M=x,I=window.getComputedStyle(M);if((M.scrollHeight>M.clientHeight||M.scrollWidth>M.clientWidth)&&I.overflow!="visible"){let K=M.getBoundingClientRect();o=Math.max(o,K.left),a=Math.min(a,K.right),u=Math.max(u,K.top),b=x==n.parentNode?K.bottom:Math.min(b,K.bottom)}x=I.position=="absolute"||I.position=="fixed"?M.offsetParent:M.parentNode}else if(x.nodeType==11)x=x.host;else break;return{left:o-t.left,right:Math.max(o,a)-t.left,top:u-(t.top+e),bottom:Math.max(u,b)-(t.top+e)}}function Gs(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class Dn{constructor(e,t,i){this.from=e,this.to=t,this.size=i}static same(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++){let s=e[i],o=t[i];if(s.from!=o.from||s.to!=o.to||s.size!=o.size)return!1}return!0}draw(e){return ke.replace({widget:new Qs(this.size,e)}).range(this.from,this.to)}}class Qs extends $t{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class ts{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scaler=is,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=r.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(fi).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new Xn(t),this.stateDeco=e.facet(Zt).filter(i=>typeof i!="function"),this.heightMap=ui.empty().applyChanges(this.stateDeco,w.xv.empty,this.heightOracle.setDoc(e.doc),[new Yt(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=ke.set(this.lineGaps.map(i=>i.draw(!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let i=0;i<=1;i++){let s=i?t.head:t.anchor;if(!e.some(({from:o,to:a})=>s>=o&&s<=a)){let{from:o,to:a}=this.lineBlockAt(s);e.push(new on(o,a))}}this.viewports=e.sort((i,s)=>i.from-s.from),this.scaler=this.heightMap.height<=7e6?is:new Ys(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:Ki(e,this.scaler))})}update(e,t=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=this.state.facet(Zt).filter(x=>typeof x!="function");let s=e.changedRanges,o=Yt.extendWithRanges(s,qs(i,this.stateDeco,e?e.changes:w.as.empty(this.state.doc.length))),a=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),o),this.heightMap.height!=a&&(e.flags|=2);let u=o.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<u.from||t.range.head>u.to)||!this.viewportIsAppropriate(u))&&(u=this.getViewport(0,t));let b=!e.changes.empty||e.flags&2||u.from!=this.viewport.from||u.to!=this.viewport.to;this.viewport=u,this.updateForViewport(),b&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(Qt)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,i=window.getComputedStyle(t),s=this.heightOracle,o=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?r.RTL:r.LTR;let a=this.heightOracle.mustRefreshForWrapping(o),u=t.getBoundingClientRect(),b=a||this.mustMeasureContent||this.contentDOMHeight!=u.height;this.contentDOMHeight=u.height,this.mustMeasureContent=!1;let x=0,M=0,I=parseInt(i.paddingTop)||0,K=parseInt(i.paddingBottom)||0;(this.paddingTop!=I||this.paddingBottom!=K)&&(this.paddingTop=I,this.paddingBottom=K,x|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(s.lineWrapping&&(b=!0),this.editorWidth=e.scrollDOM.clientWidth,x|=8);let Y=(this.printing?Gs:Us)(t,this.paddingTop),ae=Y.top-this.pixelViewport.top,ue=Y.bottom-this.pixelViewport.bottom;this.pixelViewport=Y;let ce=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(ce!=this.inView&&(this.inView=ce,ce&&(b=!0)),!this.inView&&!this.scrollTarget)return 0;let ge=u.width;if((this.contentDOMWidth!=ge||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=u.width,this.editorHeight=e.scrollDOM.clientHeight,x|=8),b){let et=e.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(et)&&(a=!0),a||s.lineWrapping&&Math.abs(ge-this.contentDOMWidth)>s.charWidth){let{lineHeight:Ue,charWidth:lt,textHeight:gt}=e.docView.measureTextSize();a=Ue>0&&s.refresh(o,Ue,lt,gt,ge/lt,et),a&&(e.docView.minWidth=0,x|=8)}ae>0&&ue>0?M=Math.max(ae,ue):ae<0&&ue<0&&(M=Math.min(ae,ue)),s.heightChanged=!1;for(let Ue of this.viewports){let lt=Ue.from==this.viewport.from?et:e.docView.measureVisibleLineHeights(Ue);this.heightMap=(a?ui.empty().applyChanges(this.stateDeco,w.xv.empty,this.heightOracle,[new Yt(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(s,0,a,new Zn(Ue.from,lt))}s.heightChanged&&(x|=2)}let ze=!this.viewportIsAppropriate(this.viewport,M)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return ze&&(this.viewport=this.getViewport(M,this.scrollTarget)),this.updateForViewport(),(x&2||ze)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(a?[]:this.lineGaps,e)),x|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),x}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),s=this.heightMap,o=this.heightOracle,{visibleTop:a,visibleBottom:u}=this,b=new on(s.lineAt(a-i*1e3,Ct.ByHeight,o,0,0).from,s.lineAt(u+(1-i)*1e3,Ct.ByHeight,o,0,0).to);if(t){let{head:x}=t.range;if(x<b.from||x>b.to){let M=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),I=s.lineAt(x,Ct.ByPos,o,0,0),K;t.y=="center"?K=(I.top+I.bottom)/2-M/2:t.y=="start"||t.y=="nearest"&&x<b.from?K=I.top:K=I.bottom-M,b=new on(s.lineAt(K-1e3/2,Ct.ByHeight,o,0,0).from,s.lineAt(K+M+1e3/2,Ct.ByHeight,o,0,0).to)}}return b}mapViewport(e,t){let i=t.mapPos(e.from,-1),s=t.mapPos(e.to,1);return new on(this.heightMap.lineAt(i,Ct.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,Ct.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},i=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(e,Ct.ByPos,this.heightOracle,0,0),{bottom:o}=this.heightMap.lineAt(t,Ct.ByPos,this.heightOracle,0,0),{visibleTop:a,visibleBottom:u}=this;return(e==0||s<=a-Math.max(10,Math.min(-i,250)))&&(t==this.state.doc.length||o>=u+Math.max(10,Math.min(i,250)))&&s>a-2*1e3&&o<u+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let i=[];for(let s of e)t.touchesRange(s.from,s.to)||i.push(new Dn(t.mapPos(s.from),t.mapPos(s.to),s.size));return i}ensureLineGaps(e,t){let i=this.heightOracle.lineWrapping,s=i?1e4:2e3,o=s>>1,a=s<<1;if(this.defaultTextDirection!=r.LTR&&!i)return[];let u=[],b=(x,M,I,K)=>{if(M-x<o)return;let Y=this.state.selection.main,ae=[Y.from];Y.empty||ae.push(Y.to);for(let ce of ae)if(ce>x&&ce<M){b(x,ce-10,I,K),b(ce+10,M,I,K);return}let ue=Zs(e,ce=>ce.from>=I.from&&ce.to<=I.to&&Math.abs(ce.from-x)<o&&Math.abs(ce.to-M)<o&&!ae.some(ge=>ce.from<ge&&ce.to>ge));if(!ue){if(M<I.to&&t&&i&&t.visibleRanges.some(ce=>ce.from<=M&&ce.to>=M)){let ce=t.moveToLineBoundary(w.jT.cursor(M),!1,!0).head;ce>x&&(M=ce)}ue=new Dn(x,M,this.gapSize(I,x,M,K))}u.push(ue)};for(let x of this.viewportLines){if(x.length<a)continue;let M=Xs(x.from,x.to,this.stateDeco);if(M.total<a)continue;let I=this.scrollTarget?this.scrollTarget.range.head:null,K,Y;if(i){let ae=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,ue,ce;if(I!=null){let ge=an(M,I),ze=((this.visibleBottom-this.visibleTop)/2+ae)/x.height;ue=ge-ze,ce=ge+ze}else ue=(this.visibleTop-x.top-ae)/x.height,ce=(this.visibleBottom-x.top+ae)/x.height;K=ln(M,ue),Y=ln(M,ce)}else{let ae=M.total*this.heightOracle.charWidth,ue=s*this.heightOracle.charWidth,ce,ge;if(I!=null){let ze=an(M,I),et=((this.pixelViewport.right-this.pixelViewport.left)/2+ue)/ae;ce=ze-et,ge=ze+et}else ce=(this.pixelViewport.left-ue)/ae,ge=(this.pixelViewport.right+ue)/ae;K=ln(M,ce),Y=ln(M,ge)}K>x.from&&b(x.from,K,x,M),Y<x.to&&b(Y,x.to,x,M)}return u}gapSize(e,t,i,s){let o=an(s,i)-an(s,t);return this.heightOracle.lineWrapping?e.height*o:s.total*this.heightOracle.charWidth*o}updateLineGaps(e){Dn.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=ke.set(e.map(t=>t.draw(this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];w.Xs.spans(e,this.viewport.from,this.viewport.to,{span(s,o){t.push({from:s,to:o})},point(){}},20);let i=t.length!=this.visibleRanges.length||this.visibleRanges.some((s,o)=>s.from!=t[o].from||s.to!=t[o].to);return this.visibleRanges=t,i?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||Ki(this.heightMap.lineAt(e,Ct.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return Ki(this.heightMap.lineAt(this.scaler.fromDOM(e),Ct.ByHeight,this.heightOracle,0,0),this.scaler)}elementAtHeight(e){return Ki(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class on{constructor(e,t){this.from=e,this.to=t}}function Xs(n,e,t){let i=[],s=n,o=0;return w.Xs.spans(t,n,e,{span(){},point(a,u){a>s&&(i.push({from:s,to:a}),o+=a-s),s=u}},20),s<e&&(i.push({from:s,to:e}),o+=e-s),{total:o,ranges:i}}function ln({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let i=Math.floor(n*t);for(let s=0;;s++){let{from:o,to:a}=e[s],u=a-o;if(i<=u)return o+i;i-=u}}function an(n,e){let t=0;for(let{from:i,to:s}of n.ranges){if(e<=s){t+=e-i;break}t+=s-i}return t/n.total}function Zs(n,e){for(let t of n)if(e(t))return t}const is={toDOM(n){return n},fromDOM(n){return n},scale:1};class Ys{constructor(e,t,i){let s=0,o=0,a=0;this.viewports=i.map(({from:u,to:b})=>{let x=t.lineAt(u,Ct.ByPos,e,0,0).top,M=t.lineAt(b,Ct.ByPos,e,0,0).bottom;return s+=M-x,{from:u,to:b,top:x,bottom:M,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(t.height-s);for(let u of this.viewports)u.domTop=a+(u.top-o)*this.scale,a=u.domBottom=u.domTop+(u.bottom-u.top),o=u.bottom}toDOM(e){for(let t=0,i=0,s=0;;t++){let o=t<this.viewports.length?this.viewports[t]:null;if(!o||e<o.top)return s+(e-i)*this.scale;if(e<=o.bottom)return o.domTop+(e-o.top);i=o.bottom,s=o.domBottom}}fromDOM(e){for(let t=0,i=0,s=0;;t++){let o=t<this.viewports.length?this.viewports[t]:null;if(!o||e<o.domTop)return i+(e-s)/this.scale;if(e<=o.domBottom)return o.top+(e-o.domTop);i=o.bottom,s=o.domBottom}}}function Ki(n,e){if(e.scale==1)return n;let t=e.toDOM(n.top),i=e.toDOM(n.bottom);return new Di(n.from,n.length,t,i-t,Array.isArray(n.type)?n.type.map(s=>Ki(s,e)):n.type)}const hn=w.r$.define({combine:n=>n.join(" ")}),Tn=w.r$.define({combine:n=>n.indexOf(!0)>-1}),On=Q.V.newName(),ns=Q.V.newName(),ss=Q.V.newName(),rs={"&light":"."+ns,"&dark":"."+ss};function Pn(n,e,t){return new Q.V(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,s=>{if(s=="&")return n;if(!t||!t[s])throw new RangeError(`Unsupported selector: ${s}`);return t[s]}):n+" "+i}})}const er=Pn("."+On,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},rs);class tr{constructor(e,t,i,s){this.typeOver=s,this.bounds=null,this.text="";let{impreciseHead:o,impreciseAnchor:a}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,i,0))){let u=o||a?[]:nr(e),b=new G(u,e.state);b.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=b.text,this.newSel=sr(u,this.bounds.from)}else{let u=e.observer.selectionRange,b=o&&o.node==u.focusNode&&o.offset==u.focusOffset||!xe(e.contentDOM,u.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(u.focusNode,u.focusOffset),x=a&&a.node==u.anchorNode&&a.offset==u.anchorOffset||!xe(e.contentDOM,u.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(u.anchorNode,u.anchorOffset);this.newSel=w.jT.single(x,b)}}}function os(n,e){let t,{newSel:i}=e,s=n.state.selection.main;if(e.bounds){let{from:o,to:a}=e.bounds,u=s.from,b=null;(n.inputState.lastKeyCode===8&&n.inputState.lastKeyTime>Date.now()-100||pe.android&&e.text.length<a-o)&&(u=s.to,b="end");let x=ir(n.state.doc.sliceString(o,a,U),e.text,u-o,b);x&&(pe.chrome&&n.inputState.lastKeyCode==13&&x.toB==x.from+2&&e.text.slice(x.from,x.toB)==U+U&&x.toB--,t={from:o+x.from,to:o+x.toA,insert:w.xv.of(e.text.slice(x.from,x.toB).split(U))})}else i&&(!n.hasFocus&&n.state.facet(xi)||i.main.eq(s))&&(i=null);if(!t&&!i)return!1;if(!t&&e.typeOver&&!s.empty&&i&&i.main.empty?t={from:s.from,to:s.to,insert:n.state.doc.slice(s.from,s.to)}:t&&t.from>=s.from&&t.to<=s.to&&(t.from!=s.from||t.to!=s.to)&&s.to-s.from-(t.to-t.from)<=4?t={from:s.from,to:s.to,insert:n.state.doc.slice(s.from,t.from).append(t.insert).append(n.state.doc.slice(t.to,s.to))}:(pe.mac||pe.android)&&t&&t.from==t.to&&t.from==s.head-1&&/^\. ?$/.test(t.insert.toString())&&n.contentDOM.getAttribute("autocorrect")=="off"?(i&&t.insert.length==2&&(i=w.jT.single(i.main.anchor-1,i.main.head-1)),t={from:s.from,to:s.to,insert:w.xv.of([" "])}):pe.chrome&&t&&t.from==t.to&&t.from==s.head&&t.insert.toString()==`
 `&&n.lineWrapping&&(i&&(i=w.jT.single(i.main.anchor-1,i.main.head-1)),t={from:s.from,to:s.to,insert:w.xv.of([" "])}),t){let o=n.state;if(pe.ios&&n.inputState.flushIOSKey(n)||pe.android&&(t.from==s.from&&t.to==s.to&&t.insert.length==1&&t.insert.lines==2&&at(n.contentDOM,"Enter",13)||t.from==s.from-1&&t.to==s.to&&t.insert.length==0&&at(n.contentDOM,"Backspace",8)||t.from==s.from&&t.to==s.to+1&&t.insert.length==0&&at(n.contentDOM,"Delete",46)))return!0;let a=t.insert.toString();if(n.state.facet(ct).some(x=>x(n,t.from,t.to,a)))return!0;n.inputState.composing>=0&&n.inputState.composing++;let u;if(t.from>=s.from&&t.to<=s.to&&t.to-t.from>=(s.to-s.from)/3&&(!i||i.main.empty&&i.main.from==t.from+t.insert.length)&&n.inputState.composing<0){let x=s.from<t.from?o.sliceDoc(s.from,t.from):"",M=s.to>t.to?o.sliceDoc(t.to,s.to):"";u=o.replaceSelection(n.state.toText(x+t.insert.sliceString(0,void 0,n.state.lineBreak)+M))}else{let x=o.changes(t),M=i&&!o.selection.main.eq(i.main)&&i.main.to<=x.newLength?i.main:void 0;if(o.selection.ranges.length>1&&n.inputState.composing>=0&&t.to<=s.to&&t.to>=s.to-10){let I=n.state.sliceDoc(t.from,t.to),K=zt(n)||n.state.doc.lineAt(s.head),Y=s.to-t.to,ae=s.to-s.from;u=o.changeByRange(ue=>{if(ue.from==s.from&&ue.to==s.to)return{changes:x,range:M||ue.map(x)};let ce=ue.to-Y,ge=ce-I.length;if(ue.to-ue.from!=ae||n.state.sliceDoc(ge,ce)!=I||K&&ue.to>=K.from&&ue.from<=K.to)return{range:ue};let ze=o.changes({from:ge,to:ce,insert:t.insert}),et=ue.to-s.to;return{changes:ze,range:M?w.jT.range(Math.max(0,M.anchor+et),Math.max(0,M.head+et)):ue.map(ze)}})}else u={changes:x,selection:M&&o.selection.replaceRange(M)}}let b="input.type";return n.composing&&(b+=".compose",n.inputState.compositionFirstChange&&(b+=".start",n.inputState.compositionFirstChange=!1)),n.dispatch(u,{scrollIntoView:!0,userEvent:b}),!0}else if(i&&!i.main.eq(s)){let o=!1,a="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(o=!0),a=n.inputState.lastSelectionOrigin),n.dispatch({selection:i,scrollIntoView:o,userEvent:a}),!0}else return!1}function ir(n,e,t,i){let s=Math.min(n.length,e.length),o=0;for(;o<s&&n.charCodeAt(o)==e.charCodeAt(o);)o++;if(o==s&&n.length==e.length)return null;let a=n.length,u=e.length;for(;a>0&&u>0&&n.charCodeAt(a-1)==e.charCodeAt(u-1);)a--,u--;if(i=="end"){let b=Math.max(0,o-Math.min(a,u));t-=a+b-o}if(a<o&&n.length<e.length){let b=t<=o&&t>=a?o-t:0;o-=b,u=o+(u-a),a=o}else if(u<o){let b=t<=o&&t>=u?o-t:0;o-=b,a=o+(a-u),u=o}return{from:o,toA:a,toB:u}}function nr(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:i,focusNode:s,focusOffset:o}=n.observer.selectionRange;return t&&(e.push(new be(t,i)),(s!=t||o!=i)&&e.push(new be(s,o))),e}function sr(n,e){if(n.length==0)return null;let t=n[0].pos,i=n.length==2?n[1].pos:t;return t>-1&&i>-1?w.jT.single(t+e,i+e):null}const rr={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Bn=pe.ie&&pe.ie_version<=11;class or{constructor(e){this.view=e,this.active=!1,this.selectionRange=new ni,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.resizeContent=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let i of t)this.queue.push(i);(pe.ie&&pe.ie_version<=11||pe.ios&&e.composing)&&t.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),Bn&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM),this.resizeContent=new ResizeObserver(()=>this.view.requestMeasure()),this.resizeContent.observe(e.contentDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runScrollHandlers(this.view,e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,i)=>t!=e[i]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,s=this.selectionRange;if(i.state.facet(xi)?i.root.activeElement!=this.dom:!Ze(i.dom,s))return;let o=s.anchorNode&&i.docView.nearest(s.anchorNode);if(o&&o.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(pe.ie&&pe.ie_version<=11||pe.android&&pe.chrome)&&!i.state.selection.main.empty&&s.focusNode&&Rt(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=pe.safari&&e.root.nodeType==11&&Xe(this.dom.ownerDocument)==this.dom&&lr(this.view)||me(e.root);if(!t||this.selectionRange.eq(t))return!1;let i=Ze(this.dom,t);return i&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&Je(this.dom,t)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(t),i&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let i=this.dom;i;)if(i.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=t)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,rr),Bn&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Bn&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var i;if(!this.delayedAndroidKey){let s=()=>{let o=this.delayedAndroidKey;o&&(this.clearDelayedAndroidKey(),!this.flush()&&o.force&&at(this.dom,o.key,o.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}processRecords(){let e=this.queue;for(let o of this.observer.takeRecords())e.push(o);e.length&&(this.queue=[]);let t=-1,i=-1,s=!1;for(let o of e){let a=this.readMutation(o);a&&(a.typeOver&&(s=!0),t==-1?{from:t,to:i}=a:(t=Math.min(a.from,t),i=Math.max(a.to,i)))}return{from:t,to:i,typeOver:s}}readChange(){let{from:e,to:t,typeOver:i}=this.processRecords(),s=this.selectionChanged&&Ze(this.dom,this.selectionRange);return e<0&&!s?null:(e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1,new tr(this.view,e,t,i))}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return!1;let i=this.view.state,s=os(this.view,t);return this.view.state==i&&this.view.update([]),s}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.dirty|=4),e.type=="childList"){let i=ls(t,e.previousSibling||e.target.previousSibling,-1),s=ls(t,e.nextSibling||e.target.nextSibling,1);return{from:i?t.posAfter(i):t.posAtStart,to:s?t.posBefore(s):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,t,i,s;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect(),(s=this.resizeContent)===null||s===void 0||s.disconnect();for(let o of this.scrollTargets)o.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function ls(n,e,t){for(;e;){let i=Ne.get(e);if(i&&i.parent==n)return i;let s=e.parentNode;e=s!=n.dom?s:t>0?e.nextSibling:e.previousSibling}return null}function lr(n){let e=null;function t(b){b.preventDefault(),b.stopImmediatePropagation(),e=b.getTargetRanges()[0]}if(n.contentDOM.addEventListener("beforeinput",t,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",t,!0),!e)return null;let i=e.startContainer,s=e.startOffset,o=e.endContainer,a=e.endOffset,u=n.docView.domAtPos(n.state.selection.main.anchor);return Rt(u.node,u.offset,o,a)&&([i,s,o,a]=[o,a,i,s]),{anchorNode:i,anchorOffset:s,focusNode:o,focusOffset:a}}class ut{constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: fixed; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=e.dispatch||(t=>this.update([t])),this.dispatch=this.dispatch.bind(this),this._root=e.root||Ot(e.parent)||document,this.viewState=new ts(e.state||w.yy.create(e)),this.plugins=this.state.facet(Xt).map(t=>new ai(t));for(let t of this.plugins)t.update(this);this.observer=new or(this),this.inputState=new kn(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new Ce(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),e.parent&&e.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}dispatch(...e){this._dispatch(e.length==1&&e[0]instanceof w.YW?e[0]:this.state.update(...e))}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,i=!1,s,o=this.state;for(let K of e){if(K.startState!=o)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");o=K.state}if(this.destroyed){this.viewState.state=o;return}let a=this.hasFocus,u=0,b=null;e.some(K=>K.annotation(Kn))?(this.inputState.notifiedFocused=a,u=1):a!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=a,b=Un(o,a),b||(u=1));let x=this.observer.delayedAndroidKey,M=null;if(x?(this.observer.clearDelayedAndroidKey(),M=this.observer.readChange(),(M&&!this.state.doc.eq(o.doc)||!this.state.selection.eq(o.selection))&&(M=null)):this.observer.clear(),o.facet(w.yy.phrases)!=this.state.facet(w.yy.phrases))return this.setState(o);s=D.create(this,o,e),s.flags|=u;let I=this.viewState.scrollTarget;try{this.updateState=2;for(let K of e){if(I&&(I=I.map(K.changes)),K.scrollIntoView){let{main:Y}=K.state.selection;I=new St(Y.empty?Y:w.jT.cursor(Y.head,Y.head>Y.anchor?-1:1))}for(let Y of K.effects)Y.is(Si)&&(I=Y.value)}this.viewState.update(s,I),this.bidiCache=cn.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),t=this.docView.update(s),this.state.facet(ki)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(K=>K.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(hn)!=s.state.facet(hn)&&(this.viewState.mustMeasureContent=!0),(t||i||I||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!s.empty)for(let K of this.state.facet(ot))K(s);(b||M)&&Promise.resolve().then(()=>{b&&this.state==b.startState&&this.dispatch(b),M&&!os(this,M)&&x.force&&at(this.contentDOM,x.key,x.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new ts(e),this.plugins=e.facet(Xt).map(i=>new ai(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView=new Ce(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(Xt),i=e.state.facet(Xt);if(t!=i){let s=[];for(let o of i){let a=t.indexOf(o);if(a<0)s.push(new ai(o));else{let u=this.plugins[a];u.mustUpdate=e,s.push(u)}}for(let o of this.plugins)o.mustUpdate!=e&&o.destroy(this);this.plugins=s,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let s of this.plugins)s.mustUpdate=e;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this)}measure(e=!0){if(this.destroyed)return;this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,{scrollHeight:i,scrollTop:s,clientHeight:o}=this.scrollDOM,a=s>i-o-4?i:s;try{for(let u=0;;u++){this.updateState=1;let b=this.viewport,x=this.viewState.lineBlockAtHeight(a),M=this.viewState.measure(this);if(!M&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(u>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let I=[];M&4||([this.measureRequests,I]=[I,this.measureRequests]);let K=I.map(ce=>{try{return ce.read(this)}catch(ge){return Ht(this.state,ge),as}}),Y=D.create(this,this.state,[]),ae=!1,ue=!1;Y.flags|=M,t?t.flags|=M:t=Y,this.updateState=2,Y.empty||(this.updatePlugins(Y),this.inputState.update(Y),this.updateAttrs(),ae=this.docView.update(Y));for(let ce=0;ce<I.length;ce++)if(K[ce]!=as)try{let ge=I[ce];ge.write&&ge.write(K[ce],this)}catch(ge){Ht(this.state,ge)}if(this.viewState.editorHeight)if(this.viewState.scrollTarget)this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,ue=!0;else{let ce=this.viewState.lineBlockAt(x.from).top-x.top;(ce>1||ce<-1)&&(this.scrollDOM.scrollTop+=ce,ue=!0)}if(ae&&this.docView.updateSelection(!0),this.viewport.from==b.from&&this.viewport.to==b.to&&!ue&&this.measureRequests.length==0)break}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let u of this.state.facet(ot))u(t)}get themeClasses(){return On+" "+(this.state.facet(Tn)?ss:ns)+" "+this.state.facet(hn)}updateAttrs(){let e=hs(this,vi,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(xi)?"true":"false",class:"cm-content",style:`${pe.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),hs(this,fi,t);let i=this.observer.ignore(()=>{let s=qt(this.contentDOM,this.contentAttrs,t),o=qt(this.dom,this.editorAttrs,e);return s||o});return this.editorAttrs=e,this.contentAttrs=t,i}showAnnouncements(e){let t=!0;for(let i of e)for(let s of i.effects)if(s.is(ut.announce)){t&&(this.announceDOM.textContent=""),t=!1;let o=this.announceDOM.appendChild(document.createElement("div"));o.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(ki),Q.V.mount(this.root,this.styleModules.concat(er).reverse())}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(i=>i.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,i){return $i(this,e,en(this,e,t,i))}moveByGroup(e,t){return $i(this,e,en(this,e,t,i=>$n(this,e.head,i)))}moveToLineBoundary(e,t,i=!0){return Wi(this,e,t,i)}moveVertically(e,t,i){return $i(this,e,vn(this,e,t,i))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),Ut(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let i=this.docView.coordsAt(e,t);if(!i||i.left==i.right)return i;let s=this.state.doc.lineAt(e),o=this.bidiSpans(s),a=o[y.find(o,e-s.from,-1,t)];return It(i,a.dir==r.LTR==t>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(li)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>ar)return T(e.length);let t=this.textDirectionAt(e.from);for(let s of this.bidiCache)if(s.from==e.from&&s.dir==t)return s.order;let i=g(e.text,t);return this.bidiCache.push(new cn(e.from,e.to,t,i)),i}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||pe.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{bt(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return Si.of(new St(typeof e=="number"?w.jT.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}static domEventHandlers(e){return mt.define(()=>({}),{eventHandlers:e})}static theme(e,t){let i=Q.V.newName(),s=[hn.of(i),ki.of(Pn(`.${i}`,e))];return t&&t.dark&&s.push(Tn.of(!0)),s}static baseTheme(e){return w.Wl.lowest(ki.of(Pn("."+On,e,rs)))}static findFromDOM(e){var t;let i=e.querySelector(".cm-content"),s=i&&Ne.get(i)||Ne.get(e);return((t=s==null?void 0:s.rootView)===null||t===void 0?void 0:t.view)||null}}ut.styleModule=ki,ut.inputHandler=ct,ut.focusChangeEffect=yt,ut.perLineTextDirection=li,ut.exceptionSink=De,ut.updateListener=ot,ut.editable=xi,ut.mouseSelectionStyle=Me,ut.dragMovesSelection=we,ut.clickAddsSelectionRange=ye,ut.decorations=Zt,ut.atomicRanges=yi,ut.scrollMargins=Ai,ut.darkTheme=Tn,ut.contentAttributes=fi,ut.editorAttributes=vi,ut.lineWrapping=ut.contentAttributes.of({class:"cm-lineWrapping"}),ut.announce=w.Py.define();const ar=4096,as={};class cn{constructor(e,t,i,s){this.from=e,this.to=t,this.dir=i,this.order=s}static update(e,t){if(t.empty)return e;let i=[],s=e.length?e[e.length-1].dir:r.LTR;for(let o=Math.max(0,e.length-10);o<e.length;o++){let a=e[o];a.dir==s&&!t.touchesRange(a.from,a.to)&&i.push(new cn(t.mapPos(a.from,1),t.mapPos(a.to,-1),a.dir,a.order))}return i}}function hs(n,e,t){for(let i=n.state.facet(e),s=i.length-1;s>=0;s--){let o=i[s],a=typeof o=="function"?o(n):o;a&&Ft(a,t)}return t}const hr=pe.mac?"mac":pe.windows?"win":pe.linux?"linux":"key";function cr(n,e){const t=n.split(/-(?!$)/);let i=t[t.length-1];i=="Space"&&(i=" ");let s,o,a,u;for(let b=0;b<t.length-1;++b){const x=t[b];if(/^(cmd|meta|m)$/i.test(x))u=!0;else if(/^a(lt)?$/i.test(x))s=!0;else if(/^(c|ctrl|control)$/i.test(x))o=!0;else if(/^s(hift)?$/i.test(x))a=!0;else if(/^mod$/i.test(x))e=="mac"?u=!0:o=!0;else throw new Error("Unrecognized modifier name: "+x)}return s&&(i="Alt-"+i),o&&(i="Ctrl-"+i),u&&(i="Meta-"+i),a&&(i="Shift-"+i),i}function fn(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}const fr=w.Wl.default(ut.domEventHandlers({keydown(n,e){return ds(us(e.state),n,e,"editor")}})),cs=w.r$.define({enables:fr}),fs=new WeakMap;function us(n){let e=n.facet(cs),t=fs.get(e);return t||fs.set(e,t=pr(e.reduce((i,s)=>i.concat(s),[]))),t}function ur(n,e,t){return ds(us(n.state),e,n,t)}let Bi=null;const dr=4e3;function pr(n,e=hr){let t=Object.create(null),i=Object.create(null),s=(a,u)=>{let b=i[a];if(b==null)i[a]=u;else if(b!=u)throw new Error("Key binding "+a+" is used both as a regular binding and as a multi-stroke prefix")},o=(a,u,b,x)=>{var M,I;let K=t[a]||(t[a]=Object.create(null)),Y=u.split(/ (?!$)/).map(ce=>cr(ce,e));for(let ce=1;ce<Y.length;ce++){let ge=Y.slice(0,ce).join(" ");s(ge,!0),K[ge]||(K[ge]={preventDefault:!0,run:[ze=>{let et=Bi={view:ze,prefix:ge,scope:a};return setTimeout(()=>{Bi==et&&(Bi=null)},dr),!0}]})}let ae=Y.join(" ");s(ae,!1);let ue=K[ae]||(K[ae]={preventDefault:!1,run:((I=(M=K._any)===null||M===void 0?void 0:M.run)===null||I===void 0?void 0:I.slice())||[]});b&&ue.run.push(b),x&&(ue.preventDefault=!0)};for(let a of n){let u=a.scope?a.scope.split(" "):["editor"];if(a.any)for(let x of u){let M=t[x]||(t[x]=Object.create(null));M._any||(M._any={preventDefault:!1,run:[]});for(let I in M)M[I].run.push(a.any)}let b=a[e]||a.key;if(b)for(let x of u)o(x,b,a.run,a.preventDefault),a.shift&&o(x,"Shift-"+b,a.shift,a.preventDefault)}return t}function ds(n,e,t,i){let s=(0,Z.YG)(e),o=(0,w.gm)(s,0),a=(0,w.nZ)(o)==s.length&&s!=" ",u="",b=!1;Bi&&Bi.view==t&&Bi.scope==i&&(u=Bi.prefix+" ",(b=tn.indexOf(e.keyCode)<0)&&(Bi=null));let x=new Set,M=ae=>{if(ae){for(let ue of ae.run)if(!x.has(ue)&&(x.add(ue),ue(t,e)))return!0;ae.preventDefault&&(b=!0)}return!1},I=n[i],K,Y;if(I){if(M(I[u+fn(s,e,!a)]))return!0;if(a&&(e.altKey||e.metaKey||e.ctrlKey)&&!(pe.windows&&e.ctrlKey&&e.altKey)&&(K=Z.ue[e.keyCode])&&K!=s){if(M(I[u+fn(K,e,!0)]))return!0;if(e.shiftKey&&(Y=Z.uY[e.keyCode])!=s&&Y!=K&&M(I[u+fn(Y,e,!1)]))return!0}else if(a&&e.shiftKey&&M(I[u+fn(s,e,!0)]))return!0;if(M(I._any))return!0}return b}class Ui{constructor(e,t,i,s,o){this.className=e,this.left=t,this.top=i,this.width=s,this.height=o}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,i){if(i.empty){let s=e.coordsAtPos(i.head,i.assoc||1);if(!s)return[];let o=ps(e);return[new Ui(t,s.left-o.left,s.top-o.top,null,s.bottom-s.top)]}else return mr(e,t,i)}}function ps(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==r.LTR?e.left:e.right-n.scrollDOM.clientWidth)-n.scrollDOM.scrollLeft,top:e.top-n.scrollDOM.scrollTop}}function ms(n,e,t){let i=w.jT.cursor(e);return{from:Math.max(t.from,n.moveToLineBoundary(i,!1,!0).from),to:Math.min(t.to,n.moveToLineBoundary(i,!0,!0).from),type:Ke.Text}}function gs(n,e){let t=n.lineBlockAt(e);if(Array.isArray(t.type)){for(let i of t.type)if(i.to>e||i.to==e&&(i.to==t.to||i.type==Ke.Text))return i}return t}function mr(n,e,t){if(t.to<=n.viewport.from||t.from>=n.viewport.to)return[];let i=Math.max(t.from,n.viewport.from),s=Math.min(t.to,n.viewport.to),o=n.textDirection==r.LTR,a=n.contentDOM,u=a.getBoundingClientRect(),b=ps(n),x=a.querySelector(".cm-line"),M=x&&window.getComputedStyle(x),I=u.left+(M?parseInt(M.paddingLeft)+Math.min(0,parseInt(M.textIndent)):0),K=u.right-(M?parseInt(M.paddingRight):0),Y=gs(n,i),ae=gs(n,s),ue=Y.type==Ke.Text?Y:null,ce=ae.type==Ke.Text?ae:null;if(n.lineWrapping&&(ue&&(ue=ms(n,i,ue)),ce&&(ce=ms(n,s,ce))),ue&&ce&&ue.from==ce.from)return ze(et(t.from,t.to,ue));{let lt=ue?et(t.from,null,ue):Ue(Y,!1),gt=ce?et(null,t.to,ce):Ue(ae,!0),di=[];return(ue||Y).to<(ce||ae).from-1?di.push(ge(I,lt.bottom,K,gt.top)):lt.bottom<gt.top&&n.elementAtHeight((lt.bottom+gt.top)/2).type==Ke.Text&&(lt.bottom=gt.top=(lt.bottom+gt.top)/2),ze(lt).concat(di).concat(ze(gt))}function ge(lt,gt,di,Ei){return new Ui(e,lt-b.left,gt-b.top-.01,di-lt,Ei-gt+.01)}function ze({top:lt,bottom:gt,horizontal:di}){let Ei=[];for(let Li=0;Li<di.length;Li+=2)Ei.push(ge(di[Li],lt,di[Li+1],gt));return Ei}function et(lt,gt,di){let Ei=1e9,Li=-1e9,bn=[];function Hs(Vi,Ri,zi,Hi,Yi){let Ii=n.coordsAtPos(Vi,Vi==di.to?-2:2),Ni=n.coordsAtPos(zi,zi==di.from?2:-2);Ei=Math.min(Ii.top,Ni.top,Ei),Li=Math.max(Ii.bottom,Ni.bottom,Li),Yi==r.LTR?bn.push(o&&Ri?I:Ii.left,o&&Hi?K:Ni.right):bn.push(!o&&Hi?I:Ni.left,!o&&Ri?K:Ii.right)}let wn=lt!=null?lt:di.from,xn=gt!=null?gt:di.to;for(let Vi of n.visibleRanges)if(Vi.to>wn&&Vi.from<xn)for(let Ri=Math.max(Vi.from,wn),zi=Math.min(Vi.to,xn);;){let Hi=n.state.doc.lineAt(Ri);for(let Yi of n.bidiSpans(Hi)){let Ii=Yi.from+Hi.from,Ni=Yi.to+Hi.from;if(Ii>=zi)break;Ni>Ri&&Hs(Math.max(Ii,Ri),lt==null&&Ii<=wn,Math.min(Ni,zi),gt==null&&Ni>=xn,Yi.dir)}if(Ri=Hi.to+1,Ri>=zi)break}return bn.length==0&&Hs(wn,lt==null,xn,gt==null,n.textDirection),{top:Ei,bottom:Li,horizontal:bn}}function Ue(lt,gt){let di=u.top+(gt?lt.top:lt.bottom);return{top:di,bottom:di,horizontal:[]}}}function gr(n,e){return n.constructor==e.constructor&&n.eq(e)}class yr{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(un)!=e.state.facet(un)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&e.view.requestMeasure(this.measureReq)}setOrder(e){let t=0,i=e.facet(un);for(;t<i.length&&i[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}draw(e){if(e.length!=this.drawn.length||e.some((t,i)=>!gr(t,this.drawn[i]))){let t=this.dom.firstChild,i=0;for(let s of e)s.update&&t&&s.constructor&&this.drawn[i].constructor&&s.update(t,this.drawn[i])?(t=t.nextSibling,i++):this.dom.insertBefore(s.draw(),t);for(;t;){let s=t.nextSibling;t.remove(),t=s}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const un=w.r$.define();function ys(n){return[mt.define(e=>new yr(e,n)),un.of(n)]}const bs=!pe.ios,Gi=w.r$.define({combine(n){return(0,w.BO)(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function br(n={}){return[Gi.of(n),wr,xr,vr,Qt.of(!0)]}function ws(n){return n.startState.facet(Gi)!=n.state.facet(Gi)}const wr=ys({above:!0,markers(n){let{state:e}=n,t=e.facet(Gi),i=[];for(let s of e.selection.ranges){let o=s==e.selection.main;if(s.empty?!o||bs:t.drawRangeCursor){let a=o?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",u=s.empty?s:w.jT.cursor(s.head,s.head>s.anchor?-1:1);for(let b of Ui.forRange(n,a,u))i.push(b)}}return i},update(n,e){n.transactions.some(i=>i.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=ws(n);return t&&xs(n.state,e),n.docChanged||n.selectionSet||t},mount(n,e){xs(e.state,n)},class:"cm-cursorLayer"});function xs(n,e){e.style.animationDuration=n.facet(Gi).cursorBlinkRate+"ms"}const xr=ys({above:!1,markers(n){return n.state.selection.ranges.map(e=>e.empty?[]:Ui.forRange(n,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(n,e){return n.docChanged||n.selectionSet||n.viewportChanged||ws(n)},class:"cm-selectionLayer"}),vs={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};bs&&(vs[".cm-line"].caretColor="transparent !important");const vr=w.Wl.highest(ut.theme(vs)),ks=w.Py.define({map(n,e){return n==null?null:e.mapPos(n)}}),Qi=w.QQ.define({create(){return null},update(n,e){return n!=null&&(n=e.changes.mapPos(n)),e.effects.reduce((t,i)=>i.is(ks)?i.value:t,n)}}),kr=mt.fromClass(class{constructor(n){this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(n){var e;let t=n.state.field(Qi);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(Qi)!=t||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let n=this.view.state.field(Qi),e=n!=null&&this.view.coordsAtPos(n);if(!e)return null;let t=this.view.scrollDOM.getBoundingClientRect();return{left:e.left-t.left+this.view.scrollDOM.scrollLeft,top:e.top-t.top+this.view.scrollDOM.scrollTop,height:e.bottom-e.top}}drawCursor(n){this.cursor&&(n?(this.cursor.style.left=n.left+"px",this.cursor.style.top=n.top+"px",this.cursor.style.height=n.height+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(n){this.view.state.field(Qi)!=n&&this.view.dispatch({effects:ks.of(n)})}},{eventHandlers:{dragover(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave(n){(n.target==this.view.contentDOM||!this.view.contentDOM.contains(n.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function Sr(){return[Qi,kr]}function Ss(n,e,t,i,s){e.lastIndex=0;for(let o=n.iterRange(t,i),a=t,u;!o.next().done;a+=o.value.length)if(!o.lineBreak)for(;u=e.exec(o.value);)s(a+u.index,u)}function Cr(n,e){let t=n.visibleRanges;if(t.length==1&&t[0].from==n.viewport.from&&t[0].to==n.viewport.to)return t;let i=[];for(let{from:s,to:o}of t)s=Math.max(n.state.doc.lineAt(s).from,s-e),o=Math.min(n.state.doc.lineAt(o).to,o+e),i.length&&i[i.length-1].to>=s?i[i.length-1].to=o:i.push({from:s,to:o});return i}class En{constructor(e){const{regexp:t,decoration:i,decorate:s,boundary:o,maxLength:a=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,s)this.addMatch=(u,b,x,M)=>s(M,x,x+u[0].length,u,b);else if(typeof i=="function")this.addMatch=(u,b,x,M)=>{let I=i(u,b,x);I&&M(x,x+u[0].length,I)};else if(i)this.addMatch=(u,b,x,M)=>M(x,x+u[0].length,i);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=o,this.maxLength=a}createDeco(e){let t=new w.f_,i=t.add.bind(t);for(let{from:s,to:o}of Cr(e,this.maxLength))Ss(e.state.doc,this.regexp,s,o,(a,u)=>this.addMatch(u,e,a,i));return t.finish()}updateDeco(e,t){let i=1e9,s=-1;return e.docChanged&&e.changes.iterChanges((o,a,u,b)=>{b>e.view.viewport.from&&u<e.view.viewport.to&&(i=Math.min(u,i),s=Math.max(b,s))}),e.viewportChanged||s-i>1e3?this.createDeco(e.view):s>-1?this.updateRange(e.view,t.map(e.changes),i,s):t}updateRange(e,t,i,s){for(let o of e.visibleRanges){let a=Math.max(o.from,i),u=Math.min(o.to,s);if(u>a){let b=e.state.doc.lineAt(a),x=b.to<u?e.state.doc.lineAt(u):b,M=Math.max(o.from,b.from),I=Math.min(o.to,x.to);if(this.boundary){for(;a>b.from;a--)if(this.boundary.test(b.text[a-1-b.from])){M=a;break}for(;u<x.to;u++)if(this.boundary.test(x.text[u-x.from])){I=u;break}}let K=[],Y,ae=(ue,ce,ge)=>K.push(ge.range(ue,ce));if(b==x)for(this.regexp.lastIndex=M-b.from;(Y=this.regexp.exec(b.text))&&Y.index<I-b.from;)this.addMatch(Y,e,Y.index+b.from,ae);else Ss(e.state.doc,this.regexp,M,I,(ue,ce)=>this.addMatch(ce,e,ue,ae));t=t.update({filterFrom:M,filterTo:I,filter:(ue,ce)=>ue<M||ce>I,add:K})}}return t}}const Ln=/x/.unicode!=null?"gu":"g",Mr=new RegExp(`[\0-\b
-\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\u2066\u2067\u2069\uFEFF\uFFF9-\uFFFC]`,Ln),Ar={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let Rn=null;function Dr(){var n;if(Rn==null&&typeof document!="undefined"&&document.body){let e=document.body.style;Rn=((n=e.tabSize)!==null&&n!==void 0?n:e.MozTabSize)!=null}return Rn||!1}const dn=w.r$.define({combine(n){let e=(0,w.BO)(n,{render:null,specialChars:Mr,addSpecialChars:null});return(e.replaceTabs=!Dr())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,Ln)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Ln)),e}});function Tr(n={}){return[dn.of(n),Or()]}let Cs=null;function Or(){return Cs||(Cs=mt.fromClass(class{constructor(n){this.view=n,this.decorations=ke.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(dn)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new En({regexp:n.specialChars,decoration:(e,t,i)=>{let{doc:s}=t.state,o=(0,w.gm)(e[0],0);if(o==9){let a=s.lineAt(i),u=t.state.tabSize,b=(0,w.IS)(a.text,u,i-a.from);return ke.replace({widget:new Lr((u-b%u)*this.view.defaultCharacterWidth)})}return this.decorationCache[o]||(this.decorationCache[o]=ke.replace({widget:new Er(n,o)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let e=n.state.facet(dn);n.startState.facet(dn)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))}const Pr="\u2022";function Br(n){return n>=32?Pr:n==10?"\u2424":String.fromCharCode(9216+n)}class Er extends $t{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=Br(this.code),i=e.state.phrase("Control character")+" "+(Ar[this.code]||"0x"+this.code.toString(16)),s=this.options.render&&this.options.render(this.code,i,t);if(s)return s;let o=document.createElement("span");return o.textContent=t,o.title=i,o.setAttribute("aria-label",i),o.className="cm-specialChar",o}ignoreEvent(){return!1}}class Lr extends $t{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}const Ms=null;function yo(){return[Ms,fi.of(n=>{var e;return((e=n.plugin(Ms))===null||e===void 0?void 0:e.attrs)||null})]}function Rr(){return Nr}const Ir=ke.line({class:"cm-activeLine"}),Nr=mt.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=-1,t=[];for(let i of n.state.selection.ranges){let s=n.lineBlockAt(i.head);s.from>e&&(t.push(Ir.range(s.from)),e=s.from)}return ke.set(t)}},{decorations:n=>n.decorations});class Wr extends $t{constructor(e){super(),this.content=e}toDOM(){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild(typeof this.content=="string"?document.createTextNode(this.content):this.content),typeof this.content=="string"?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}ignoreEvent(){return!1}}function Fr(n){return mt.fromClass(class{constructor(e){this.view=e,this.placeholder=ke.set([ke.widget({widget:new Wr(n),side:1}).range(0)])}get decorations(){return this.view.state.doc.length?ke.none:this.placeholder}},{decorations:e=>e.decorations})}const In=2e3;function Vr(n,e,t){let i=Math.min(e.line,t.line),s=Math.max(e.line,t.line),o=[];if(e.off>In||t.off>In||e.col<0||t.col<0){let a=Math.min(e.off,t.off),u=Math.max(e.off,t.off);for(let b=i;b<=s;b++){let x=n.doc.line(b);x.length<=u&&o.push(w.jT.range(x.from+a,x.to+u))}}else{let a=Math.min(e.col,t.col),u=Math.max(e.col,t.col);for(let b=i;b<=s;b++){let x=n.doc.line(b),M=(0,w.Gz)(x.text,a,n.tabSize,!0);if(M<0)o.push(w.jT.cursor(x.to));else{let I=(0,w.Gz)(x.text,u,n.tabSize);o.push(w.jT.range(x.from+M,x.from+I))}}}return o}function Hr(n,e){let t=n.coordsAtPos(n.viewport.from);return t?Math.round(Math.abs((t.left-e)/n.defaultCharacterWidth)):-1}function As(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1),i=n.state.doc.lineAt(t),s=t-i.from,o=s>In?-1:s==i.length?Hr(n,e.clientX):(0,w.IS)(i.text,n.state.tabSize,t-i.from);return{line:i.number,col:o,off:s}}function jr(n,e){let t=As(n,e),i=n.state.selection;return t?{update(s){if(s.docChanged){let o=s.changes.mapPos(s.startState.doc.line(t.line).from),a=s.state.doc.lineAt(o);t={line:a.number,col:t.col,off:Math.min(t.off,a.length)},i=i.map(s.changes)}},get(s,o,a){let u=As(n,s);if(!u)return i;let b=Vr(n.state,t,u);return b.length?a?w.jT.create(b.concat(i.ranges)):w.jT.create(b):i}}:null}function zr(n){let e=(n==null?void 0:n.eventFilter)||(t=>t.altKey&&t.button==0);return ut.mouseSelectionStyle.of((t,i)=>e(i)?jr(t,i):null)}const _r={Alt:[18,n=>n.altKey],Control:[17,n=>n.ctrlKey],Shift:[16,n=>n.shiftKey],Meta:[91,n=>n.metaKey]},$r={style:"cursor: crosshair"};function Jr(n={}){let[e,t]=_r[n.key||"Alt"],i=mt.fromClass(class{constructor(s){this.view=s,this.isDown=!1}set(s){this.isDown!=s&&(this.isDown=s,this.view.update([]))}},{eventHandlers:{keydown(s){this.set(s.keyCode==e||t(s))},keyup(s){(s.keyCode==e||!t(s))&&this.set(!1)},mousemove(s){this.set(t(s))}}});return[i,ut.contentAttributes.of(s=>{var o;return!((o=s.plugin(i))===null||o===void 0)&&o.isDown?$r:null})]}const pn="-10000px";class Ds{constructor(e,t,i){this.facet=t,this.createTooltipView=i,this.input=e.state.facet(t),this.tooltips=this.input.filter(s=>s),this.tooltipViews=this.tooltips.map(i)}update(e){var t;let i=e.state.facet(this.facet),s=i.filter(a=>a);if(i===this.input){for(let a of this.tooltipViews)a.update&&a.update(e);return!1}let o=[];for(let a=0;a<s.length;a++){let u=s[a],b=-1;if(u){for(let x=0;x<this.tooltips.length;x++){let M=this.tooltips[x];M&&M.create==u.create&&(b=x)}if(b<0)o[a]=this.createTooltipView(u);else{let x=o[a]=this.tooltipViews[b];x.update&&x.update(e)}}}for(let a of this.tooltipViews)o.indexOf(a)<0&&(a.dom.remove(),(t=a.destroy)===null||t===void 0||t.call(a));return this.input=i,this.tooltips=s,this.tooltipViews=o,!0}}function bo(n={}){return mn.of(n)}function qr(n){let{win:e}=n;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const mn=w.r$.define({combine:n=>{var e,t,i;return{position:pe.ios?"absolute":((e=n.find(s=>s.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=n.find(s=>s.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((i=n.find(s=>s.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||qr}}}),Ts=new WeakMap,Nn=mt.fromClass(class{constructor(n){this.view=n,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let e=n.state.facet(mn);this.position=e.position,this.parent=e.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new Ds(n,Wn,t=>this.createTooltip(t)),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),n.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let n of this.manager.tooltipViews)this.intersectionObserver.observe(n.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(n){n.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(n);e&&this.observeIntersection();let t=e||n.geometryChanged,i=n.state.facet(mn);if(i.position!=this.position){this.position=i.position;for(let s of this.manager.tooltipViews)s.dom.style.position=this.position;t=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let s of this.manager.tooltipViews)this.container.appendChild(s.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(n){let e=n.create(this.view);if(e.dom.classList.add("cm-tooltip"),n.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",e.dom.appendChild(t)}return e.dom.style.position=this.position,e.dom.style.top=pn,this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var n,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let t of this.manager.tooltipViews)t.dom.remove(),(n=t.destroy)===null||n===void 0||n.call(t);(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let n=this.view.dom.getBoundingClientRect();return{editor:n,parent:this.parent?this.container.getBoundingClientRect():n,pos:this.manager.tooltips.map((e,t)=>{let i=this.manager.tooltipViews[t];return i.getCoords?i.getCoords(e.pos):this.view.coordsAtPos(e.pos)}),size:this.manager.tooltipViews.map(({dom:e})=>e.getBoundingClientRect()),space:this.view.state.facet(mn).tooltipSpace(this.view)}}writeMeasure(n){var e;let{editor:t,space:i}=n,s=[];for(let o=0;o<this.manager.tooltips.length;o++){let a=this.manager.tooltips[o],u=this.manager.tooltipViews[o],{dom:b}=u,x=n.pos[o],M=n.size[o];if(!x||x.bottom<=Math.max(t.top,i.top)||x.top>=Math.min(t.bottom,i.bottom)||x.right<Math.max(t.left,i.left)-.1||x.left>Math.min(t.right,i.right)+.1){b.style.top=pn;continue}let I=a.arrow?u.dom.querySelector(".cm-tooltip-arrow"):null,K=I?7:0,Y=M.right-M.left,ae=(e=Ts.get(u))!==null&&e!==void 0?e:M.bottom-M.top,ue=u.offset||Ur,ce=this.view.textDirection==r.LTR,ge=M.width>i.right-i.left?ce?i.left:i.right-M.width:ce?Math.min(x.left-(I?14:0)+ue.x,i.right-Y):Math.max(i.left,x.left-Y+(I?14:0)-ue.x),ze=!!a.above;!a.strictSide&&(ze?x.top-(M.bottom-M.top)-ue.y<i.top:x.bottom+(M.bottom-M.top)+ue.y>i.bottom)&&ze==i.bottom-x.bottom>x.top-i.top&&(ze=!ze);let et=(ze?x.top-i.top:i.bottom-x.bottom)-K;if(et<ae&&u.resize!==!1){if(et<this.view.defaultLineHeight){b.style.top=pn;continue}Ts.set(u,ae),b.style.height=(ae=et)+"px"}else b.style.height&&(b.style.height="");let Ue=ze?x.top-ae-K-ue.y:x.bottom+K+ue.y,lt=ge+Y;if(u.overlap!==!0)for(let gt of s)gt.left<lt&&gt.right>ge&&gt.top<Ue+ae&&gt.bottom>Ue&&(Ue=ze?gt.top-ae-2-K:gt.bottom+K+2);this.position=="absolute"?(b.style.top=Ue-n.parent.top+"px",b.style.left=ge-n.parent.left+"px"):(b.style.top=Ue+"px",b.style.left=ge+"px"),I&&(I.style.left=`${x.left+(ce?ue.x:-ue.x)-(ge+14-7)}px`),u.overlap!==!0&&s.push({left:ge,top:Ue,right:lt,bottom:Ue+ae}),b.classList.toggle("cm-tooltip-above",ze),b.classList.toggle("cm-tooltip-below",!ze),u.positioned&&u.positioned(n.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let n of this.manager.tooltipViews)n.dom.style.top=pn}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),Kr=ut.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:`${7}px`,width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:`${7}px solid transparent`,borderRight:`${7}px solid transparent`},".cm-tooltip-above &":{bottom:`-${7}px`,"&:before":{borderTop:`${7}px solid #bbb`},"&:after":{borderTop:`${7}px solid #f5f5f5`,bottom:"1px"}},".cm-tooltip-below &":{top:`-${7}px`,"&:before":{borderBottom:`${7}px solid #bbb`},"&:after":{borderBottom:`${7}px solid #f5f5f5`,top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Ur={x:0,y:0},Wn=w.r$.define({enables:[Nn,Kr]}),Xi=w.r$.define();class Fn{constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Ds(e,Xi,t=>this.createHostedView(t))}static create(e){return new Fn(e)}createHostedView(e){let t=e.create(this.view);return t.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(t.dom),this.mounted&&t.mount&&t.mount(this.view),t}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}}const Gr=Wn.compute([Xi],n=>{let e=n.facet(Xi).filter(t=>t);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.filter(t=>t.end!=null).map(t=>t.end)),create:Fn.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class Qr{constructor(e,t,i,s,o){this.view=e,this.source=t,this.field=i,this.setHover=s,this.hoverTime=o,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{lastMove:e}=this,t=this.view.contentDOM.contains(e.target)?this.view.posAtCoords(e):null;if(t==null)return;let i=this.view.coordsAtPos(t);if(i==null||e.y<i.top||e.y>i.bottom||e.x<i.left-this.view.defaultCharacterWidth||e.x>i.right+this.view.defaultCharacterWidth)return;let s=this.view.bidiSpans(this.view.state.doc.lineAt(t)).find(u=>u.from<=t&&u.to>=t),o=s&&s.dir==r.RTL?-1:1,a=this.source(this.view,t,e.x<i.left?-o:o);if(a!=null&&a.then){let u=this.pending={pos:t};a.then(b=>{this.pending==u&&(this.pending=null,b&&this.view.dispatch({effects:this.setHover.of(b)}))},b=>Ht(this.view.state,b,"hover tooltip"))}else a&&this.view.dispatch({effects:this.setHover.of(a)})}mousemove(e){var t;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let i=this.active;if(i&&!Os(this.lastMove.target)||this.pending){let{pos:s}=i||this.pending,o=(t=i==null?void 0:i.end)!==null&&t!==void 0?t:s;(s==o?this.view.posAtCoords(this.lastMove)!=s:!Xr(this.view,s,o,e.clientX,e.clientY,6))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&!Os(e.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function Os(n){for(let e=n;e;e=e.parentNode)if(e.nodeType==1&&e.classList.contains("cm-tooltip"))return!0;return!1}function Xr(n,e,t,i,s,o){let a=document.createRange(),u=n.domAtPos(e),b=n.domAtPos(t);a.setEnd(b.node,b.offset),a.setStart(u.node,u.offset);let x=a.getClientRects();a.detach();for(let M=0;M<x.length;M++){let I=x[M];if(Math.max(I.top-s,s-I.bottom,I.left-i,i-I.right)<=o)return!0}return!1}function Zr(n,e={}){let t=w.Py.define(),i=w.QQ.define({create(){return null},update(s,o){if(s&&(e.hideOnChange&&(o.docChanged||o.selection)||e.hideOn&&e.hideOn(o,s)))return null;if(s&&o.docChanged){let a=o.changes.mapPos(s.pos,-1,w.gc.TrackDel);if(a==null)return null;let u=Object.assign(Object.create(null),s);u.pos=a,s.end!=null&&(u.end=o.changes.mapPos(s.end)),s=u}for(let a of o.effects)a.is(t)&&(s=a.value),a.is(eo)&&(s=null);return s},provide:s=>Xi.from(s)});return[i,mt.define(s=>new Qr(s,n,i,t,e.hoverTime||300)),Gr]}function Yr(n,e){let t=n.plugin(Nn);if(!t)return null;let i=t.manager.tooltips.indexOf(e);return i<0?null:t.manager.tooltipViews[i]}function wo(n){return n.facet(Xi).some(e=>e)}const eo=w.Py.define(),xo=null;function vo(n){var e;(e=n.plugin(Nn))===null||e===void 0||e.maybeMeasure()}const Vn=w.r$.define({combine(n){let e,t;for(let i of n)e=e||i.topContainer,t=t||i.bottomContainer;return{topContainer:e,bottomContainer:t}}});function ko(n){return n?[Vn.of(n)]:[]}function to(n,e){let t=n.plugin(Ps),i=t?t.specs.indexOf(e):-1;return i>-1?t.panels[i]:null}const Ps=mt.fromClass(class{constructor(n){this.input=n.state.facet(Hn),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(n));let e=n.state.facet(Vn);this.top=new gn(n,!0,e.topContainer),this.bottom=new gn(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(n){let e=n.state.facet(Vn);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new gn(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new gn(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=n.state.facet(Hn);if(t!=this.input){let i=t.filter(b=>b),s=[],o=[],a=[],u=[];for(let b of i){let x=this.specs.indexOf(b),M;x<0?(M=b(n.view),u.push(M)):(M=this.panels[x],M.update&&M.update(n)),s.push(M),(M.top?o:a).push(M)}this.specs=i,this.panels=s,this.top.sync(o),this.bottom.sync(a);for(let b of u)b.dom.classList.add("cm-panel"),b.mount&&b.mount()}else for(let i of this.panels)i.update&&i.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>ut.scrollMargins.of(e=>{let t=e.plugin(n);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class gn{constructor(e,t,i){this.view=e,this.top=t,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=Bs(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=Bs(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function Bs(n){let e=n.nextSibling;return n.remove(),e}const Hn=w.r$.define({enables:Ps});class Ti extends w.uU{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Ti.prototype.elementClass="",Ti.prototype.toDOM=void 0,Ti.prototype.mapMode=w.gc.TrackBefore,Ti.prototype.startSide=Ti.prototype.endSide=-1,Ti.prototype.point=!0;const yn=w.r$.define(),io={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>w.Xs.empty,lineMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Zi=w.r$.define();function no(n){return[Es(),Zi.of(Object.assign(Object.assign({},io),n))]}const jn=w.r$.define({combine:n=>n.some(e=>e)});function Es(n){let e=[so];return n&&n.fixed===!1&&e.push(jn.of(!0)),e}const so=mt.fromClass(class{constructor(n){this.view=n,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=n.state.facet(Zi).map(e=>new Is(n,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!n.state.facet(jn),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}update(n){if(this.updateGutters(n)){let e=this.prevViewport,t=n.view.viewport,i=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(i<(t.to-t.from)*.8)}n.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(jn)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=n.view.viewport}syncGutters(n){let e=this.dom.nextSibling;n&&this.dom.remove();let t=w.Xs.iter(this.view.state.facet(yn),this.view.viewport.from),i=[],s=this.gutters.map(o=>new ro(o,this.view.viewport,-this.view.documentPadding.top));for(let o of this.view.viewportLineBlocks){let a;if(Array.isArray(o.type)){for(let u of o.type)if(u.type==Ke.Text){a=u;break}}else a=o.type==Ke.Text?o:void 0;if(a){i.length&&(i=[]),Rs(t,i,o.from);for(let u of s)u.line(this.view,a,i)}}for(let o of s)o.finish();n&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(n){let e=n.startState.facet(Zi),t=n.state.facet(Zi),i=n.docChanged||n.heightChanged||n.viewportChanged||!w.Xs.eq(n.startState.facet(yn),n.state.facet(yn),n.view.viewport.from,n.view.viewport.to);if(e==t)for(let s of this.gutters)s.update(n)&&(i=!0);else{i=!0;let s=[];for(let o of t){let a=e.indexOf(o);a<0?s.push(new Is(this.view,o)):(this.gutters[a].update(n),s.push(this.gutters[a]))}for(let o of this.gutters)o.dom.remove(),s.indexOf(o)<0&&o.destroy();for(let o of s)this.dom.appendChild(o.dom);this.gutters=s}return i}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove()}},{provide:n=>ut.scrollMargins.of(e=>{let t=e.plugin(n);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==r.LTR?{left:t.dom.offsetWidth}:{right:t.dom.offsetWidth}})});function Ls(n){return Array.isArray(n)?n:[n]}function Rs(n,e,t){for(;n.value&&n.from<=t;)n.from==t&&e.push(n.value),n.next()}class ro{constructor(e,t,i){this.gutter=e,this.height=i,this.i=0,this.cursor=w.Xs.iter(e.markers,t.from)}line(e,t,i){let s=[];Rs(this.cursor,s,t.from),i.length&&(s=s.concat(i));let o=this.gutter.config.lineMarker(e,t,s);o&&s.unshift(o);let a=this.gutter;if(s.length==0&&!a.config.renderEmptyElements)return;let u=t.top-this.height;if(this.i==a.elements.length){let b=new Ns(e,t.height,u,s);a.elements.push(b),a.dom.appendChild(b.dom)}else a.elements[this.i].update(e,t.height,u,s);this.height=t.bottom,this.i++}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class Is{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in t.domEventHandlers)this.dom.addEventListener(i,s=>{let o=s.target,a;if(o!=this.dom&&this.dom.contains(o)){for(;o.parentNode!=this.dom;)o=o.parentNode;let b=o.getBoundingClientRect();a=(b.top+b.bottom)/2}else a=s.clientY;let u=e.lineBlockAtHeight(a-e.documentTop);t.domEventHandlers[i](e,u,s)&&s.preventDefault()});this.markers=Ls(t.markers(e)),t.initialSpacer&&(this.spacer=new Ns(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=Ls(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let s=this.config.updateSpacer(this.spacer.markers[0],e);s!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[s])}let i=e.view.viewport;return!w.Xs.eq(this.markers,t,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class Ns{constructor(e,t,i,s){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,i,s)}update(e,t,i,s){this.height!=t&&(this.dom.style.height=(this.height=t)+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),oo(this.markers,s)||this.setMarkers(e,s)}setMarkers(e,t){let i="cm-gutterElement",s=this.dom.firstChild;for(let o=0,a=0;;){let u=a,b=o<t.length?t[o++]:null,x=!1;if(b){let M=b.elementClass;M&&(i+=" "+M);for(let I=a;I<this.markers.length;I++)if(this.markers[I].compare(b)){u=I,x=!0;break}}else u=this.markers.length;for(;a<u;){let M=this.markers[a++];if(M.toDOM){M.destroy(s);let I=s.nextSibling;s.remove(),s=I}}if(!b)break;b.toDOM&&(x?s=s.nextSibling:this.dom.insertBefore(b.toDOM(e),s)),x&&a++}this.dom.className=i,this.markers=t}destroy(){this.setMarkers(null,[])}}function oo(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].compare(e[t]))return!1;return!0}const lo=w.r$.define(),ji=w.r$.define({combine(n){return(0,w.BO)(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let i=Object.assign({},e);for(let s in t){let o=i[s],a=t[s];i[s]=o?(u,b,x)=>o(u,b,x)||a(u,b,x):a}return i}})}});class zn extends Ti{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function _n(n,e){return n.state.facet(ji).formatNumber(e,n.state)}const ao=Zi.compute([ji],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(lo)},lineMarker(e,t,i){return i.some(s=>s.toDOM)?null:new zn(_n(e,e.state.doc.lineAt(t.from).number))},lineMarkerChange:e=>e.startState.facet(ji)!=e.state.facet(ji),initialSpacer(e){return new zn(_n(e,Ws(e.state.doc.lines)))},updateSpacer(e,t){let i=_n(t.view,Ws(t.view.state.doc.lines));return i==e.number?e:new zn(i)},domEventHandlers:n.facet(ji).domEventHandlers}));function ho(n={}){return[ji.of(n),Es(),ao]}function Ws(n){let e=9;for(;e<n;)e=e*10+9;return e}const co=new class extends Ti{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},fo=yn.compute(["selection"],n=>{let e=[],t=-1;for(let i of n.selection.ranges){let s=n.doc.lineAt(i.head).from;s>t&&(t=s,e.push(co.range(s)))}return w.Xs.of(e)});function uo(){return fo}const Fs=new Map;function po(n){let e=Fs.get(n);return e||Fs.set(n,e=ke.mark({attributes:n==="	"?{class:"cm-highlightTab"}:{class:"cm-highlightSpace","data-display":n.replace(/ /g,"\xB7")}})),e}function Vs(n){return mt.define(e=>({decorations:n.createDeco(e),update(t){this.decorations=n.updateDeco(t,this.decorations)}}),{decorations:e=>e.decorations})}const mo=Vs(new En({regexp:/\t| +/g,decoration:n=>po(n[0]),boundary:/\S/}));function So(){return mo}const go=Vs(new En({regexp:/\s+$/g,decoration:ke.mark({class:"cm-trailingSpace"}),boundary:/\S/}));function Co(){return go}const Mo={HeightMap:ui,HeightOracle:Xn,MeasuredHeights:Zn,QueryType:Ct,ChangedRange:Yt,computeOrder:g,moveVisually:F}}}]);})();

//# sourceMappingURL=module-codemirror.44dec500.js.map